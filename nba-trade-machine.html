<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>NBA Trade Machine</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:400,600,700&display=swap">
  <style>
    body {
      font-family: 'Inter', Arial, sans-serif;
      background: #f6f8fa;
      margin: 0;
      color: #23272F;
      padding-top: 70px; /* Account for fixed navbar */
    }
    
    /* IMPROVED NAVIGATION BAR */
    .navbar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      width: 100%;
      background: linear-gradient(135deg, #0a174e 0%, #1a2b5c 100%);
      color: #fff;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 4px 20px rgba(10,23,78,0.15);
      padding: 0.75rem 3rem;
      z-index: 1001;
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255,255,255,0.1);
      height: 70px;
      box-sizing: border-box;
    }
    
    .nav-left {
      display: flex;
      align-items: center;
      gap: 1.5rem;
      flex-shrink: 0;
    }
    
    .nav-logo {
      width: 45px;
      height: 45px;
      object-fit: contain;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .site-title {
      font-size: 1.6rem;
      font-weight: 700;
      letter-spacing: 0.5px;
      color: #fff;
      text-shadow: 0 1px 3px rgba(0,0,0,0.2);
    }
    
    .nav-right {
      display: flex;
      align-items: center;
      gap: 2rem;
      margin-right: 1rem;
    }
    
    .nav-link {
      text-decoration: none;
      color: rgba(255,255,255,0.9);
      font-weight: 500;
      padding: 0.6rem 1.2rem;
      border-radius: 8px;
      transition: all 0.3s ease;
      position: relative;
      font-size: 0.95rem;
      letter-spacing: 0.3px;
    }
    
    .nav-link::before {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      width: 0;
      height: 2px;
      background: #0057e7;
      transition: all 0.3s ease;
      transform: translateX(-50%);
    }
    
    .nav-link:hover::before,
    .nav-link.active::before {
      width: 80%;
    }
    
    .nav-link.active, 
    .nav-link:hover {
      background: rgba(0,87,231,0.2);
      color: #fff;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(0,87,231,0.3);
    }
    
    .nav-dropdown {
      position: relative;
      display: inline-block;
    }
    
    .dropdown-btn {
      background: none;
      border: none;
      color: rgba(255,255,255,0.9);
      font-weight: 500;
      padding: 0.6rem 1.2rem;
      cursor: pointer;
      border-radius: 8px;
      transition: all 0.3s ease;
      font-size: 0.95rem;
      outline: none;
      letter-spacing: 0.3px;
    }
    
    .dropdown-btn:hover,
    .nav-dropdown:hover .dropdown-btn {
      background: rgba(0,87,231,0.2);
      color: #fff;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(0,87,231,0.3);
    }
    
    .dropdown-content {
      display: none;
      position: absolute;
      top: 120%;
      left: 0;
      min-width: 240px;
      background: #fff;
      box-shadow: 0 8px 32px rgba(10,23,78,0.2);
      border-radius: 12px;
      z-index: 1000;
      flex-direction: column;
      padding: 0.8rem 0;
      border: 1px solid rgba(0,87,231,0.1);
    }
    
    .nav-dropdown:hover .dropdown-content,
    .nav-dropdown:focus-within .dropdown-content {
      display: flex;
      animation: dropdownShow 0.3s ease;
    }
    
    @keyframes dropdownShow {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .dropdown-link {
      color: #0a174e;
      text-decoration: none;
      padding: 0.8rem 1.5rem;
      transition: all 0.2s ease;
      font-weight: 500;
      font-size: 0.95rem;
      border-radius: 6px;
      margin: 0 0.5rem;
      outline: none;
    }
    
    .dropdown-link:hover {
      background: linear-gradient(135deg, #e6f0ff 0%, #f0f7ff 100%);
      color: #0057e7;
      transform: translateX(4px);
    }
    
    .hamburger {
      display: none;
      flex-direction: column;
      gap: 6px;
      cursor: pointer;
      background: none;
      border: none;
      z-index: 101;
    }
    
    .hamburger span {
      width: 32px;
      height: 4px;
      background: #fff;
      border-radius: 2px;
      transition: all 0.3s;
      box-shadow: 0 2px 8px rgba(10,23,78,0.08);
    }
    
    /* MOBILE RESPONSIVE */
    @media (max-width: 950px) {
      .navbar { 
        padding: 0.75rem 1.5rem; 
        height: 60px;
      }
      body {
        padding-top: 60px;
      }
      .nav-right {
        display: none;
        position: absolute;
        top: 60px;
        left: 0;
        width: 100vw;
        background: linear-gradient(135deg, #0a174e 0%, #1a2b5c 100%);
        flex-direction: column;
        box-shadow: 0 8px 24px rgba(10,23,78,0.17);
        padding-bottom: 1rem;
        z-index: 99;
        max-height: 0;
        overflow: hidden;
        border-radius: 0 0 16px 16px;
        border-top: 1px solid #0057e7;
        align-items: flex-start;
      }
      .nav-right.open { 
        display: flex; 
        max-height: 1000px; 
        overflow: visible; 
        animation: navShow 0.25s;
      }
      @keyframes navShow {
        from { opacity: 0; transform: translateY(-10px);}
        to { opacity: 1; transform: translateY(0);}
      }
      .hamburger { 
        display: flex; 
        position: fixed; 
        top: 18px; 
        right: 32px; 
        margin-left: 0; 
        background: none; 
        border: none;
      }
      .dropdown-content { 
        position: static; 
        min-width: unset; 
        box-shadow: none; 
        background: transparent; 
        border-radius: 0; 
        padding: 0;
      }
      .dropdown-link { 
        color: #fff; 
        padding: 0.8rem 1.6rem;
      }
      .dropdown-link:hover { 
        background: #0057e7; 
        color: #fff;
      }
    }
    
    /* MAIN CONTENT - REMOVED WHITE SPACE */
    h1 {
      background: linear-gradient(135deg, #0a174e 0%, #0057e7 100%);
      color: #fff;
      padding: 2rem 0 1.5rem 0;
      margin: 0;
      text-align: center;
      font-weight: 800;
      font-size: 2.4rem;
      letter-spacing: 1px;
      box-shadow: 0 4px 20px rgba(10,23,78,0.15);
      text-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    
    .description-block {
      max-width: 850px;
      margin: 1.5rem auto 2rem auto;
      background: #fff;
      border-radius: 18px;
      padding: 1.8rem 2.2rem;
      box-shadow: 0 4px 24px rgba(10,23,78,0.12);
      font-size: 1.1rem;
      color: #234;
      line-height: 1.7;
      border-left: 6px solid #0057e7;
    }
    
    .description-block strong {
      color: #0057e7;
    }
    
    .trade-controls {
      text-align: center;
      margin: 1.5rem 0 2rem 0;
    }
    
    .trade-controls button {
      background: linear-gradient(135deg, #0057e7 0%, #2688ff 100%);
      color: #fff;
      font-weight: 600;
      font-size: 1.1rem;
      padding: 0.8rem 2rem;
      border-radius: 10px;
      border: none;
      margin: 0 0.8rem;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 16px rgba(0,87,231,0.3);
      letter-spacing: 0.3px;
    }
    
    .trade-controls button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,87,231,0.4);
    }
    
    .trade-controls button:disabled {
      background: #bbb;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    
    .trade-container {
      display: flex;
      flex-wrap: wrap;
      gap: 2.5rem;
      justify-content: center;
      margin: 2rem 0;
      padding: 0 1rem;
    }
    
    .team-block {
      background: #fff;
      border-radius: 22px;
      box-shadow: 0 6px 40px rgba(10,23,78,0.13);
      padding: 1.7rem 1.4rem 1.4rem 1.4rem;
      min-width: 350px;
      max-width: 410px;
      flex: 1 1 350px;
      display: flex;
      flex-direction: column;
      align-items: stretch;
      margin-bottom: 1rem;
      position: relative;
      transition: all 0.3s ease;
    }
    
    .team-block:hover {
      box-shadow: 0 12px 48px rgba(0,87,231,0.2);
      transform: translateY(-4px);
    }
    
    .team-header {
      display: flex;
      align-items: center;
      gap: 1.2rem;
      background: linear-gradient(135deg, #0057e7 0%, #2688ff 100%);
      border-radius: 16px;
      box-shadow: 0 4px 16px rgba(0,87,231,0.2);
      padding: 0.8rem 1.2rem;
      margin-bottom: 1.2rem;
      min-height: 55px;
    }
    
    .team-label {
      color: #fff;
      font-weight: 700;
      font-size: 1.2rem;
      margin-right: 0.8rem;
      letter-spacing: 0.5px;
      text-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }
    
    .team-header select {
      font-size: 1.1rem;
      border-radius: 8px;
      border: none;
      padding: 0.5rem 1.2rem;
      font-weight: 600;
      background: #fff;
      color: #0a174e;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      transition: all 0.2s ease;
    }
    
    .team-header select:hover {
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    
    .remove-team-btn {
      background: none;
      color: #fff;
      border: none;
      font-size: 1.3rem;
      font-weight: bold;
      cursor: pointer;
      margin-left: auto;
      transition: all 0.2s ease;
      padding: 0.2rem;
      border-radius: 4px;
      opacity: 0.8;
    }
    
    .remove-team-btn:hover { 
      color: #ff6b6b; 
      opacity: 1;
      background: rgba(255,255,255,0.1);
    }
    
    /* IMPROVED PLAYERS LIST - NO SCROLLING */
    .players-list {
      list-style: none;
      padding: 0;
      margin: 0;
      /* REMOVED max-height and overflow-y to eliminate scrolling */
      border-radius: 14px;
      background: #f9fbfc;
      border: 2px solid #e4eaf2;
      box-shadow: 0 2px 12px rgba(10,23,78,0.08);
      margin-bottom: 1.3rem;
      display: flex;
      flex-direction: column;
      gap: 0.4rem;
      padding: 0.8rem;
    }
    
    .players-list li {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 0.9rem 1.2rem;
      background: #fff;
      border-radius: 12px;
      font-size: 1.1rem;
      box-shadow: 0 2px 8px rgba(0,87,231,0.06);
      position: relative;
      transition: all 0.2s ease;
      cursor: pointer;
      border: 1px solid #e9eef3;
    }
    
    .players-list li.selected,
    .players-list li:hover {
      background: linear-gradient(135deg, #e6f0ff 0%, #f0f7ff 100%);
      box-shadow: 0 4px 16px rgba(0,87,231,0.15);
      transform: translateY(-1px);
      border: 2px solid #0057e7;
    }
    
    .player-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: linear-gradient(135deg, #dbeafe 0%, #e0e7ef 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2em;
      font-weight: bold;
      color: #0a174e;
      flex-shrink: 0;
      margin-right: 6px;
      box-shadow: 0 2px 8px rgba(10,23,78,0.1);
      border: 2px solid #fff;
      letter-spacing: 0.01em;
      text-transform: uppercase;
    }
    
    .players-list input[type=checkbox] {
      margin-right: 0.2em;
      accent-color: #0057e7;
      cursor: pointer;
      width: 1.3em; 
      height: 1.3em;
      border-radius: 4px;
      border: 2px solid #0057e7;
      box-shadow: 0 2px 6px rgba(0,87,231,0.1);
      transition: all 0.2s ease;
      flex-shrink: 0;
    }
    
    .players-list label {
      flex: 1;
      cursor: pointer;
      font-weight: 600;
      letter-spacing: 0.3px;
      color: #273a58;
    }
    
    .players-list .salary-cell {
      color: #0057e7;
      min-width: 130px;
      text-align: right;
      font-weight: 700;
      font-size: 1.1rem;
      letter-spacing: 0.3px;
    }
    
    .totals {
      margin: 1.2rem 0 0 0;
      font-weight: 700;
      font-size: 1.2rem;
      color: #333;
      text-align: right;
    }
    
    .payroll-box {
      margin-top: 1.2rem;
      background: linear-gradient(135deg, #f3f7fb 0%, #f8fafc 100%);
      border-radius: 12px;
      padding: 1.2rem 1.3rem 0.8rem 1.3rem;
      font-size: 1.1rem;
      color: #0a174e;
      box-shadow: 0 2px 12px rgba(0,87,231,0.08);
      border: 1px solid #e4eaf2;
    }
    
    .payroll-box .line { 
      margin-bottom: 0.5rem; 
    }
    
    .payroll-box .level {
      font-weight: 700;
      min-width: 140px;
      display: inline-block;
    }
    
    .payroll-box .over { 
      color: #dc2626;
      font-weight: 700;
    }
    
    /* TRADE RESULT POPUP MODAL */
    .trade-modal {
      display: none;
      position: fixed;
      z-index: 2000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(5px);
      animation: modalFadeIn 0.3s ease;
    }
    
    @keyframes modalFadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    .modal-content {
      background: #fff;
      margin: 8% auto;
      padding: 0;
      border-radius: 20px;
      width: 90%;
      max-width: 600px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      animation: modalSlideIn 0.4s ease;
      overflow: hidden;
    }
    
    @keyframes modalSlideIn {
      from { transform: translateY(-50px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    
    .modal-header {
      padding: 1.5rem 2rem;
      background: linear-gradient(135deg, #0057e7 0%, #2688ff 100%);
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .modal-header.success {
      background: linear-gradient(135deg, #10b981 0%, #34d399 100%);
    }
    
    .modal-header.failed {
      background: linear-gradient(135deg, #dc2626 0%, #ef4444 100%);
    }
    
    .modal-title {
      font-size: 1.5rem;
      font-weight: 700;
      margin: 0;
      text-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }
    
    .close-btn {
      background: none;
      border: none;
      color: white;
      font-size: 1.8rem;
      cursor: pointer;
      padding: 0.2rem;
      border-radius: 4px;
      transition: background 0.2s ease;
    }
    
    .close-btn:hover {
      background: rgba(255, 255, 255, 0.2);
    }
    
    .modal-body {
      padding: 2rem;
    }
    
    .trade-summary {
      display: flex;
      justify-content: space-between;
      gap: 2rem;
      margin-bottom: 1.5rem;
    }
    
    .team-summary {
      flex: 1;
      background: #f8fafc;
      border-radius: 12px;
      padding: 1.2rem;
      border: 2px solid #e4eaf2;
    }
    
    .team-summary h4 {
      margin: 0 0 1rem 0;
      color: #0a174e;
      font-size: 1.2rem;
      font-weight: 700;
    }
    
    .player-item {
      display: flex;
      align-items: center;
      gap: 0.8rem;
      margin-bottom: 0.8rem;
      padding: 0.6rem;
      background: white;
      border-radius: 8px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.05);
    }
    
    .player-item:last-child {
      margin-bottom: 0;
    }
    
    .player-item .player-avatar {
      width: 32px;
      height: 32px;
      font-size: 0.9rem;
    }
    
    .player-name {
      flex: 1;
      font-weight: 600;
      color: #273a58;
    }
    
    .player-salary {
      color: #0057e7;
      font-weight: 700;
      font-size: 0.95rem;
    }
    
    .error-message {
      background: #fef2f2;
      border: 2px solid #fecaca;
      border-radius: 12px;
      padding: 1.2rem;
      color: #dc2626;
      font-weight: 600;
      text-align: center;
      margin-top: 1rem;
    }
    
    .success-message {
      background: #f0fdf4;
      border: 2px solid #bbf7d0;
      border-radius: 12px;
      padding: 1.2rem;
      color: #16a34a;
      font-weight: 600;
      text-align: center;
      margin-top: 1rem;
    }
    
    /* RESPONSIVE IMPROVEMENTS */
    @media (max-width: 768px) {
      .trade-container {
        gap: 1.5rem;
        padding: 0 0.5rem;
      }
      
      .team-block {
        min-width: 300px;
      }
      
      .modal-content {
        width: 95%;
        margin: 5% auto;
      }
      
      .trade-summary {
        flex-direction: column;
        gap: 1rem;
      }
      
      .navbar {
        padding: 0.5rem 1rem;
      }
      
      .site-title {
        font-size: 1.3rem;
      }
    }
  </style>
</head>
<body>
  <!-- IMPROVED NAVIGATION -->
  <nav class="navbar">
    <div class="nav-left">
      <img src="https://via.placeholder.com/45x45/0057e7/ffffff?text=NBA" alt="NBA Logo" class="nav-logo">
      <div class="site-title">NBA Trade Machine</div>
    </div>
    <div class="nav-right">
      <a href="#" class="nav-link active">Trade Machine</a>
      <a href="#" class="nav-link">Player Stats</a>
      <a href="#" class="nav-link">Team Rosters</a>
      <div class="nav-dropdown">
        <button class="dropdown-btn">Tools ‚ñº</button>
        <div class="dropdown-content">
          <a href="#" class="dropdown-link">Salary Calculator</a>
          <a href="#" class="dropdown-link">Draft Simulator</a>
          <a href="#" class="dropdown-link">Free Agency</a>
          <a href="#" class="dropdown-link">Trade History</a>
        </div>
      </div>
      <a href="#" class="nav-link">About</a>
    </div>
    <button class="hamburger" onclick="toggleMobileMenu()">
      <span></span>
      <span></span>
      <span></span>
    </button>
  </nav>

  <!-- MAIN CONTENT - REMOVED WHITE SPACE -->
  <h1>NBA Trade Machine</h1>
  
  <div class="description-block">
    <strong>Build your perfect trade!</strong> Select players from different teams and see if your trade works under NBA salary cap rules. The machine will automatically calculate salary matching requirements and let you know if your trade is valid.
  </div>

  <div class="trade-controls">
    <button onclick="addTeam()">Add Team</button>
    <button onclick="executeTrade()">Execute Trade</button>
    <button onclick="clearTrade()">Clear All</button>
  </div>

  <div class="trade-container" id="tradeContainer">
    <!-- Teams will be added here dynamically -->
  </div>

  <!-- TRADE RESULT MODAL -->
  <div id="tradeModal" class="trade-modal">
    <div class="modal-content">
      <div class="modal-header" id="modalHeader">
        <h2 class="modal-title" id="modalTitle">Trade Result</h2>
        <button class="close-btn" onclick="closeModal()">&times;</button>
      </div>
      <div class="modal-body">
        <div class="trade-summary" id="tradeSummary">
          <!-- Trade summary will be populated here -->
        </div>
        <div id="tradeMessage">
          <!-- Success or error message will be shown here -->
        </div>
      </div>
    </div>
  </div>

  <script>
    // Sample NBA teams and players data
    const nbaTeams = {
      'Lakers': [
        {name: 'LeBron James', salary: 47607350},
        {name: 'Anthony Davis', salary: 40600080},
        {name: 'Russell Westbrook', salary: 47063478},
        {name: 'Kendrick Nunn', salary: 5250000},
        {name: 'Malik Monk', salary: 2641691}
      ],
      'Warriors': [
        {name: 'Stephen Curry', salary: 48070014},
        {name: 'Klay Thompson', salary: 40600080},
        {name: 'Draymond Green', salary: 25806468},
        {name: 'Andrew Wiggins', salary: 33616770},
        {name: 'Jordan Poole', salary: 3901399}
      ],
      'Celtics': [
        {name: 'Jayson Tatum', salary: 32600060},
        {name: 'Jaylen Brown', salary: 28741071},
        {name: 'Marcus Smart', salary: 14339285},
        {name: 'Robert Williams', salary: 12400000},
        {name: 'Al Horford', salary: 26500000}
      ],
      'Nets': [
        {name: 'Kevin Durant', salary: 44119845},
        {name: 'Kyrie Irving', salary: 36934550},
        {name: 'Ben Simmons', salary: 35448672},
        {name: 'Joe Harris', salary: 18642857},
        {name: 'Seth Curry', salary: 8500000}
      ]
    };

    let teamCount = 0;
    let selectedPlayers = {};

    function addTeam() {
      teamCount++;
      const container = document.getElementById('tradeContainer');
      
      const teamBlock = document.createElement('div');
      teamBlock.className = 'team-block';
      teamBlock.id = `team-${teamCount}`;
      
      teamBlock.innerHTML = `
        <div class="team-header">
          <span class="team-label">Team ${teamCount}:</span>
          <select onchange="loadPlayers(${teamCount}, this.value)">
            <option value="">Select Team</option>
            ${Object.keys(nbaTeams).map(team => `<option value="${team}">${team}</option>`).join('')}
          </select>
          <button class="remove-team-btn" onclick="removeTeam(${teamCount})">√ó</button>
        </div>
        <ul class="players-list" id="players-${teamCount}">
          <li style="text-align: center; color: #666; font-style: italic;">Select a team to view players</li>
        </ul>
        <div class="totals" id="totals-${teamCount}">Total: $0</div>
        <div class="payroll-box">
          <div class="line"><span class="level">Salary Cap:</span> $112,414,000</div>
          <div class="line"><span class="level">Luxury Tax:</span> $136,606,000</div>
          <div class="line"><span class="level">Current:</span> <span id="current-${teamCount}">$0</span></div>
        </div>
      `;
      
      container.appendChild(teamBlock);
      selectedPlayers[teamCount] = [];
    }

    function removeTeam(teamId) {
      const teamBlock = document.getElementById(`team-${teamId}`);
      teamBlock.remove();
      delete selectedPlayers[teamId];
    }

    function loadPlayers(teamId, teamName) {
      if (!teamName) return;
      
      const playersList = document.getElementById(`players-${teamId}`);
      const players = nbaTeams[teamName];
      
      playersList.innerHTML = players.map((player, index) => `
        <li>
          <input type="checkbox" id="player-${teamId}-${index}" 
                 onchange="togglePlayer(${teamId}, ${index}, '${player.name}', ${player.salary})">
          <div class="player-avatar">${player.name.split(' ').map(n => n[0]).join('')}</div>
          <label for="player-${teamId}-${index}">${player.name}</label>
          <span class="salary-cell">$${player.salary.toLocaleString()}</span>
        </li>
      `).join('');
      
      selectedPlayers[teamId] = [];
      updateTotals(teamId);
    }

    function togglePlayer(teamId, playerIndex, playerName, salary) {
      const checkbox = document.getElementById(`player-${teamId}-${playerIndex}`);
      const playerData = {name: playerName, salary: salary};
      
      if (checkbox.checked) {
        selectedPlayers[teamId].push(playerData);
        checkbox.parentElement.classList.add('selected');
      } else {
        selectedPlayers[teamId] = selectedPlayers[teamId].filter(p => p.name !== playerName);
        checkbox.parentElement.classList.remove('selected');
      }
      
      updateTotals(teamId);
    }

    function updateTotals(teamId) {
      const total = selectedPlayers[teamId].reduce((sum, player) => sum + player.salary, 0);
      document.getElementById(`totals-${teamId}`).textContent = `Total: $${total.toLocaleString()}`;
      document.getElementById(`current-${teamId}`).textContent = `$${total.toLocaleString()}`;
      
      // Add over luxury tax styling
      const currentElement = document.getElementById(`current-${teamId}`);
      if (total > 136606000) {
        currentElement.classList.add('over');
      } else {
        currentElement.classList.remove('over');
      }
    }

    function executeTrade() {
      const teams = Object.keys(selectedPlayers).filter(teamId => selectedPlayers[teamId].length > 0);
      
      if (teams.length < 2) {
        showTradeResult(false, 'You need at least 2 teams with selected players to execute a trade.', {});
        return;
      }
      
      // Calculate trade validity (simplified NBA trade rules)
      const teamTotals = teams.map(teamId => ({
        teamId,
        total: selectedPlayers[teamId].reduce((sum, player) => sum + player.salary, 0),
        players: selectedPlayers[teamId]
      }));
      
      // Check if trade is balanced (within 125% + $100k rule for teams over cap)
      let tradeValid = true;
      let errorMessage = '';
      
      if (teams.length === 2) {
        const [team1, team2] = teamTotals;
        const difference = Math.abs(team1.total - team2.total);
        const higherSalary = Math.max(team1.total, team2.total);
        const allowedDifference = higherSalary * 0.25 + 100000; // 125% + $100k rule
        
        if (difference > allowedDifference) {
          tradeValid = false;
          errorMessage = `Trade salaries don't match. Difference of $${difference.toLocaleString()} exceeds the allowed $${allowedDifference.toLocaleString()}.`;
        }
      }
      
      const tradeData = {};
      teams.forEach(teamId => {
        const teamSelect = document.querySelector(`#team-${teamId} select`);
        const teamName = teamSelect.value;
        tradeData[teamName] = selectedPlayers[teamId];
      });
      
      showTradeResult(tradeValid, errorMessage, tradeData);
    }

    function showTradeResult(success, message, tradeData) {
      const modal = document.getElementById('tradeModal');
      const header = document.getElementById('modalHeader');
      const title = document.getElementById('modalTitle');
      const summary = document.getElementById('tradeSummary');
      const messageDiv = document.getElementById('tradeMessage');
      
      // Set modal style based on success/failure
      header.className = `modal-header ${success ? 'success' : 'failed'}`;
      title.textContent = success ? 'Trade Successful!' : 'Trade Failed';
      
      // Clear previous content
      summary.innerHTML = '';
      messageDiv.innerHTML = '';
      
      // Show trade summary
      Object.keys(tradeData).forEach(teamName => {
        const teamDiv = document.createElement('div');
        teamDiv.className = 'team-summary';
        
        const playersHtml = tradeData[teamName].map(player => `
          <div class="player-item">
            <div class="player-avatar">${player.name.split(' ').map(n => n[0]).join('')}</div>
            <span class="player-name">${player.name}</span>
            <span class="player-salary">$${player.salary.toLocaleString()}</span>
          </div>
        `).join('');
        
        const totalSalary = tradeData[teamName].reduce((sum, player) => sum + player.salary, 0);
        
        teamDiv.innerHTML = `
          <h4>${teamName} (Total: $${totalSalary.toLocaleString()})</h4>
          ${playersHtml}
        `;
        
        summary.appendChild(teamDiv);
      });
      
      // Show success or error message
      if (success) {
        messageDiv.innerHTML = `
          <div class="success-message">
            üéâ Trade completed successfully! All salary cap requirements have been met.
          </div>
        `;
      } else {
        messageDiv.innerHTML = `
          <div class="error-message">
            ‚ùå ${message}
          </div>
        `;
      }
      
      modal.style.display = 'block';
    }

    function closeModal() {
      document.getElementById('tradeModal').style.display = 'none';
    }

    function clearTrade() {
      document.getElementById('tradeContainer').innerHTML = '';
      selectedPlayers = {};
      teamCount = 0;
    }

    function toggleMobileMenu() {
      const navRight = document.querySelector('.nav-right');
      navRight.classList.toggle('open');
    }

    // Close modal when clicking outside
    window.onclick = function(event) {
      const modal = document.getElementById('tradeModal');
      if (event.target === modal) {
        closeModal();
      }
    }

    // Initialize with two teams
    addTeam();
    addTeam();
  </script>
</body>
</html>

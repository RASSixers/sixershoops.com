<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>NBA Trade Machine - SixersHoops</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap">
  
  <!-- Navbar Styles - Auto-updates when you modify navbar-styles.css -->
  <link rel="stylesheet" href="navbar-styles.css">
  <style>
    /* Reset and Base Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
      color: #e2e8f0;
      line-height: 1.6;
      padding-top: 80px;
      margin: 0;
      min-height: 100vh;
    }

    /* Hero Section */
    .hero-section {
      background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
      padding: 4rem 0 3rem 0;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .hero-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.1), transparent);
      opacity: 0.5;
    }

    .hero-content {
      position: relative;
      z-index: 2;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 2rem;
    }

    .hero-title {
      font-size: clamp(2.5rem, 5vw, 4rem);
      font-weight: 900;
      background: linear-gradient(135deg, #ffffff 0%, #3b82f6 50%, #06b6d4 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 1rem;
      letter-spacing: -2px;
      text-shadow: 0 4px 20px rgba(59, 130, 246, 0.3);
    }

    .hero-subtitle {
      font-size: 1.25rem;
      color: #94a3b8;
      font-weight: 500;
      max-width: 600px;
      margin: 0 auto 2rem auto;
      line-height: 1.7;
    }
    /* Main Container */
    .main-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 2rem 4rem 2rem;
    }

    /* Description Section */
    .description-section {
      background: rgba(30, 41, 59, 0.8);
      backdrop-filter: blur(10px);
      border-radius: 24px;
      padding: 2.5rem;
      margin: 3rem auto;
      max-width: 900px;
      border: 1px solid rgba(59, 130, 246, 0.2);
      box-shadow: 
        0 20px 40px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      position: relative;
      overflow: hidden;
    }

    .description-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, #3b82f6, #06b6d4, #8b5cf6);
      border-radius: 24px 24px 0 0;
    }

    .description-text {
      font-size: 1.1rem;
      line-height: 1.8;
      color: #cbd5e1;
      text-align: center;
    }

    .description-text strong {
      color: #ffffff;
      font-weight: 700;
    }

    /* Control Panel */
    .control-panel {
      background: rgba(15, 23, 42, 0.9);
      backdrop-filter: blur(15px);
      border-radius: 20px;
      padding: 2rem;
      margin: 3rem auto;
      max-width: 800px;
      border: 1px solid rgba(59, 130, 246, 0.3);
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.4);
    }

    .control-title {
      text-align: center;
      font-size: 1.5rem;
      font-weight: 700;
      color: #ffffff;
      margin-bottom: 2rem;
      background: linear-gradient(135deg, #ffffff 0%, #3b82f6 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .control-buttons {
      display: flex;
      justify-content: center;
      gap: 2rem;
      flex-wrap: wrap;
      padding: 2.5rem;
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.8), rgba(30, 41, 59, 0.6));
      border-radius: 24px;
      border: 1px solid rgba(59, 130, 246, 0.3);
      backdrop-filter: blur(20px);
      box-shadow: 
        0 12px 40px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      margin-bottom: 3rem;
      position: relative;
      overflow: hidden;
    }

    .control-buttons::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, #3b82f6, #06b6d4, #8b5cf6, #3b82f6);
      background-size: 200% 100%;
      animation: shimmer 3s ease-in-out infinite;
    }

    @keyframes shimmer {
      0%, 100% { background-position: 200% 0; }
      50% { background-position: -200% 0; }
    }

    .control-btn {
      background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 50%, #1e40af 100%);
      color: #ffffff;
      font-weight: 700;
      font-size: 1.1rem;
      padding: 1.2rem 2.5rem;
      border-radius: 16px;
      border: none;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 
        0 10px 30px rgba(59, 130, 246, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.2),
        0 0 0 1px rgba(255, 255, 255, 0.1);
      position: relative;
      overflow: hidden;
      min-width: 180px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    }

    .control-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s ease;
    }

    .control-btn::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      transform: translate(-50%, -50%);
      transition: width 0.6s ease, height 0.6s ease;
    }

    .control-btn:hover::before {
      left: 100%;
    }

    .control-btn:hover::after {
      width: 300px;
      height: 300px;
    }

    .control-btn:hover {
      transform: translateY(-5px) scale(1.05);
      box-shadow: 
        0 20px 50px rgba(59, 130, 246, 0.6),
        inset 0 1px 0 rgba(255, 255, 255, 0.4),
        0 0 0 1px rgba(255, 255, 255, 0.2);
      background: linear-gradient(135deg, #1d4ed8 0%, #1e40af 50%, #3730a3 100%);
    }

    .control-btn:active {
      transform: translateY(-2px) scale(1.02);
      transition: all 0.1s ease;
    }

    .control-btn:disabled {
      background: linear-gradient(135deg, #64748b 0%, #475569 100%);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    /* Trade Container */
    .trade-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 2rem;
      margin: 3rem 0;
      padding: 0 1rem;
    }

    /* Team Block */
    .team-block {
      background: rgba(30, 41, 59, 0.9);
      backdrop-filter: blur(15px);
      border-radius: 24px;
      border: 1px solid rgba(59, 130, 246, 0.2);
      box-shadow: 
        0 25px 50px rgba(0, 0, 0, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      padding: 2rem;
      position: relative;
      transition: all 0.4s ease;
      overflow: hidden;
    }

    .team-block::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #3b82f6, #06b6d4, #8b5cf6);
      border-radius: 24px 24px 0 0;
    }

    .team-block:hover {
      transform: translateY(-8px);
      box-shadow: 
        0 35px 70px rgba(0, 0, 0, 0.5),
        0 0 0 1px rgba(59, 130, 246, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
    }

    /* Team Header */
    .team-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
      border-radius: 16px;
      padding: 1.25rem 1.5rem;
      margin-bottom: 1.5rem;
      border: 1px solid rgba(59, 130, 246, 0.3);
      box-shadow: 
        0 8px 25px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      position: relative;
      overflow: hidden;
    }

    .team-header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, #3b82f6, #06b6d4);
      border-radius: 16px 16px 0 0;
    }
    .team-label {
      color: #ffffff;
      font-weight: 700;
      font-size: 1.1rem;
      letter-spacing: 0.5px;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    .team-header select {
      flex: 1;
      font-size: 1rem;
      font-weight: 600;
      border-radius: 12px;
      border: 1px solid rgba(59, 130, 246, 0.3);
      padding: 0.75rem 1rem;
      background: rgba(15, 23, 42, 0.8);
      color: #e2e8f0;
      box-shadow: 
        0 4px 15px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }

    .team-header select:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 
        0 0 0 3px rgba(59, 130, 246, 0.2),
        0 4px 15px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }

    .team-header select option {
      background: #1e293b;
      color: #e2e8f0;
      padding: 0.5rem;
    }

    /* Analyze Section */
    .analyze-section {
      text-align: center;
      margin: 4rem 0;
      padding: 3rem;
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.9), rgba(30, 41, 59, 0.7));
      border-radius: 32px;
      border: 1px solid rgba(59, 130, 246, 0.3);
      backdrop-filter: blur(20px);
      box-shadow: 
        0 20px 60px rgba(0, 0, 0, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      position: relative;
      overflow: hidden;
    }

    .analyze-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, #3b82f6, #06b6d4, #8b5cf6, #f59e0b, #3b82f6);
      background-size: 300% 100%;
      animation: rainbow 4s ease-in-out infinite;
    }

    @keyframes rainbow {
      0%, 100% { background-position: 300% 0; }
      50% { background-position: -300% 0; }
    }

    .trade-btn {
      background: linear-gradient(135deg, #059669 0%, #10b981 50%, #34d399 100%);
      color: #ffffff;
      border: none;
      padding: 1.5rem 4rem;
      border-radius: 20px;
      font-size: 1.3rem;
      font-weight: 800;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 
        0 15px 40px rgba(16, 185, 129, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.2),
        0 0 0 1px rgba(255, 255, 255, 0.1);
      position: relative;
      overflow: hidden;
      text-transform: uppercase;
      letter-spacing: 1px;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      min-width: 300px;
    }

    .trade-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transition: left 0.6s ease;
    }

    .trade-btn::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      transform: translate(-50%, -50%);
      transition: width 0.6s ease, height 0.6s ease;
    }

    .trade-btn:hover::before {
      left: 100%;
    }

    .trade-btn:hover::after {
      width: 400px;
      height: 400px;
    }

    .trade-btn:hover {
      transform: translateY(-8px) scale(1.08);
      box-shadow: 
        0 25px 60px rgba(16, 185, 129, 0.6),
        inset 0 1px 0 rgba(255, 255, 255, 0.4),
        0 0 0 1px rgba(255, 255, 255, 0.2);
      background: linear-gradient(135deg, #10b981 0%, #34d399 50%, #6ee7b7 100%);
    }

    .trade-btn:active {
      transform: translateY(-4px) scale(1.04);
      transition: all 0.1s ease;
    }

    .trade-btn:disabled {
      background: linear-gradient(135deg, #64748b 0%, #475569 100%);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .remove-team-btn {
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
      color: #ffffff;
      border: none;
      font-size: 1.2rem;
      font-weight: bold;
      cursor: pointer;
      padding: 0.5rem;
      border-radius: 8px;
      transition: all 0.3s ease;
      box-shadow: 
        0 4px 15px rgba(239, 68, 68, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .remove-team-btn:hover {
      transform: translateY(-2px);
      box-shadow: 
        0 6px 20px rgba(239, 68, 68, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
    }
    /* Players List */
    .players-list {
      list-style: none;
      padding: 1rem;
      margin: 0 0 1.5rem 0;
      max-height: 500px;
      overflow-y: auto;
      border-radius: 16px;
      background: rgba(15, 23, 42, 0.6);
      border: 1px solid rgba(59, 130, 246, 0.2);
      box-shadow: 
        0 8px 25px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(10px);
    }

    .players-list::-webkit-scrollbar {
      width: 8px;
    }

    .players-list::-webkit-scrollbar-track {
      background: rgba(30, 41, 59, 0.5);
      border-radius: 4px;
    }

    .players-list::-webkit-scrollbar-thumb {
      background: linear-gradient(135deg, #3b82f6, #06b6d4);
      border-radius: 4px;
    }

    .players-list::-webkit-scrollbar-thumb:hover {
      background: linear-gradient(135deg, #2563eb, #0891b2);
    }

    .players-list li {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1.2rem;
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.8), rgba(30, 41, 59, 0.6));
      border-radius: 16px;
      font-size: 1rem;
      margin-bottom: 0.8rem;
      border: 1px solid rgba(59, 130, 246, 0.2);
      box-shadow: 
        0 6px 20px rgba(0, 0, 0, 0.25),
        inset 0 1px 0 rgba(255, 255, 255, 0.08);
      position: relative;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      cursor: pointer;
      backdrop-filter: blur(15px);
      overflow: hidden;
    }

    .players-list li::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.15), transparent);
      transition: left 0.6s ease;
    }

    .players-list li:last-child {
      margin-bottom: 0;
    }

    .players-list li:hover::before {
      left: 100%;
    }

    .players-list li:hover {
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(30, 41, 59, 0.8));
      border-color: rgba(59, 130, 246, 0.4);
      transform: translateX(8px) translateY(-3px);
      box-shadow: 
        0 12px 35px rgba(59, 130, 246, 0.3),
        0 0 0 1px rgba(59, 130, 246, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.15);
    }

    .players-list li.selected {
      background: linear-gradient(135deg, rgba(16, 185, 129, 0.25), rgba(59, 130, 246, 0.15));
      border-color: #10b981;
      transform: translateX(5px);
      box-shadow: 
        0 10px 30px rgba(16, 185, 129, 0.4),
        0 0 0 1px #10b981,
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
    }

    .players-list li.selected::after {
      content: '✓';
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      width: 28px;
      height: 28px;
      background: linear-gradient(135deg, #10b981, #059669);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
      font-weight: bold;
      box-shadow: 
        0 4px 12px rgba(16, 185, 129, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
      animation: checkmark 0.3s ease-out;
    }

    @keyframes checkmark {
      0% { transform: scale(0) rotate(180deg); opacity: 0; }
      100% { transform: scale(1) rotate(0deg); opacity: 1; }
    }
    .player-avatar {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      background: linear-gradient(135deg, #3b82f6 0%, #06b6d4 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
      font-weight: 700;
      color: #ffffff;
      flex-shrink: 0;
      box-shadow: 
        0 4px 15px rgba(59, 130, 246, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
      border: 2px solid rgba(255, 255, 255, 0.1);
      letter-spacing: 0.5px;
      text-transform: uppercase;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      transition: all 0.3s ease;
    }

    .players-list li:hover .player-avatar {
      transform: scale(1.1);
      box-shadow: 
        0 6px 20px rgba(59, 130, 246, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
    }

    .players-list input[type=checkbox] {
      width: 20px;
      height: 20px;
      accent-color: #3b82f6;
      cursor: pointer;
      border-radius: 4px;
      border: 2px solid rgba(59, 130, 246, 0.3);
      background: rgba(15, 23, 42, 0.8);
      transition: all 0.3s ease;
      flex-shrink: 0;
    }

    .players-list input[type=checkbox]:checked {
      background: #3b82f6;
      border-color: #3b82f6;
      box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
    }

    .players-list label {
      flex: 1;
      cursor: pointer;
      font-weight: 600;
      color: #e2e8f0;
      letter-spacing: 0.3px;
      transition: color 0.3s ease;
    }

    .players-list li:hover label {
      color: #ffffff;
    }

    .players-list .salary-cell {
      color: #06b6d4;
      min-width: 120px;
      text-align: right;
      font-weight: 700;
      font-size: 1rem;
      letter-spacing: 0.5px;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }
    /* Totals Section */
    .totals {
      margin: 1.5rem 0;
      padding: 1.25rem;
      background: rgba(15, 23, 42, 0.8);
      border-radius: 16px;
      border: 1px solid rgba(59, 130, 246, 0.2);
      box-shadow: 
        0 8px 25px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(10px);
    }

    .totals div {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 700;
      font-size: 1.1rem;
      color: #e2e8f0;
    }

    .totals span {
      color: #06b6d4;
      font-size: 1.2rem;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    /* Payroll Box */
    .payroll-box {
      margin-top: 1.5rem;
      background: rgba(15, 23, 42, 0.9);
      border-radius: 16px;
      padding: 1.5rem;
      border: 1px solid rgba(59, 130, 246, 0.3);
      box-shadow: 
        0 8px 25px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(15px);
      position: relative;
      overflow: hidden;
    }

    .payroll-box::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, #3b82f6, #06b6d4, #8b5cf6);
      border-radius: 16px 16px 0 0;
    }

    .payroll-box .line {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
      padding: 0.5rem 0;
      border-bottom: 1px solid rgba(59, 130, 246, 0.1);
    }

    .payroll-box .line:last-child {
      margin-bottom: 0;
      border-bottom: none;
    }

    .payroll-box .level {
      font-weight: 700;
      color: #e2e8f0;
      font-size: 1rem;
    }

    .payroll-box .over {
      color: #ef4444;
      font-weight: 700;
      text-shadow: 0 2px 4px rgba(239, 68, 68, 0.3);
    }

    .payroll-box .under {
      color: #10b981;
      font-weight: 700;
      text-shadow: 0 2px 4px rgba(16, 185, 129, 0.3);
    }
    /* Analyze Trade Button */
    .analyze-section {
      text-align: center;
      margin: 4rem 0;
    }

    .trade-btn {
      background: linear-gradient(135deg, #10b981 0%, #059669 50%, #047857 100%);
      color: #ffffff;
      font-size: 1.2rem;
      font-weight: 800;
      border-radius: 20px;
      padding: 1.25rem 3.5rem;
      border: none;
      cursor: pointer;
      transition: all 0.4s ease;
      box-shadow: 
        0 15px 30px rgba(16, 185, 129, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
      letter-spacing: 1.2px;
      text-transform: uppercase;
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255, 255, 255, 0.1);
    }

    .trade-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transition: left 0.6s ease;
    }

    .trade-btn:hover::before {
      left: 100%;
    }

    .trade-btn:hover {
      transform: translateY(-4px) scale(1.05);
      box-shadow: 
        0 20px 40px rgba(16, 185, 129, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
      border-color: rgba(255, 255, 255, 0.3);
    }

    .trade-btn:active {
      transform: translateY(-2px) scale(1.02);
    }

    /* Trade Analysis Modal */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.4s ease;
    }

    .modal-overlay.show {
      opacity: 1;
      visibility: visible;
    }

    .modal-content {
      background: linear-gradient(145deg, rgba(15, 23, 42, 0.98), rgba(30, 41, 59, 0.95));
      backdrop-filter: blur(25px);
      border-radius: 24px;
      padding: 0;
      max-width: 900px;
      width: 95%;
      max-height: 85vh;
      overflow: hidden;
      border: 1px solid rgba(59, 130, 246, 0.2);
      box-shadow: 
        0 50px 100px rgba(0, 0, 0, 0.7),
        inset 0 1px 0 rgba(255, 255, 255, 0.1),
        0 0 0 1px rgba(255, 255, 255, 0.05);
      position: relative;
      transform: scale(0.8) translateY(50px);
      transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    .modal-overlay.show .modal-content {
      transform: scale(1) translateY(0);
    }

    .modal-header {
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(16, 185, 129, 0.1));
      padding: 2rem 2.5rem;
      border-bottom: 1px solid rgba(59, 130, 246, 0.2);
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: relative;
    }

    .modal-header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.5), transparent);
    }

    .modal-title {
      font-size: 1.8rem;
      font-weight: 800;
      color: #ffffff;
      background: linear-gradient(135deg, #ffffff 0%, #3b82f6 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      letter-spacing: 0.5px;
      margin: 0;
    }

    .modal-close {
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
      color: #ffffff;
      border: none;
      font-size: 1.5rem;
      font-weight: bold;
      cursor: pointer;
      padding: 0.75rem;
      border-radius: 12px;
      width: 48px;
      height: 48px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      box-shadow: 
        0 6px 20px rgba(239, 68, 68, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
    }

    .modal-close:hover {
      transform: translateY(-2px) scale(1.1);
      box-shadow: 
        0 8px 25px rgba(239, 68, 68, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
    }

    .modal-body {
      padding: 2.5rem;
      overflow-y: auto;
      max-height: calc(85vh - 120px);
    }

    .trade-result {
      text-align: center;
      margin-bottom: 2.5rem;
      padding: 2rem;
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.8), rgba(30, 41, 59, 0.6));
      border-radius: 16px;
      border: 1px solid rgba(59, 130, 246, 0.1);
    }

    .trade-status {
      font-size: 4rem;
      margin-bottom: 1rem;
      filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
    }

    .trade-status.success {
      color: #10b981;
      animation: successPulse 2s ease-in-out infinite;
    }

    .trade-status.failure {
      color: #ef4444;
      animation: failurePulse 2s ease-in-out infinite;
    }

    @keyframes successPulse {
      0%, 100% { transform: scale(1); filter: drop-shadow(0 4px 8px rgba(16, 185, 129, 0.3)); }
      50% { transform: scale(1.05); filter: drop-shadow(0 6px 12px rgba(16, 185, 129, 0.5)); }
    }

    @keyframes failurePulse {
      0%, 100% { transform: scale(1); filter: drop-shadow(0 4px 8px rgba(239, 68, 68, 0.3)); }
      50% { transform: scale(1.05); filter: drop-shadow(0 6px 12px rgba(239, 68, 68, 0.5)); }
    }

    .trade-message {
      font-size: 1.6rem;
      font-weight: 700;
      margin-bottom: 1rem;
      color: #ffffff;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    .trade-subtitle {
      font-size: 1.1rem;
      color: #94a3b8;
      font-weight: 500;
      line-height: 1.6;
    }

    .trade-details {
      background: rgba(15, 23, 42, 0.8);
      border-radius: 20px;
      padding: 2rem;
      border: 1px solid rgba(59, 130, 246, 0.2);
      box-shadow: 
        0 8px 25px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
    }

    .trade-details h3 {
      color: #ffffff;
      font-size: 1.3rem;
      font-weight: 700;
      margin-bottom: 1rem;
      border-bottom: 1px solid rgba(59, 130, 246, 0.2);
      padding-bottom: 0.5rem;
    }

    .trade-details p {
      margin-bottom: 0.75rem;
      line-height: 1.7;
      color: #e2e8f0;
    }

    .trade-details strong {
      color: #ffffff;
    }

    .trade-details .success-text {
      color: #10b981;
      font-weight: 700;
    }

    .trade-details .failure-text {
      color: #ef4444;
      font-weight: 700;
    }

    /* Apron Tracking Styles */
    .apron-section {
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.9), rgba(30, 41, 59, 0.7));
      border-radius: 16px;
      padding: 2rem;
      margin: 2rem 0;
      border: 1px solid rgba(59, 130, 246, 0.2);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
    }

    .apron-title {
      font-size: 1.4rem;
      font-weight: 700;
      color: #ffffff;
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .apron-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1.5rem;
    }

    .apron-card {
      background: rgba(15, 23, 42, 0.6);
      border-radius: 12px;
      padding: 1.5rem;
      border: 1px solid rgba(59, 130, 246, 0.1);
      transition: all 0.3s ease;
    }

    .apron-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
      border-color: rgba(59, 130, 246, 0.3);
    }

    .apron-card h4 {
      color: #ffffff;
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 1rem;
      border-bottom: 1px solid rgba(59, 130, 246, 0.2);
      padding-bottom: 0.5rem;
    }

    .apron-metric {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.75rem;
      padding: 0.5rem 0;
    }

    .apron-label {
      color: #94a3b8;
      font-size: 0.9rem;
      font-weight: 500;
    }

    .apron-value {
      font-weight: 700;
      font-size: 1rem;
    }

    .apron-value.safe {
      color: #10b981;
    }

    .apron-value.warning {
      color: #f59e0b;
    }

    .apron-value.danger {
      color: #ef4444;
    }

    .apron-bar {
      width: 100%;
      height: 8px;
      background: rgba(15, 23, 42, 0.8);
      border-radius: 4px;
      overflow: hidden;
      margin: 0.5rem 0;
      border: 1px solid rgba(59, 130, 246, 0.1);
    }

    .apron-fill {
      height: 100%;
      transition: all 0.8s ease;
      background: linear-gradient(90deg, #10b981, #059669);
    }

    .apron-fill.warning {
      background: linear-gradient(90deg, #f59e0b, #d97706);
    }

    .apron-fill.danger {
      background: linear-gradient(90deg, #ef4444, #dc2626);
    }

    .restriction-list {
      background: rgba(15, 23, 42, 0.4);
      border-radius: 8px;
      padding: 1rem;
      margin-top: 1rem;
      border-left: 4px solid #ef4444;
    }

    .restriction-list h5 {
      color: #ef4444;
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }

    .restriction-list ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .restriction-list li {
      color: #e2e8f0;
      font-size: 0.9rem;
      padding: 0.25rem 0;
      padding-left: 1rem;
      position: relative;
    }

    .restriction-list li::before {
      content: '⚠️';
      position: absolute;
      left: 0;
      font-size: 0.8rem;
    }

    /* Salary Cap Tracking Section */
    .salary-tracking {
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.8), rgba(30, 41, 59, 0.6));
      border-radius: 16px;
      padding: 1.5rem;
      margin-top: 1rem;
      border: 1px solid rgba(59, 130, 246, 0.2);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    .salary-tracking-title {
      font-size: 1.1rem;
      font-weight: 700;
      color: #ffffff;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .salary-metrics {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
    }

    .salary-metric {
      background: rgba(15, 23, 42, 0.4);
      border-radius: 8px;
      padding: 0.75rem;
      border: 1px solid rgba(59, 130, 246, 0.1);
    }

    .salary-metric-label {
      font-size: 0.85rem;
      color: #94a3b8;
      font-weight: 500;
      margin-bottom: 0.25rem;
    }

    .salary-metric-value {
      font-size: 1rem;
      font-weight: 700;
      color: #ffffff;
    }

    .salary-metric-value.safe {
      color: #10b981;
    }

    .salary-metric-value.warning {
      color: #f59e0b;
    }

    .salary-metric-value.danger {
      color: #ef4444;
    }

    .salary-progress {
      width: 100%;
      height: 6px;
      background: rgba(15, 23, 42, 0.6);
      border-radius: 3px;
      overflow: hidden;
      margin-top: 0.5rem;
    }

    .salary-progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #10b981, #059669);
      transition: all 0.6s ease;
    }

    .salary-progress-fill.warning {
      background: linear-gradient(90deg, #f59e0b, #d97706);
    }

    .salary-progress-fill.danger {
      background: linear-gradient(90deg, #ef4444, #dc2626);
    }

    /* Export Modal Styles */
    .export-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 3000;
      justify-content: center;
      align-items: center;
      backdrop-filter: blur(10px);
    }

    .export-modal-content {
      background: linear-gradient(145deg, rgba(15, 23, 42, 0.98), rgba(30, 41, 59, 0.95));
      border-radius: 24px;
      padding: 2.5rem;
      max-width: 600px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      text-align: center;
      position: relative;
      box-shadow: 
        0 50px 100px rgba(0, 0, 0, 0.7),
        inset 0 1px 0 rgba(255, 255, 255, 0.1),
        0 0 0 1px rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(59, 130, 246, 0.2);
    }

    .export-modal h2 {
      color: #ffffff;
      margin-bottom: 1rem;
      font-size: 1.8rem;
      font-weight: 800;
      background: linear-gradient(135deg, #ffffff 0%, #3b82f6 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .export-modal p {
      color: #94a3b8;
      margin-bottom: 1.5rem;
      font-size: 1.1rem;
    }

    .export-preview {
      max-width: 100%;
      height: auto;
      border-radius: 12px;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
      margin-bottom: 1.5rem;
      border: 1px solid rgba(59, 130, 246, 0.2);
    }

    .export-actions {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
    }

    .export-btn-action {
      padding: 0.8rem 1.5rem;
      border: none;
      border-radius: 10px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.95rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .copy-btn {
      background: linear-gradient(135deg, #3b82f6, #1d4ed8);
      color: #ffffff;
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
    }

    .download-btn {
      background: linear-gradient(135deg, #059669, #10b981);
      color: #ffffff;
      box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
    }

    .close-export-btn {
      background: linear-gradient(135deg, #64748b, #475569);
      color: #ffffff;
      box-shadow: 0 4px 12px rgba(100, 116, 139, 0.3);
    }

    .export-btn-action:hover {
      transform: translateY(-2px);
    }

    .copy-btn:hover {
      box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
    }

    .download-btn:hover {
      box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
    }

    .close-export-btn:hover {
      box-shadow: 0 6px 20px rgba(100, 116, 139, 0.4);
    }

    /* Export Modal Styles */
    .export-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 2000;
      justify-content: center;
      align-items: center;
      backdrop-filter: blur(10px);
    }

    .export-modal-content {
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
      border-radius: 24px;
      padding: 3rem;
      max-width: 700px;
      width: 90%;
      max-height: 90vh;
      overflow-y: auto;
      text-align: center;
      position: relative;
      box-shadow: 
        0 25px 50px rgba(0, 0, 0, 0.5),
        0 0 0 1px rgba(59, 130, 246, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(59, 130, 246, 0.2);
      color: #ffffff;
    }

    .export-modal-content h2 {
      font-size: 2rem;
      font-weight: 800;
      margin-bottom: 1rem;
      background: linear-gradient(135deg, #3b82f6, #06b6d4);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .export-modal-content p {
      color: #94a3b8;
      margin-bottom: 2rem;
      font-size: 1.1rem;
    }

    .export-preview {
      max-width: 100%;
      height: auto;
      border-radius: 16px;
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.4);
      margin-bottom: 2rem;
      border: 1px solid rgba(59, 130, 246, 0.2);
    }

    .export-actions {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
    }

    .export-btn-action {
      padding: 1rem 2rem;
      border: none;
      border-radius: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 1rem;
      min-width: 160px;
      position: relative;
      overflow: hidden;
    }

    .export-btn-action::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s ease;
    }

    .export-btn-action:hover::before {
      left: 100%;
    }

    .copy-btn {
      background: linear-gradient(135deg, #3b82f6, #1d4ed8);
      color: #ffffff;
      box-shadow: 0 6px 20px rgba(59, 130, 246, 0.3);
    }

    .download-btn {
      background: linear-gradient(135deg, #059669, #10b981);
      color: #ffffff;
      box-shadow: 0 6px 20px rgba(16, 185, 129, 0.3);
    }

    .close-export-btn {
      background: linear-gradient(135deg, #64748b, #475569);
      color: #ffffff;
      box-shadow: 0 6px 20px rgba(100, 116, 139, 0.3);
    }

    .export-btn-action:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
    }

    /* Team Block Styles */
    .team-block {
      background: linear-gradient(145deg, rgba(15, 23, 42, 0.9), rgba(30, 41, 59, 0.8));
      border-radius: 20px;
      padding: 2rem;
      margin-bottom: 2rem;
      border: 1px solid rgba(59, 130, 246, 0.2);
      box-shadow: 
        0 8px 32px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(15px);
      transition: all 0.3s ease;
    }

    .team-block:hover {
      transform: translateY(-5px);
      box-shadow: 
        0 12px 40px rgba(0, 0, 0, 0.4),
        0 0 0 1px rgba(59, 130, 246, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.15);
    }

    .team-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 2px solid rgba(59, 130, 246, 0.2);
    }

    .team-header select {
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.8), rgba(30, 41, 59, 0.6));
      color: #ffffff;
      border: 1px solid rgba(59, 130, 246, 0.3);
      border-radius: 12px;
      padding: 0.8rem 1.2rem;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      min-width: 200px;
    }

    .team-header select:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 
        0 0 0 3px rgba(59, 130, 246, 0.2),
        0 4px 15px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }

    .team-header select option {
      background: #1e293b;
      color: #e2e8f0;
      padding: 0.5rem;
    }

    /* Result Block */
    .result-block {
      background: rgba(30, 41, 59, 0.9);
      backdrop-filter: blur(15px);
      border-radius: 24px;
      max-width: 900px;
      margin: 3rem auto;
      box-shadow: 
        0 25px 50px rgba(0, 0, 0, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      padding: 2.5rem;
      font-size: 1.1rem;
      font-weight: 500;
      color: #e2e8f0;
      text-align: left;
      border: 1px solid rgba(59, 130, 246, 0.2);
      position: relative;
      overflow: hidden;
    }

    .result-block::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      border-radius: 24px 24px 0 0;
    }

    .result-block.success::before {
      background: linear-gradient(90deg, #10b981, #059669);
    }

    .result-block.fail::before {
      background: linear-gradient(90deg, #ef4444, #dc2626);
    }

    .result-block.success {
      border-color: rgba(16, 185, 129, 0.3);
      box-shadow: 
        0 25px 50px rgba(0, 0, 0, 0.4),
        0 0 0 1px rgba(16, 185, 129, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }

    .result-block.fail {
      border-color: rgba(239, 68, 68, 0.3);
      box-shadow: 
        0 25px 50px rgba(0, 0, 0, 0.4),
        0 0 0 1px rgba(239, 68, 68, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }
    .result-title {
      font-size: 1.5rem;
      font-weight: 800;
      margin-bottom: 1.5rem;
      color: #ffffff;
      background: linear-gradient(135deg, #ffffff 0%, #3b82f6 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      letter-spacing: 0.5px;
    }

    .result-block h3 {
      color: #ffffff;
      font-size: 1.3rem;
      font-weight: 700;
      margin-bottom: 1rem;
    }

    .result-block p {
      margin-bottom: 0.75rem;
      line-height: 1.7;
    }

    .result-block strong {
      color: #ffffff;
    }

    .result-block .under {
      color: #10b981;
      font-weight: 700;
    }

    .result-block .over {
      color: #ef4444;
      font-weight: 700;
    }

    /* Back Home Button */
    .back-home-section {
      text-align: center;
      margin: 4rem 0;
    }

    .back-home-btn {
      display: inline-block;
      background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
      color: #ffffff;
      padding: 1rem 2.5rem;
      border-radius: 16px;
      font-size: 1.1rem;
      font-weight: 700;
      text-decoration: none;
      box-shadow: 
        0 8px 25px rgba(30, 41, 59, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      transition: all 0.3s ease;
      border: 1px solid rgba(59, 130, 246, 0.2);
      backdrop-filter: blur(10px);
      letter-spacing: 0.5px;
    }

    .back-home-btn:hover {
      background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
      transform: translateY(-2px);
      box-shadow: 
        0 12px 35px rgba(59, 130, 246, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
      color: #ffffff;
    }

    /* Responsive Design */
    @media (max-width: 1200px) {
      .trade-container {
        grid-template-columns: 1fr;
        max-width: 600px;
        margin: 3rem auto;
      }
      
      .hero-title {
        font-size: 3rem;
      }
    }

    @media (max-width: 768px) {
      .main-container {
        padding: 0 1rem 4rem 1rem;
      }

      .hero-section {
        padding: 3rem 0 2rem 0;
      }

      .hero-title {
        font-size: 2.5rem;
      }

      .hero-subtitle {
        font-size: 1.1rem;
      }

      .description-section {
        padding: 2rem;
        margin: 2rem auto;
      }

      .control-panel {
        padding: 1.5rem;
        margin: 2rem auto;
      }

      .control-buttons {
        flex-direction: column;
        gap: 1rem;
      }

      .control-btn {
        width: 100%;
      }

      .team-block {
        padding: 1.5rem;
      }

      .team-header {
        flex-direction: column;
        gap: 1rem;
        align-items: stretch;
      }

      .team-header select {
        width: 100%;
      }

      .trade-btn {
        padding: 1.25rem 2.5rem;
        font-size: 1.1rem;
      }

      .result-block {
        padding: 2rem;
        margin: 2rem auto;
      }

      .back-home-btn {
        padding: 0.875rem 2rem;
        font-size: 1rem;
      }
    }

    @media (max-width: 480px) {
      .hero-title {
        font-size: 2rem;
      }

      .description-section,
      .control-panel,
      .team-block,
      .result-block {
        padding: 1.5rem;
      }

      .trade-btn {
        padding: 1rem 2rem;
        font-size: 1rem;
      }
    }

    /* Salary Tracking Styles */
    .salary-tracking {
      margin-top: 2rem;
      padding: 1.5rem;
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.8), rgba(30, 41, 59, 0.6));
      border-radius: 16px;
      border: 1px solid rgba(59, 130, 246, 0.2);
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
    }

    .salary-tracking-title {
      font-size: 1.2rem;
      font-weight: 700;
      color: #ffffff;
      margin-bottom: 1rem;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .salary-metrics {
      display: grid;
      gap: 1rem;
    }

    .salary-metric {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.8rem 1rem;
      background: rgba(15, 23, 42, 0.6);
      border-radius: 12px;
      border: 1px solid rgba(59, 130, 246, 0.1);
      transition: all 0.3s ease;
    }

    .salary-metric:hover {
      border-color: rgba(59, 130, 246, 0.3);
      background: rgba(59, 130, 246, 0.05);
      transform: translateX(3px);
    }

    .salary-metric-label {
      color: #94a3b8;
      font-weight: 600;
      font-size: 0.9rem;
    }

    .salary-metric-value {
      font-weight: 700;
      font-size: 1rem;
    }

    .salary-metric-value.safe {
      color: #10b981;
    }

    .salary-metric-value.warning {
      color: #f59e0b;
    }

    .salary-metric-value.danger {
      color: #ef4444;
    }

    .salary-progress {
      width: 100%;
      height: 6px;
      background: rgba(30, 41, 59, 0.8);
      border-radius: 3px;
      overflow: hidden;
      margin-top: 0.5rem;
    }

    .salary-progress-fill {
      height: 100%;
      border-radius: 3px;
      transition: width 0.8s ease;
      position: relative;
    }

    .salary-progress-fill.safe {
      background: linear-gradient(90deg, #10b981, #34d399);
    }

    .salary-progress-fill.warning {
      background: linear-gradient(90deg, #f59e0b, #fbbf24);
    }

    .salary-progress-fill.danger {
      background: linear-gradient(90deg, #ef4444, #f87171);
    }

    .salary-cell {
      color: #10b981;
      font-weight: 700;
      font-size: 0.95rem;
      margin-left: auto;
      padding: 0.4rem 0.8rem;
      background: rgba(16, 185, 129, 0.1);
      border-radius: 8px;
      border: 1px solid rgba(16, 185, 129, 0.2);
      transition: all 0.3s ease;
    }

    .salary-cell:hover {
      background: rgba(16, 185, 129, 0.2);
      border-color: rgba(16, 185, 129, 0.4);
    }

    /* Loading Spinner */
    .loading-spinner {
      width: 20px;
      height: 20px;
      border: 2px solid rgba(59, 130, 246, 0.3);
      border-top: 2px solid #3b82f6;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Slide-in animations */
    @keyframes slideInUp {
      0% {
        opacity: 0;
        transform: translateY(20px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeInUp {
      0% {
        opacity: 0;
        transform: translateY(10px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Enhanced team block animations */
    .team-block {
      animation: fadeInUp 0.6s ease;
    }

    /* Pulse animation for active elements */
    @keyframes pulse {
      0%, 100% {
        box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.4);
      }
      50% {
        box-shadow: 0 0 0 10px rgba(59, 130, 246, 0);
      }
    }

    .control-btn:active {
      animation: pulse 0.6s ease-out;
    }

    .trade-btn:active {
      animation: pulse 0.6s ease-out;
    }

    /* Professional Trade Result Modal Styles */
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      backdrop-filter: blur(20px);
      z-index: 10000;
      justify-content: center;
      align-items: center;
      opacity: 0;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .modal-overlay.show {
      display: flex !important;
      opacity: 1;
      animation: modalFadeIn 0.5s ease-out forwards;
    }

    @keyframes modalFadeIn {
      0% {
        opacity: 0;
        backdrop-filter: blur(0px);
      }
      100% {
        opacity: 1;
        backdrop-filter: blur(20px);
      }
    }

    .modal-content {
      background: linear-gradient(145deg, #0f172a 0%, #1e293b 50%, #334155 100%);
      border-radius: 32px;
      max-width: 95vw;
      max-height: 95vh;
      width: 1000px;
      overflow-y: auto;
      position: relative;
      box-shadow: 
        0 50px 100px rgba(0, 0, 0, 0.8),
        0 0 0 1px rgba(59, 130, 246, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      border: 2px solid rgba(59, 130, 246, 0.2);
      transform: scale(0.8) translateY(50px);
      animation: modalSlideIn 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    }

    @keyframes modalSlideIn {
      0% {
        transform: scale(0.8) translateY(50px);
        opacity: 0;
      }
      100% {
        transform: scale(1) translateY(0);
        opacity: 1;
      }
    }

    .modal-header {
      background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
      padding: 2rem 2.5rem;
      border-radius: 32px 32px 0 0;
      border-bottom: 2px solid rgba(59, 130, 246, 0.3);
      position: relative;
      overflow: hidden;
    }

    .modal-header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #3b82f6, #06b6d4, #8b5cf6, #f59e0b, #3b82f6);
      background-size: 300% 100%;
      animation: rainbow 4s ease-in-out infinite;
    }

    .modal-title {
      font-size: 2.2rem;
      font-weight: 900;
      color: #ffffff;
      margin: 0;
      text-align: center;
      background: linear-gradient(135deg, #ffffff 0%, #3b82f6 50%, #06b6d4 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      letter-spacing: -1px;
      text-shadow: 0 4px 20px rgba(59, 130, 246, 0.3);
    }

    .modal-close {
      position: absolute;
      top: 1.5rem;
      right: 2rem;
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
      color: #ffffff;
      border: none;
      width: 48px;
      height: 48px;
      border-radius: 50%;
      font-size: 1.5rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 
        0 8px 25px rgba(239, 68, 68, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-close:hover {
      transform: scale(1.1) rotate(90deg);
      box-shadow: 
        0 12px 35px rgba(239, 68, 68, 0.6),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
    }

    .modal-body {
      padding: 2.5rem;
      color: #e2e8f0;
    }

    .trade-result {
      text-align: center;
      margin-bottom: 3rem;
      padding: 2.5rem;
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.8), rgba(30, 41, 59, 0.6));
      border-radius: 24px;
      border: 1px solid rgba(59, 130, 246, 0.2);
      position: relative;
      overflow: hidden;
    }

    .trade-result::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, #3b82f6, #06b6d4, #8b5cf6);
      border-radius: 24px 24px 0 0;
    }

    .trade-status {
      font-size: 5rem;
      margin-bottom: 1.5rem;
      display: block;
      animation: statusPulse 2s ease-in-out infinite;
      filter: drop-shadow(0 8px 20px rgba(0, 0, 0, 0.5));
    }

    @keyframes statusPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    .trade-status.success {
      animation: successBounce 1s ease-out;
    }

    .trade-status.failure {
      animation: failureShake 0.8s ease-out;
    }

    @keyframes successBounce {
      0% { transform: scale(0) rotate(180deg); opacity: 0; }
      50% { transform: scale(1.3) rotate(0deg); opacity: 1; }
      100% { transform: scale(1) rotate(0deg); opacity: 1; }
    }

    @keyframes failureShake {
      0%, 100% { transform: translateX(0); }
      10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
      20%, 40%, 60%, 80% { transform: translateX(10px); }
    }

    .trade-message {
      font-size: 2.5rem;
      font-weight: 900;
      margin-bottom: 1rem;
      letter-spacing: -1px;
      text-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
    }

    .trade-message.success {
      background: linear-gradient(135deg, #10b981 0%, #34d399 50%, #6ee7b7 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .trade-message.failure {
      background: linear-gradient(135deg, #ef4444 0%, #f87171 50%, #fca5a5 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .trade-subtitle {
      font-size: 1.3rem;
      color: #94a3b8;
      font-weight: 500;
      line-height: 1.6;
      max-width: 600px;
      margin: 0 auto;
    }

    .trade-details {
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.9), rgba(30, 41, 59, 0.7));
      border-radius: 20px;
      padding: 2.5rem;
      margin: 2rem 0;
      border: 1px solid rgba(59, 130, 246, 0.2);
      box-shadow: 
        0 20px 40px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      position: relative;
      overflow: hidden;
    }

    .trade-details::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, #3b82f6, #06b6d4);
      border-radius: 20px 20px 0 0;
    }

    .trade-details h3 {
      color: #ffffff;
      font-size: 1.8rem;
      font-weight: 800;
      margin-bottom: 1.5rem;
      text-align: center;
      background: linear-gradient(135deg, #ffffff 0%, #3b82f6 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .trade-details h4 {
      color: #3b82f6;
      font-size: 1.4rem;
      font-weight: 700;
      margin: 1.5rem 0 1rem 0;
      border-bottom: 2px solid rgba(59, 130, 246, 0.3);
      padding-bottom: 0.5rem;
    }

    .trade-details p {
      margin-bottom: 1rem;
      line-height: 1.8;
      color: #cbd5e1;
      font-size: 1.1rem;
    }

    .trade-details ul {
      margin: 1rem 0;
      padding-left: 1.5rem;
    }

    .trade-details li {
      margin: 0.75rem 0;
      color: #e2e8f0;
      font-size: 1rem;
      line-height: 1.6;
      position: relative;
    }

    .trade-details li::marker {
      color: #3b82f6;
    }

    .trade-details strong {
      color: #ffffff;
      font-weight: 700;
    }

    .trade-details .success-text {
      color: #10b981;
      font-weight: 700;
      text-shadow: 0 2px 4px rgba(16, 185, 129, 0.3);
    }

    .trade-details .failure-text {
      color: #ef4444;
      font-weight: 700;
      text-shadow: 0 2px 4px rgba(239, 68, 68, 0.3);
    }

    /* Enhanced grid layouts for trade details */
    .trade-details > div[style*="grid"] {
      background: rgba(15, 23, 42, 0.6);
      border-radius: 16px;
      padding: 1.5rem;
      border: 1px solid rgba(59, 130, 246, 0.1);
      margin: 1rem 0;
    }

    .trade-details > div[style*="grid"] > div {
      padding: 0.75rem;
      background: rgba(30, 41, 59, 0.4);
      border-radius: 12px;
      border: 1px solid rgba(59, 130, 246, 0.1);
      transition: all 0.3s ease;
    }

    .trade-details > div[style*="grid"] > div:hover {
      background: rgba(59, 130, 246, 0.1);
      border-color: rgba(59, 130, 246, 0.3);
      transform: translateY(-2px);
    }

    /* Interactive elements */
    .modal-content::-webkit-scrollbar {
      width: 12px;
    }

    .modal-content::-webkit-scrollbar-track {
      background: rgba(30, 41, 59, 0.5);
      border-radius: 6px;
    }

    .modal-content::-webkit-scrollbar-thumb {
      background: linear-gradient(135deg, #3b82f6, #06b6d4);
      border-radius: 6px;
      border: 2px solid rgba(30, 41, 59, 0.5);
    }

    .modal-content::-webkit-scrollbar-thumb:hover {
      background: linear-gradient(135deg, #2563eb, #0891b2);
    }

    /* Responsive modal design */
    @media (max-width: 768px) {
      .modal-content {
        width: 95vw;
        max-height: 90vh;
        border-radius: 20px;
      }

      .modal-header {
        padding: 1.5rem;
        border-radius: 20px 20px 0 0;
      }

      .modal-title {
        font-size: 1.8rem;
      }

      .modal-close {
        top: 1rem;
        right: 1rem;
        width: 40px;
        height: 40px;
        font-size: 1.2rem;
      }

      .modal-body {
        padding: 1.5rem;
      }

      .trade-result {
        padding: 1.5rem;
        margin-bottom: 2rem;
      }

      .trade-status {
        font-size: 3.5rem;
      }

      .trade-message {
        font-size: 1.8rem;
      }

      .trade-subtitle {
        font-size: 1.1rem;
      }

      .trade-details {
        padding: 1.5rem;
      }

      .trade-details h3 {
        font-size: 1.4rem;
      }

      .trade-details h4 {
        font-size: 1.2rem;
      }
    }

    /* Loading state for modal */
    .modal-loading {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 4rem;
    }

    .modal-loading .loading-spinner {
      width: 60px;
      height: 60px;
      border: 4px solid rgba(59, 130, 246, 0.3);
      border-top: 4px solid #3b82f6;
    }

    /* Quick Stats Styles */
    .quick-stat {
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.8), rgba(30, 41, 59, 0.6));
      border-radius: 16px;
      padding: 1.5rem;
      text-align: center;
      border: 1px solid rgba(59, 130, 246, 0.2);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
      min-width: 120px;
    }

    .quick-stat:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 35px rgba(59, 130, 246, 0.3);
      border-color: rgba(59, 130, 246, 0.4);
    }

    .quick-stat-value {
      font-size: 2rem;
      font-weight: 900;
      color: #3b82f6;
      margin-bottom: 0.5rem;
      text-shadow: 0 2px 4px rgba(59, 130, 246, 0.3);
    }

    .quick-stat-label {
      font-size: 0.9rem;
      color: #94a3b8;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* Modal Tabs Styles */
    .modal-tabs {
      margin-top: 2rem;
    }

    .tab-buttons {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 2rem;
      background: rgba(15, 23, 42, 0.6);
      border-radius: 16px;
      padding: 0.5rem;
      border: 1px solid rgba(59, 130, 246, 0.2);
    }

    .tab-button {
      flex: 1;
      background: transparent;
      color: #94a3b8;
      border: none;
      padding: 1rem 1.5rem;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .tab-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.1), transparent);
      transition: left 0.5s ease;
    }

    .tab-button:hover::before {
      left: 100%;
    }

    .tab-button:hover {
      color: #e2e8f0;
      background: rgba(59, 130, 246, 0.1);
    }

    .tab-button.active {
      background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
      color: #ffffff;
      box-shadow: 
        0 8px 25px rgba(59, 130, 246, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
    }

    .tab-button.active:hover {
      background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
    }

    .tab-content {
      position: relative;
    }

    .tab-panel {
      display: none;
      animation: tabFadeIn 0.4s ease-out;
    }

    .tab-panel.active {
      display: block;
    }

    @keyframes tabFadeIn {
      0% {
        opacity: 0;
        transform: translateY(20px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Trade Summary Styles */
    .trade-summary {
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.9), rgba(30, 41, 59, 0.7));
      border-radius: 20px;
      padding: 2.5rem;
      border: 1px solid rgba(59, 130, 246, 0.2);
      box-shadow: 
        0 20px 40px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }

    .summary-section {
      margin-bottom: 2rem;
      padding: 1.5rem;
      background: rgba(15, 23, 42, 0.6);
      border-radius: 16px;
      border: 1px solid rgba(59, 130, 246, 0.1);
    }

    .summary-section h4 {
      color: #3b82f6;
      font-size: 1.3rem;
      font-weight: 700;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .summary-highlight {
      background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(59, 130, 246, 0.1));
      border: 1px solid rgba(16, 185, 129, 0.3);
      border-radius: 12px;
      padding: 1rem;
      margin: 1rem 0;
    }

    .summary-highlight.warning {
      background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(239, 68, 68, 0.1));
      border-color: rgba(245, 158, 11, 0.3);
    }

    /* Enhanced Action Buttons */
    .export-btn-action {
      padding: 0.8rem 1.5rem;
      border: none;
      border-radius: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.95rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      position: relative;
      overflow: hidden;
    }

    .export-btn-action::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s ease;
    }

    .export-btn-action:hover::before {
      left: 100%;
    }

    .export-btn-action:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
    }

    /* Responsive enhancements for new elements */
    @media (max-width: 768px) {
      .tab-buttons {
        flex-direction: column;
        gap: 0.25rem;
      }

      .tab-button {
        padding: 0.8rem 1rem;
        font-size: 0.9rem;
      }

      .quick-stat {
        min-width: 100px;
        padding: 1rem;
      }

      .quick-stat-value {
        font-size: 1.5rem;
      }

      .export-container {
        flex-direction: column !important;
        align-items: center;
      }

      .export-btn-action {
        width: 100%;
        max-width: 250px;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <!-- Navigation will be automatically injected here by nav.js -->

  <!-- Hero Section -->
  <section class="hero-section">
    <div class="hero-content">
      <h1 class="hero-title">⚡ NBA Trade Simulator Pro</h1>
      <p class="hero-subtitle">Professional NBA trade analysis with real-time salary cap tracking, apron monitoring, and comprehensive CBA compliance verification.</p>
    </div>
  </section>

  <!-- Main Container -->
  <div class="main-container">
    <!-- Description Section -->
    <section class="description-section">
      <div class="description-text">
        <strong>Welcome to the NBA Trade Machine!</strong> This interactive tool allows you to simulate trades between NBA teams, analyze salary cap implications, and explore potential trade scenarios. Select players from different teams, analyze the financial impact, and see if your proposed trades would work under NBA salary cap rules.
      </div>
    </section>

    <!-- Control Panel -->
    <section class="control-panel">
      <h2 class="control-title">Trade Controls</h2>
      <div class="control-buttons">
        <button class="control-btn" onclick="addTeam()"><span>+ Add Team</span></button>
        <button class="control-btn" onclick="clearAllTrades()"><span>Clear All</span></button>
      </div>
    </section>

    <!-- Trade Container -->
    <div class="trade-container" id="tradeContainer">
      <!-- Teams will be dynamically added here -->
    </div>

    <!-- Analyze Section -->
    <section class="analyze-section">
      <button class="trade-btn" onclick="analyzeTrade()">🚀 Execute Trade Analysis</button>
    </section>

    <!-- Enhanced Trade Analysis Modal -->
    <div id="tradeModal" class="modal-overlay">
      <div class="modal-content">
        <div class="modal-header">
          <h2 class="modal-title">🏀 NBA Trade Analysis Report</h2>
          <button class="modal-close" onclick="closeTradeModal()" title="Close Modal">×</button>
        </div>
        <div class="modal-body">
          <!-- Action Buttons -->
          <div class="export-container" style="margin-bottom: 2rem; text-align: center; display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
            <button id="exportTradeBtn" class="export-btn-action copy-btn" title="Share this trade analysis">
              📸 Share Analysis
            </button>
            <button id="reAnalyzeBtn" class="export-btn-action" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed);" title="Re-analyze this trade">
              🔄 Re-analyze
            </button>
            <button id="newTradeBtn" class="export-btn-action" style="background: linear-gradient(135deg, #f59e0b, #d97706);" title="Start a new trade">
              🆕 New Trade
            </button>
          </div>

          <!-- Trade Result Section -->
          <div class="trade-result">
            <div id="tradeStatus" class="trade-status"></div>
            <div id="tradeMessage" class="trade-message"></div>
            <div id="tradeSubtitle" class="trade-subtitle"></div>
            
            <!-- Quick Stats Bar -->
            <div style="display: flex; justify-content: center; gap: 2rem; margin-top: 2rem; flex-wrap: wrap;">
              <div class="quick-stat" id="quickStatTeams">
                <div class="quick-stat-value">-</div>
                <div class="quick-stat-label">Teams</div>
              </div>
              <div class="quick-stat" id="quickStatPlayers">
                <div class="quick-stat-value">-</div>
                <div class="quick-stat-label">Players</div>
              </div>
              <div class="quick-stat" id="quickStatSalary">
                <div class="quick-stat-value">-</div>
                <div class="quick-stat-label">Total Salary</div>
              </div>
            </div>
          </div>

          <!-- Tabbed Content -->
          <div class="modal-tabs">
            <div class="tab-buttons">
              <button class="tab-button active" onclick="switchTab('details')" data-tab="details">
                📊 Trade Details
              </button>
              <button class="tab-button" onclick="switchTab('apron')" data-tab="apron">
                💰 Salary Cap Impact
              </button>
              <button class="tab-button" onclick="switchTab('summary')" data-tab="summary">
                📋 Executive Summary
              </button>
            </div>
            
            <div class="tab-content">
              <div id="tab-details" class="tab-panel active">
                <div id="tradeDetails" class="trade-details"></div>
              </div>
              
              <div id="tab-apron" class="tab-panel">
                <div id="apronTracking" class="apron-section"></div>
              </div>
              
              <div id="tab-summary" class="tab-panel">
                <div id="tradeSummary" class="trade-summary">
                  <!-- Executive summary will be populated here -->
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Export Modal -->
    <div id="exportModal" class="export-modal">
      <div class="export-modal-content">
        <h2>Share Trade Analysis</h2>
        <p>Your NBA trade analysis is ready for social media sharing!</p>
        <canvas id="exportCanvas" style="display:none;"></canvas>
        <img id="exportPreview" class="export-preview" alt="Trade analysis export preview">
        <div class="export-actions">
          <button id="copyTradeBtn" class="export-btn-action copy-btn">📋 Copy to Clipboard</button>
          <button id="downloadTradeBtn" class="export-btn-action download-btn">📥 Download Image</button>
          <button id="closeExportModal" class="export-btn-action close-export-btn">✕ Close</button>
        </div>
      </div>
    </div>

    <!-- Back Home -->
    <section class="back-home-section">
      <a href="index.html" class="back-home-btn">← Back to Home</a>
    </section>
  </div>

  <!-- Navigation JavaScript - Auto-updates when you modify nav.js -->
  <script src="nav.js"></script>
  
  <script>
    // NBA Teams data
    const nbaTeams = {
      'ATL': { name: 'Atlanta Hawks', color: '#E03A3E' },
      'BOS': { name: 'Boston Celtics', color: '#007A33' },
      'BRK': { name: 'Brooklyn Nets', color: '#000000' },
      'CHA': { name: 'Charlotte Hornets', color: '#1D1160' },
      'CHI': { name: 'Chicago Bulls', color: '#CE1141' },
      'CLE': { name: 'Cleveland Cavaliers', color: '#860038' },
      'DAL': { name: 'Dallas Mavericks', color: '#00538C' },
      'DEN': { name: 'Denver Nuggets', color: '#0E2240' },
      'DET': { name: 'Detroit Pistons', color: '#C8102E' },
      'GSW': { name: 'Golden State Warriors', color: '#1D428A' },
      'HOU': { name: 'Houston Rockets', color: '#CE1141' },
      'IND': { name: 'Indiana Pacers', color: '#002D62' },
      'LAC': { name: 'LA Clippers', color: '#1D428A' },
      'LAL': { name: 'Los Angeles Lakers', color: '#552583' },
      'MEM': { name: 'Memphis Grizzlies', color: '#5D76A9' },
      'MIA': { name: 'Miami Heat', color: '#98002E' },
      'MIL': { name: 'Milwaukee Bucks', color: '#00471B' },
      'MIN': { name: 'Minnesota Timberwolves', color: '#0C2340' },
      'NOP': { name: 'New Orleans Pelicans', color: '#0C2340' },
      'NYK': { name: 'New York Knicks', color: '#006BB6' },
      'OKC': { name: 'Oklahoma City Thunder', color: '#007AC1' },
      'ORL': { name: 'Orlando Magic', color: '#0077C0' },
      'PHI': { name: 'Philadelphia 76ers', color: '#0057e7' },
      'PHX': { name: 'Phoenix Suns', color: '#1D1160' },
      'POR': { name: 'Portland Trail Blazers', color: '#E03A3E' },
      'SAC': { name: 'Sacramento Kings', color: '#5A2D81' },
      'SAS': { name: 'San Antonio Spurs', color: '#C4CED4' },
      'TOR': { name: 'Toronto Raptors', color: '#CE1141' },
      'UTA': { name: 'Utah Jazz', color: '#002B5C' },
      'WAS': { name: 'Washington Wizards', color: '#002B5C' }
    };

    // NBA Salary Cap Constants (2025-26 Season) - CORRECT NUMBERS
    const NBA_SALARY_CONSTANTS = {
      SALARY_CAP: 154647000,           // $154.647 million
      LUXURY_TAX_THRESHOLD: 187895000, // $187.895 million
      FIRST_APRON: 195945000,          // $195.945 million
      SECOND_APRON: 207824000          // $207.824 million
    };

    // Destructure constants for use throughout the code
    const {
      SALARY_CAP,
      LUXURY_TAX_THRESHOLD: LUXURY_TAX, // alias for legacy code
      FIRST_APRON,
      SECOND_APRON
    } = NBA_SALARY_CONSTANTS;

    // NBA Player Rosters Data
    const playersData = {
      'ATL': [
        { name: "Trae Young", salary: 45999660, position: "PG" },
        { name: "Kristaps Porziņģis", salary: 30731707, position: "C" },
        { name: "Jalen Johnson", salary: 30000000, position: "PF" },
        { name: "Nickeil Alexander-Walker", salary: 15161800, position: "SG" },
        { name: "Onyeka Okongwu", salary: 15000000, position: "C" },
        { name: "Zaccharie Risacher", salary: 13197720, position: "SF" },
        { name: "Luke Kennard", salary: 11000000, position: "SG" },
        { name: "Dyson Daniels", salary: 7707709, position: "PG" },
        { name: "Kobe Bufkin", salary: 4503720, position: "PG" },
        { name: "Asa Newell", salary: 3237480, position: "PF" },
        { name: "Vít Krejčí", salary: 2349578, position: "SG" },
        { name: "Caleb Houstan", salary: 2296274, position: "SF" },
        { name: "Mouhamed Gueye", salary: 2221677, position: "PF" },
        { name: "Nikola Đurišić", salary: 1272870, position: "SF" }
      ],
      'BOS': [
        { name: "Jayson Tatum", salary: 54126450, position: "SF" },
        { name: "Jaylen Brown", salary: 53142264, position: "SG" },
        { name: "Derrick White", salary: 27750000, position: "PG" },
        { name: "Anfernee Simons", salary: 27678571, position: "SG" },
        { name: "Sam Hauser", salary: 10044644, position: "SF" },
        { name: "Georges Niang", salary: 8200000, position: "PF" },
        { name: "Payton Pritchard", salary: 7232143, position: "PG" },
        { name: "Hugo González", salary: 2783880, position: "C" },
        { name: "Baylor Scheierman", salary: 2619000, position: "SG" },
        { name: "Xavier Tillman", salary: 2546674, position: "C" },
        { name: "Luka Garza", salary: 2461463, position: "C" },
        { name: "Josh Minott", salary: 2378870, position: "SF" },
        { name: "Neemias Queta", salary: 2349578, position: "C" },
        { name: "Jordan Walsh", salary: 2221677, position: "SF" }
      ],
      'BRK': [
        { name: "Michael Porter Jr.", salary: 38333050, position: "SF" },
        { name: "Nicolas Claxton", salary: 25352272, position: "C" },
        { name: "Terance Mann", salary: 15500000, position: "SG" },
        { name: "Egor Demin", salary: 6889200, position: "PG" },
        { name: "Day'Ron Sharpe", salary: 6000000, position: "C" },
        { name: "Ziaire Williams", salary: 6000000, position: "SF" },
        { name: "Nolan Traoré", salary: 3811560, position: "PG" },
        { name: "Noah Clowney", salary: 3398640, position: "PF" },
        { name: "Dariq Whitehead", salary: 3262560, position: "SG" },
        { name: "Drake Powell", salary: 3372240, position: "SF" },
        { name: "Ben Saraf", salary: 2884560, position: "PG" },
        { name: "Danny Wolf", salary: 2801280, position: "C" },
        { name: "Keon Johnson", salary: 2349578, position: "SG" },
        { name: "Jalen Wilson", salary: 2221677, position: "SF" },
        { name: "Tyrese Martin", salary: 2191897, position: "SF" },
        { name: "Drew Timme", salary: 1955378, position: "C" }
      ],
      'CHA': [
        { name: "LaMelo Ball", salary: 37958760, position: "PG" },
        { name: "Miles Bridges", salary: 25000000, position: "SF" },
        { name: "Collin Sexton", salary: 18975000, position: "PG" },
        { name: "Josh Green", salary: 13666666, position: "SG" },
        { name: "Grant Williams", salary: 13645500, position: "PF" },
        { name: "Brandon Miller", salary: 11968800, position: "SF" },
        { name: "Kon Knueppel", salary: 10015680, position: "SG" },
        { name: "Pat Connaughton", salary: 9423860, position: "SG" },
        { name: "Tre Mann", salary: 8000000, position: "PG" },
        { name: "Tidjane Salaün", salary: 7863240, position: "SF" },
        { name: "Liam McNeeley", salary: 2763960, position: "SF" },
        { name: "DaQuan Jeffries", salary: 2743770, position: "SF" },
        { name: "Nick Smith Jr.", salary: 2710680, position: "PG" },
        { name: "Spencer Dinwiddie", salary: 2296270, position: "PG" },
        { name: "Sion James", salary: 2296270, position: "SG" },
        { name: "Ryan Kalkbrenner", salary: 2296270, position: "C" },
        { name: "Mason Plumlee", salary: 2296270, position: "C" },
        { name: "Mousa Diabate", salary: 2270730, position: "C" }
      ],
      'CHI': [
        { name: "Nikola Vučević", salary: 21481481, position: "C" },
        { name: "Zach Collins", salary: 18080496, position: "C" },
        { name: "Patrick Williams", salary: 18000000, position: "PF" },
        { name: "Kevin Huerter", salary: 17991071, position: "SG" },
        { name: "Coby White", salary: 12888889, position: "PG" },
        { name: "Isaac Okoro", salary: 11000000, position: "SF" },
        { name: "Jalen Smith", salary: 9000000, position: "PF" },
        { name: "Tre Jones", salary: 8000000, position: "PG" },
        { name: "Ayo Dosunmu", salary: 7518518, position: "SG" },
        { name: "Jevon Carter", salary: 6809524, position: "PG" },
        { name: "Matas Buzelis", salary: 5455560, position: "SF" },
        { name: "Noa Essengue", salary: 5429520, position: "PF" },
        { name: "Dalen Terry", salary: 5399118, position: "SG" },
        { name: "Julian Phillips", salary: 2221677, position: "SF" }
      ],
      'CLE': [
        { name: "Donovan Mitchell", salary: 46394100, position: "SG" },
        { name: "Evan Mobley", salary: 46394100, position: "PF" },
        { name: "Darius Garland", salary: 39446090, position: "PG" },
        { name: "DeAndre Hunter", salary: 23303571, position: "SF" },
        { name: "Jarrett Allen", salary: 20000000, position: "C" },
        { name: "Max Strus", salary: 15936452, position: "SG" },
        { name: "Lonzo Ball", salary: 10000000, position: "PG" },
        { name: "Sam Merrill", salary: 8482144, position: "SG" },
        { name: "Dean Wade", salary: 6623456, position: "PF" },
        { name: "Jaylon Tyson", salary: 3492480, position: "SF" },
        { name: "Larry Nance Jr.", salary: 2296274, position: "PF" },
        { name: "Craig Porter Jr.", salary: 2221677, position: "PG" },
        { name: "Tyrese Proctor", salary: 1272870, position: "PG" }
      ],
      'DAL': [
        { name: "Anthony Davis", salary: 54126450, position: "PF" },
        { name: "Kyrie Irving", salary: 36566002, position: "PG" },
        { name: "Klay Thompson", salary: 16666667, position: "SG" },
        { name: "Daniel Gafford", salary: 14386320, position: "C" },
        { name: "P.J. Washington", salary: 14152174, position: "PF" },
        { name: "Cooper Flagg", salary: 13825920, position: "SF" },
        { name: "Caleb Martin", salary: 9594044, position: "SF" },
        { name: "Naji Marshall", salary: 9000000, position: "SF" },
        { name: "Max Christie", salary: 7714286, position: "SG" },
        { name: "Jaden Hardy", salary: 6000000, position: "SG" },
        { name: "D'Angelo Russell", salary: 5685000, position: "PG" },
        { name: "Dereck Lively II", salary: 5253360, position: "C" },
        { name: "Dwight Powell", salary: 4000000, position: "C" },
        { name: "Olivier-Maxence Prosper", salary: 3007080, position: "SF" },
        { name: "Dante Exum", salary: 2296274, position: "PG" },
        { name: "Brandon Williams", salary: 2270735, position: "PG" }
      ],
      'DEN': [
        { name: "Nikola Jokić", salary: 55224520, position: "C" },
        { name: "Jamal Murray", salary: 46394100, position: "PG" },
        { name: "Aaron Gordon", salary: 22841450, position: "PF" },
        { name: "Cameron Johnson", salary: 21057060, position: "SF" },
        { name: "Jonas Valančiūnas", salary: 10395000, position: "C" },
        { name: "Zeke Nnaji", salary: 8177770, position: "PF" },
        { name: "Christian Braun", salary: 4921790, position: "SG" },
        { name: "Peyton Watson", salary: 4356470, position: "SF" },
        { name: "DaRon Holmes", salary: 3218760, position: "PF" },
        { name: "Julian Strawther", salary: 2674200, position: "SG" },
        { name: "Bruce Brown", salary: 2296270, position: "SG" },
        { name: "Tim Hardaway Jr.", salary: 2296270, position: "SG" },
        { name: "Jalen Pickett", salary: 2221670, position: "PG" },
        { name: "Hunter Tyson", salary: 2221670, position: "SF" }
      ],
      'DET': [
        { name: "Cade Cunningham", salary: 46394100, position: "PG" },
        { name: "Tobias Harris", salary: 26634147, position: "PF" },
        { name: "Duncan Robinson", salary: 16834692, position: "SG" },
        { name: "Isaiah Stewart", salary: 15000000, position: "PF" },
        { name: "Caris LeVert", salary: 14104000, position: "SG" },
        { name: "Jaden Ivey", salary: 10107163, position: "SG" },
        { name: "Ausar Thompson", salary: 8775000, position: "SF" },
        { name: "Ron Holland", salary: 8657280, position: "SF" },
        { name: "Jalen Duren", salary: 6483144, position: "C" },
        { name: "Paul Reed", salary: 5335894, position: "C" },
        { name: "Marcus Sasser", salary: 2886720, position: "PG" },
        { name: "Bobi Klintman", salary: 1955378, position: "SF" },
        { name: "Chaz Lanier", salary: 1372870, position: "SG" }
      ],
      'PHI': [
        { name: "Joel Embiid", salary: 55224520, position: "C" },
        { name: "Paul George", salary: 51666090, position: "SF" },
        { name: "Tyrese Maxey", salary: 37958760, position: "PG" },
        { name: "VJ Edgecombe", salary: 11108880, position: "SG" },
        { name: "Kelly Oubre Jr.", salary: 8382150, position: "SF" },
        { name: "Andre Drummond", salary: 5000000, position: "C" },
        { name: "Jared McCain", salary: 4221360, position: "PG" },
        { name: "Trendon Watford", salary: 2461460, position: "PF" },
        { name: "Eric Gordon", salary: 2296274, position: "SG" },
        { name: "Kyle Lowry", salary: 2296274, position: "PG" },
        { name: "Ricky Council IV", salary: 2221677, position: "SG" },
        { name: "Justin Edwards", salary: 2048490, position: "SG" },
        { name: "Adem Bona", salary: 1955378, position: "C" },
        { name: "Johni Broome", salary: 1272870, position: "C" }
      ],
      'LAL': [
        { name: "LeBron James", salary: 48728845, position: "SF" },
        { name: "Anthony Davis", salary: 43219440, position: "PF" },
        { name: "Russell Westbrook", salary: 47063478, position: "PG" },
        { name: "Austin Reaves", salary: 12000000, position: "SG" }
      ],
      'GSW': [
        { name: "Stephen Curry", salary: 59606817, position: "PG" },
        { name: "Jimmy Butler", salary: 54126450, position: "SF" },
        { name: "Draymond Green", salary: 25892857, position: "PF" },
        { name: "Moses Moody", salary: 11574075, position: "SG" },
        { name: "Buddy Hield", salary: 9219512, position: "SG" },
        { name: "Brandin Podziemski", salary: 3687960, position: "PG" },
        { name: "Trayce Jackson-Davis", salary: 2221677, position: "C" },
        { name: "Gui Santos", salary: 2221677, position: "SF" },
        { name: "Quinten Post", salary: 1955378, position: "C" }
      ],
      'HOU': [
        { name: "Kevin Durant", salary: 54708609, position: "SF" },
        { name: "Alperen Şengün", salary: 33944954, position: "C" },
        { name: "Fred VanVleet", salary: 25000000, position: "PG" },
        { name: "Steven Adams", salary: 14130434, position: "C" },
        { name: "Dorian Finney-Smith", salary: 12700000, position: "SF" },
        { name: "Jabari Smith Jr.", salary: 12350392, position: "PF" },
        { name: "Reed Sheppard", salary: 10603560, position: "PG" },
        { name: "Amen Thompson", salary: 9690600, position: "SG" },
        { name: "Clint Capela", salary: 6700000, position: "C" },
        { name: "Tari Eason", salary: 5675766, position: "SF" },
        { name: "Jeff Green", salary: 2296274, position: "PF" },
        { name: "Aaron Holiday", salary: 2296274, position: "PG" },
        { name: "Josh Okogie", salary: 2296274, position: "SG" },
        { name: "Jae'Sean Tate", salary: 2296274, position: "SF" }
      ],
      'IND': [
        { name: "Tyrese Haliburton", salary: 45550512, position: "PG" },
        { name: "Pascal Siakam", salary: 45550512, position: "PF" },
        { name: "Andrew Nembhard", salary: 18102000, position: "PG" },
        { name: "Obi Toppin", salary: 14000000, position: "PF" },
        { name: "Aaron Nesmith", salary: 11000000, position: "SF" },
        { name: "T.J. McConnell", salary: 10200000, position: "PG" },
        { name: "Bennedict Mathurin", salary: 9187573, position: "SG" },
        { name: "Isaiah Jackson", salary: 7600000, position: "C" },
        { name: "Jarace Walker", salary: 6665520, position: "PF" },
        { name: "Tony Bradley", salary: 2940876, position: "C" },
        { name: "Ben Sheppard", salary: 2790720, position: "SG" },
        { name: "James Wiseman", salary: 2667947, position: "C" },
        { name: "Jay Huff", salary: 2349578, position: "C" },
        { name: "Johnny Furphy", salary: 1955378, position: "SF" },
        { name: "Kam Jones", salary: 1272870, position: "PG" }
      ],
      'LAC': [
        { name: "Kawhi Leonard", salary: 50000000, position: "SF" },
        { name: "James Harden", salary: 39182693, position: "PG" },
        { name: "John Collins", salary: 26580000, position: "PF" },
        { name: "Ivica Zubac", salary: 18102000, position: "C" },
        { name: "Bogdan Bogdanović", salary: 16020000, position: "SG" },
        { name: "Derrick Jones Jr.", salary: 10000000, position: "SF" },
        { name: "Brook Lopez", salary: 8750000, position: "C" },
        { name: "Nicolas Batum", salary: 5601600, position: "SF" },
        { name: "Kris Dunn", salary: 5426400, position: "PG" },
        { name: "Bradley Beal", salary: 5354000, position: "SG" },
        { name: "Yanic Konan Niederhauser", salary: 2743800, position: "C" },
        { name: "Kobe Brown", salary: 2654880, position: "SF" },
        { name: "Chris Paul", salary: 2296274, position: "PG" },
        { name: "Cam Christie", salary: 1955378, position: "SG" }
      ],
      'LAL': [
        { name: "LeBron James", salary: 52627153, position: "SF" },
        { name: "Luka Dončić", salary: 45999660, position: "PG" },
        { name: "Rui Hachimura", salary: 18259259, position: "PF" },
        { name: "Austin Reaves", salary: 13937574, position: "SG" },
        { name: "Jarred Vanderbilt", salary: 11571429, position: "SF" },
        { name: "Gabe Vincent", salary: 11500000, position: "PG" },
        { name: "Maxi Kleber", salary: 11000000, position: "PF" },
        { name: "Deandre Ayton", salary: 8104000, position: "C" },
        { name: "Jake LaRavia", salary: 6000000, position: "SF" },
        { name: "Marcus Smart", salary: 5134000, position: "PG" },
        { name: "Dalton Knecht", salary: 4010160, position: "SG" },
        { name: "Jaxson Hayes", salary: 3449323, position: "C" },
        { name: "Bronny James", salary: 1955378, position: "PG" },
        { name: "Adou Thiero", salary: 1272870, position: "SF" }
      ],
      'MEM': [
        { name: "Ja Morant", salary: 39446090, position: "PG" },
        { name: "Jaren Jackson Jr.", salary: 35000000, position: "PF" },
        { name: "Kentavious Caldwell-Pope", salary: 21621500, position: "SG" },
        { name: "Santi Aldama", salary: 18485916, position: "PF" },
        { name: "Brandon Clarke", salary: 12500000, position: "PF" },
        { name: "Ty Jerome", salary: 8781000, position: "PG" },
        { name: "John Konchar", salary: 6165000, position: "SG" },
        { name: "Zach Edey", salary: 6045000, position: "C" },
        { name: "Cedric Coward", salary: 5715120, position: "SF" },
        { name: "Cam Spencer", salary: 2537989, position: "SG" },
        { name: "Vince Williams Jr.", salary: 2301587, position: "SF" },
        { name: "Jock Landale", salary: 2296274, position: "C" },
        { name: "Scotty Pippen Jr.", salary: 2270735, position: "PG" },
        { name: "GG Jackson", salary: 2221677, position: "SF" },
        { name: "Jaylen Wells", salary: 1955378, position: "SG" }
      ],
      'MIA': [
        { name: "Bam Adebayo", salary: 37096620, position: "C" },
        { name: "Tyler Herro", salary: 31000000, position: "SG" },
        { name: "Andrew Wiggins", salary: 28223210, position: "SF" },
        { name: "Terry Rozier", salary: 26643030, position: "PG" },
        { name: "Norman Powell", salary: 20482750, position: "SG" },
        { name: "Davion Mitchell", salary: 11600000, position: "PG" },
        { name: "Simone Fontecchio", salary: 8307690, position: "SF" },
        { name: "Haywood Highsmith", salary: 5616000, position: "SF" },
        { name: "Nikola Jović", salary: 4445410, position: "PF" },
        { name: "Kel'el Ware", salary: 4443360, position: "C" },
        { name: "Jaime Jaquez Jr.", salary: 3861600, position: "SF" },
        { name: "Kasparas Jakučionis", salary: 3658800, position: "PG" },
        { name: "Keshad Johnson", salary: 1955378, position: "SF" },
        { name: "Pelle Larsson", salary: 1955378, position: "SG" }
      ],
      'MIL': [
        { name: "Giannis Antetokounmpo", salary: 54126450, position: "PF" },
        { name: "Myles Turner", salary: 25318251, position: "C" },
        { name: "Kyle Kuzma", salary: 22410605, position: "PF" },
        { name: "Bobby Portis", salary: 13445754, position: "PF" },
        { name: "Kevin Porter Jr.", salary: 5134000, position: "PG" },
        { name: "Ryan Rollins", salary: 4000000, position: "PG" },
        { name: "Gary Trent Jr.", salary: 3697105, position: "SG" },
        { name: "Gary Harris", salary: 3634153, position: "SG" },
        { name: "Taurean Prince", salary: 3303774, position: "SF" },
        { name: "Jericho Sims", salary: 2461463, position: "C" },
        { name: "A.J. Green", salary: 2301587, position: "SG" },
        { name: "Cole Anthony", salary: 2296274, position: "PG" },
        { name: "Chris Livingston", salary: 2296274, position: "SF" },
        { name: "Andre Jackson Jr.", salary: 2221677, position: "SF" },
        { name: "Tyler Smith", salary: 1955378, position: "PF" }
      ],
      'MIN': [
        { name: "Anthony Edwards", salary: 45550512, position: "SG" },
        { name: "Rudy Gobert", salary: 35000000, position: "C" },
        { name: "Julius Randle", salary: 30864198, position: "PF" },
        { name: "Jaden McDaniels", salary: 24393103, position: "SF" },
        { name: "Naz Reid", salary: 21551724, position: "C" },
        { name: "Donte DiVincenzo", salary: 11990000, position: "SG" },
        { name: "Mike Conley Jr.", salary: 10774038, position: "PG" },
        { name: "Rob Dillingham", salary: 6576120, position: "PG" },
        { name: "Joan Beringer", salary: 4201080, position: "SF" },
        { name: "Terrence Shannon Jr.", salary: 2674080, position: "SG" },
        { name: "Joe Ingles", salary: 2296274, position: "SF" },
        { name: "Leonard Miller", salary: 2221677, position: "SF" },
        { name: "Jaylen Clark", salary: 2191897, position: "SG" }
      ],
      'NOP': [
        { name: "Zion Williamson", salary: 39446090, position: "PF" },
        { name: "Jordan Poole", salary: 31848210, position: "PG" },
        { name: "Dejounte Murray", salary: 30801130, position: "PG" },
        { name: "Trey Murphy III", salary: 25000000, position: "SF" },
        { name: "Herb Jones", salary: 13937570, position: "SF" },
        { name: "Kevon Looney", salary: 8000000, position: "C" },
        { name: "Jeremiah Fears", salary: 7520040, position: "PG" },
        { name: "Saddiq Bey", salary: 6118640, position: "SF" },
        { name: "Derik Queen", salary: 5157960, position: "C" },
        { name: "Jordan Hawkins", salary: 4741320, position: "SG" },
        { name: "Jose Alvarado", salary: 4500000, position: "PG" },
        { name: "Yves Missi", salary: 3353040, position: "C" },
        { name: "Karlo Matković", salary: 1955378, position: "C" },
        { name: "Micah Peavy", salary: 1272870, position: "SF" }
      ],
      'NYK': [
        { name: "Karl-Anthony Towns", salary: 53142264, position: "C" },
        { name: "OG Anunoby", salary: 39568960, position: "SF" },
        { name: "Jalen Brunson", salary: 34944000, position: "PG" },
        { name: "Mikal Bridges", salary: 24900000, position: "SF" },
        { name: "Josh Hart", salary: 19472240, position: "SG" },
        { name: "Mitchell Robinson", salary: 12954540, position: "C" },
        { name: "Guerschon Yabusele", salary: 5500000, position: "PF" },
        { name: "Miles McBride", salary: 4333330, position: "PG" },
        { name: "Pacôme Dadiet", salary: 2847600, position: "SF" },
        { name: "Jordan Clarkson", salary: 2296274, position: "SG" },
        { name: "Tyler Kolek", salary: 2191897, position: "PG" },
        { name: "Ariel Hukporti", salary: 1955378, position: "C" }
      ],
      'OKC': [
        { name: "Shai Gilgeous-Alexander", salary: 38333050, position: "PG" },
        { name: "Isaiah Hartenstein", salary: 28500000, position: "C" },
        { name: "Luguentz Dort", salary: 18222222, position: "SG" },
        { name: "Alex Caruso", salary: 18102000, position: "PG" },
        { name: "Chet Holmgren", salary: 13731368, position: "C" },
        { name: "Isaiah Joe", salary: 12362338, position: "SG" },
        { name: "Aaron Wiggins", salary: 9672897, position: "SG" },
        { name: "Jaylin Williams", salary: 8450000, position: "PF" },
        { name: "Kenrich Williams", salary: 7163000, position: "SF" },
        { name: "Ousmane Dieng", salary: 6670882, position: "PG" },
        { name: "Jalen Williams", salary: 6580997, position: "SF" },
        { name: "Cason Wallace", salary: 5820240, position: "PG" },
        { name: "Nikola Topić", salary: 5182920, position: "PG" },
        { name: "Thomas Sorber", salary: 4655040, position: "C" },
        { name: "Ajay Mitchell", salary: 3000000, position: "PG" }
      ],
      'ORL': [
        { name: "Franz Wagner", salary: 38661750, position: "SF" },
        { name: "Desmond Bane", salary: 36725670, position: "SG" },
        { name: "Jalen Suggs", salary: 35000000, position: "PG" },
        { name: "Paolo Banchero", salary: 15334769, position: "PF" },
        { name: "Jonathan Isaac", salary: 15000000, position: "PF" },
        { name: "Wendell Carter Jr.", salary: 10850000, position: "C" },
        { name: "Goga Bitadze", salary: 8333333, position: "C" },
        { name: "Anthony Black", salary: 7970280, position: "PG" },
        { name: "Tyus Jones", salary: 7000000, position: "PG" },
        { name: "Jett Howard", salary: 5529720, position: "SG" },
        { name: "Moe Wagner", salary: 5000000, position: "C" },
        { name: "Tristan da Silva", salary: 3809520, position: "SF" },
        { name: "Jase Richardson", salary: 2983320, position: "SG" },
        { name: "Noah Penda", salary: 1272870, position: "SF" }
      ],
      'PHX': [
        { name: "Devin Booker", salary: 53142264, position: "SG" },
        { name: "Jalen Green", salary: 33584490, position: "SG" },
        { name: "Dillon Brooks", salary: 21124110, position: "SF" },
        { name: "Grayson Allen", salary: 16875000, position: "SG" },
        { name: "Royce O'Neale", salary: 10125000, position: "SF" },
        { name: "Mark Williams", salary: 6276530, position: "C" },
        { name: "Khaman Maluach", salary: 6016080, position: "C" },
        { name: "Nick Richards", salary: 5000000, position: "C" },
        { name: "Ryan Dunn", salary: 2657760, position: "SF" },
        { name: "Jordan Goodwin", salary: 2349578, position: "PG" },
        { name: "Jared Butler", salary: 2296274, position: "PG" },
        { name: "Collin Gillespie", salary: 2296274, position: "PG" },
        { name: "Nigel Hayes-Davis", salary: 2048490, position: "SF" },
        { name: "Oso Ighodaro", salary: 1955378, position: "C" },
        { name: "Rasheer Fleming", salary: 1272870, position: "SF" }
      ],
      'POR': [
        { name: "Jrue Holiday", salary: 32400000, position: "PG" },
        { name: "Jerami Grant", salary: 32000001, position: "PF" },
        { name: "Deni Avdija", salary: 14375000, position: "SF" },
        { name: "Damian Lillard", salary: 14104000, position: "PG" },
        { name: "Robert Williams", salary: 13285713, position: "C" },
        { name: "Matisse Thybulle", salary: 11550000, position: "SG" },
        { name: "Scoot Henderson", salary: 10748040, position: "PG" },
        { name: "Shaedon Sharpe", salary: 8399983, position: "SG" },
        { name: "Donovan Clingan", salary: 7178400, position: "C" },
        { name: "Yang Hansen", salary: 4422360, position: "C" },
        { name: "Kris Murray", salary: 3132000, position: "SF" },
        { name: "Blake Wesley", salary: 2296274, position: "PG" },
        { name: "Toumani Camara", salary: 2221677, position: "SF" },
        { name: "Duop Reath", salary: 2221677, position: "C" },
        { name: "Rayan Rupert", salary: 2221677, position: "SG" }
      ],
      'SAC': [
        { name: "Zach LaVine", salary: 47499660, position: "SG" },
        { name: "Domantas Sabonis", salary: 42336000, position: "C" },
        { name: "DeMar DeRozan", salary: 24750000, position: "SF" },
        { name: "Malik Monk", salary: 18797619, position: "SG" },
        { name: "Dennis Schroder", salary: 14104000, position: "PG" },
        { name: "Keegan Murray", salary: 11144093, position: "SF" },
        { name: "Dario Šarić", salary: 5426400, position: "PF" },
        { name: "Devin Carter", salary: 4923720, position: "SG" },
        { name: "Nique Clifford", salary: 3108120, position: "SF" },
        { name: "Terence Davis", salary: 2546675, position: "SG" },
        { name: "Keon Ellis", salary: 2301587, position: "SG" },
        { name: "Drew Eubanks", salary: 2296274, position: "C" },
        { name: "Doug McDermott", salary: 2296274, position: "SF" },
        { name: "Isaac Jones", salary: 1955378, position: "PF" },
        { name: "Maxime Raynaud", salary: 1272870, position: "C" }
      ],
      'SAS': [
        { name: "De'Aaron Fox", salary: 37096620, position: "PG" },
        { name: "Devin Vassell", salary: 27000000, position: "SG" },
        { name: "Harrison Barnes", salary: 19000000, position: "SF" },
        { name: "Keldon Johnson", salary: 17500000, position: "SF" },
        { name: "Kelly Olynyk", salary: 13445122, position: "C" },
        { name: "Victor Wembanyama", salary: 13376880, position: "C" },
        { name: "Dylan Harper", salary: 12370320, position: "PG" },
        { name: "Luke Kornet", salary: 11000000, position: "C" },
        { name: "Stephon Castle", salary: 9560520, position: "PG" },
        { name: "Jeremy Sochan", salary: 7096231, position: "PF" },
        { name: "Carter Bryant", salary: 4900320, position: "SG" },
        { name: "Julian Champagnie", salary: 3000000, position: "SF" },
        { name: "Jordan McLaughlin", salary: 2296274, position: "PG" },
        { name: "Lindy Waters III", salary: 2296274, position: "SG" }
      ],
      'TOR': [
        { name: "Scottie Barnes", salary: 38661750, position: "PF" },
        { name: "Brandon Ingram", salary: 38095238, position: "SF" },
        { name: "Immanuel Quickley", salary: 32500000, position: "PG" },
        { name: "R.J. Barrett", salary: 27705357, position: "SG" },
        { name: "Jakob Poeltl", salary: 19500000, position: "C" },
        { name: "Ochai Agbaji", salary: 6383525, position: "SG" },
        { name: "Collin Murray-Boyles", salary: 6332520, position: "PF" },
        { name: "Gradey Dick", salary: 4990560, position: "SG" },
        { name: "Ja'Kobe Walter", salary: 3638160, position: "SG" },
        { name: "Sandro Mamukelashvili", salary: 2461463, position: "PF" },
        { name: "Garrett Temple", salary: 2296274, position: "SG" },
        { name: "A.J. Lawson", salary: 2270735, position: "SF" },
        { name: "Colin Castleton", salary: 2191897, position: "C" },
        { name: "Jamison Battle", salary: 1955378, position: "SF" },
        { name: "Jonathan Mogbo", salary: 1955378, position: "PF" },
        { name: "Jamal Shead", salary: 1955378, position: "PG" }
      ],
      'UTA': [
        { name: "Lauri Markkanen", salary: 46394100, position: "PF" },
        { name: "Jusuf Nurkić", salary: 19375000, position: "C" },
        { name: "Kyle Anderson", salary: 9219512, position: "SF" },
        { name: "Ace Bailey", salary: 9069840, position: "SF" },
        { name: "KJ Martin", salary: 8025000, position: "PF" },
        { name: "Taylor Hendricks", salary: 6127080, position: "PF" },
        { name: "Cody Williams", salary: 5742480, position: "SF" },
        { name: "Walker Kessler", salary: 4878938, position: "C" },
        { name: "Keyonte George", salary: 4278960, position: "PG" },
        { name: "Kevin Love", salary: 4150000, position: "PF" },
        { name: "Svi Mykhailiuk", salary: 3675000, position: "SG" },
        { name: "Walter Clayton Jr.", salary: 3991320, position: "PG" },
        { name: "Kyle Filipowski", salary: 3000000, position: "C" },
        { name: "Brice Sensabaugh", salary: 2693760, position: "SG" },
        { name: "Isaiah Collier", salary: 2638200, position: "PG" }
      ],
      'WAS': [
        { name: "Khris Middleton", salary: 33296296, position: "SF" },
        { name: "C.J. McCollum", salary: 30666667, position: "SG" },
        { name: "Corey Kispert", salary: 13975000, position: "SF" },
        { name: "Alex Sarr", salary: 11808240, position: "PF" },
        { name: "Tre Johnson", salary: 8237640, position: "SG" },
        { name: "Bilal Coulibaly", salary: 7275600, position: "SF" },
        { name: "Malaki Branham", salary: 4962033, position: "SG" },
        { name: "Bub Carrington", salary: 4677600, position: "PG" },
        { name: "Cam Whitmore", salary: 3539760, position: "SF" },
        { name: "Will Riley", salary: 3512520, position: "SG" },
        { name: "AJ Johnson", salary: 3090480, position: "PG" },
        { name: "Kyshawn George", salary: 2966760, position: "SF" },
        { name: "Dillon Jones", salary: 2753280, position: "SF" },
        { name: "Justin Champagnie", salary: 2349578, position: "PF" },
        { name: "Marvin Bagley", salary: 2296274, position: "PF" }
      ]
    };

    let teams = [];
    let tradeId = 0;



    function calculateLuxuryTax(teamSalary, luxuryTaxThreshold) {
      if (teamSalary <= luxuryTaxThreshold) {
        return 0;
      }
      
      const overage = teamSalary - luxuryTaxThreshold;
      let tax = 0;
      
      // Progressive luxury tax brackets (2024-25 season)
      // $0-$5M over: $1.50 per dollar
      // $5M-$10M over: $1.75 per dollar  
      // $10M-$15M over: $2.50 per dollar
      // $15M-$20M over: $3.25 per dollar
      // $20M+ over: $3.75 per dollar (continuing the progression)
      
      if (overage <= 5000000) {
        tax = overage * 1.50;
      } else if (overage <= 10000000) {
        tax = (5000000 * 1.50) + ((overage - 5000000) * 1.75);
      } else if (overage <= 15000000) {
        tax = (5000000 * 1.50) + (5000000 * 1.75) + ((overage - 10000000) * 2.50);
      } else if (overage <= 20000000) {
        tax = (5000000 * 1.50) + (5000000 * 1.75) + (5000000 * 2.50) + ((overage - 15000000) * 3.25);
      } else {
        tax = (5000000 * 1.50) + (5000000 * 1.75) + (5000000 * 2.50) + (5000000 * 3.25) + ((overage - 20000000) * 3.75);
      }
      
      return Math.round(tax);
    }



    function removeTeam(teamId) {
      document.getElementById(teamId).remove();
    }

    function clearAllTrades() {
      const container = document.getElementById('tradeContainer');
      container.innerHTML = '';
      teamCounter = 0;
      addTeam();
    }

    function randomTrade() {
      clearAllTrades();
      
      // Add two random teams
      addTeam();
      addTeam();
      
      const teamCodes = Object.keys(nbaTeams);
      const team1Code = teamCodes[Math.floor(Math.random() * teamCodes.length)];
      let team2Code = teamCodes[Math.floor(Math.random() * teamCodes.length)];
      while (team2Code === team1Code) {
        team2Code = teamCodes[Math.floor(Math.random() * teamCodes.length)];
      }
      
      // Load teams using the new system
      setTimeout(() => {
        const selects = document.querySelectorAll('.team-block select');
        if (selects[0]) {
          selects[0].value = team1Code;
          loadTeamRoster(selects[0], 'team-1');
        }
        if (selects[1]) {
          selects[1].value = team2Code;
          loadTeamRoster(selects[1], 'team-2');
        }
      }, 100);
    }

    function analyzeTrade() {
      const teams = document.querySelectorAll('.team-block');
      if (teams.length < 2) {
        showTradeModal(false, 'Insufficient Teams', 'Please add at least 2 teams to analyze a trade.', '', '');
        return;
      }
      

      
      let analysis = '';
      let apronAnalysis = '';
      let totalSalaryOut = 0;
      let totalSalaryIn = 0;
      let isValid = true;
      let reasons = [];
      let teamAnalysis = [];
      
      teams.forEach((team, index) => {
        const teamId = team.id;
        const selectedPlayers = team.querySelectorAll('input[type="checkbox"]:checked');
        const teamSelect = team.querySelector('select');
        const teamName = teamSelect.options[teamSelect.selectedIndex]?.text || 'Unknown Team';
        const teamCode = teamSelect.value;
        
        if (selectedPlayers.length === 0) {
          reasons.push(`${teamName} has no players selected`);
          isValid = false;
          return;
        }
        
        // Calculate current team salary
        const allPlayers = playersData[teamCode] || [];
        let currentTeamSalary = allPlayers.reduce((sum, player) => sum + player.salary, 0);
        
        let tradedSalary = 0;
        let playerNames = [];
        selectedPlayers.forEach(player => {
          const playerName = player.closest('li').querySelector('label').textContent;
          const salaryText = player.closest('li').querySelector('.salary-cell').textContent;
          const salary = parseInt(salaryText.replace(/[$,]/g, ''));
          tradedSalary += salary;
          playerNames.push(`${playerName} (${salaryText})`);
        });
        
        if (index === 0) {
          totalSalaryOut = tradedSalary;
        } else {
          totalSalaryIn += tradedSalary;
        }
        
        teamAnalysis.push({
          name: teamName,
          code: teamCode,
          players: playerNames,
          tradedSalary: tradedSalary,
          currentSalary: currentTeamSalary,
          postTradeSalary: 0, // Will calculate after we have all totals
          count: selectedPlayers.length,
          isReceiving: index > 0
        });
      });
      
      // Calculate post-trade salaries now that we have all totals
      teamAnalysis.forEach((team, index) => {
        if (index === 0) {
          // First team gives out totalSalaryOut and receives totalSalaryIn
          team.postTradeSalary = team.currentSalary - team.tradedSalary + totalSalaryIn;
        } else {
          // Other teams give out their tradedSalary and receive totalSalaryOut
          team.postTradeSalary = team.currentSalary - team.tradedSalary + totalSalaryOut;
        }
      });
      
      // NBA salary matching rules
      const salaryDifference = Math.abs(totalSalaryIn - totalSalaryOut);
      let allowedDifference;
      let matchingRule = '';
      
      if (totalSalaryOut <= 6500000) {
        allowedDifference = 175000;
        matchingRule = 'Small salary rule: Can take back up to $175K more';
      } else if (totalSalaryOut <= 19600000) {
        allowedDifference = totalSalaryOut * 0.75;
        matchingRule = 'Medium salary rule: Can take back up to 175% of outgoing salary';
      } else {
        allowedDifference = totalSalaryOut * 0.25 + 100000;
        matchingRule = 'Large salary rule: Can take back up to 125% + $100K of outgoing salary';
      }
      
      // Check for apron restrictions
      let apronViolations = [];
      teamAnalysis.forEach(team => {
        if (team.postTradeSalary > SECOND_APRON) {
          // Second apron restrictions
          if (team.isReceiving && totalSalaryIn > totalSalaryOut) {
            apronViolations.push(`${team.name} cannot take back more salary while over second apron`);
          }
          if (teamAnalysis.length > 2) {
            apronViolations.push(`${team.name} cannot aggregate salaries while over second apron`);
          }
        } else if (team.postTradeSalary > FIRST_APRON) {
          // First apron restrictions
          if (team.isReceiving && (totalSalaryIn / totalSalaryOut) > 1.10) {
            apronViolations.push(`${team.name} salary matching limited to 110% while over first apron`);
          }
        }
      });
      
      if (salaryDifference > allowedDifference) {
        isValid = false;
        reasons.push(`Salary matching violation: $${salaryDifference.toLocaleString()} difference exceeds allowed $${allowedDifference.toLocaleString()}`);
      }
      
      if (apronViolations.length > 0) {
        isValid = false;
        reasons.push(...apronViolations);
      }
      
      // Build apron tracking analysis
      apronAnalysis = generateApronAnalysis(teamAnalysis, SALARY_CAP, LUXURY_TAX, FIRST_APRON, SECOND_APRON);
      
      // Build detailed analysis
      analysis += '<h3>Trade Breakdown</h3>';
      teamAnalysis.forEach(team => {
        analysis += `<div style="margin-bottom: 1.5rem; padding: 1rem; background: rgba(15, 23, 42, 0.4); border-radius: 8px;">`;
        analysis += `<h4 style="color: #3b82f6; margin-bottom: 0.5rem;">${team.name}</h4>`;
        analysis += `<p><strong>Players Traded (${team.count}):</strong></p>`;
        analysis += `<ul style="margin: 0.5rem 0; padding-left: 1rem;">`;
        team.players.forEach(player => {
          analysis += `<li style="margin: 0.25rem 0;">${player}</li>`;
        });
        analysis += `</ul>`;
        analysis += `<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">`;
        analysis += `<div><strong>Traded Salary:</strong> $${team.tradedSalary.toLocaleString()}</div>`;
        analysis += `<div><strong>Post-Trade Total:</strong> $${team.postTradeSalary.toLocaleString()}</div>`;
        analysis += `</div>`;
        analysis += `</div>`;
      });
      
      analysis += '<h3>Salary Cap Analysis</h3>';
      const netChange = totalSalaryIn - totalSalaryOut;
      analysis += `<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 1rem 0;">`;
      analysis += `<div><strong>Salary Difference:</strong> $${salaryDifference.toLocaleString()}</div>`;
      analysis += `<div><strong>Max Allowed:</strong> $${allowedDifference.toLocaleString()}</div>`;
      analysis += `<div><strong>Net Change:</strong> <span class="${netChange > 0 ? 'failure-text' : 'success-text'}">${netChange > 0 ? '+' : ''}$${netChange.toLocaleString()}</span></div>`;
      analysis += `<div><strong>Matching Rule:</strong> ${matchingRule}</div>`;
      analysis += `</div>`;
      
      if (!isValid && reasons.length > 0) {
        analysis += '<h3 style="color: #ef4444;">Trade Violations</h3>';
        analysis += '<ul style="background: rgba(239, 68, 68, 0.1); padding: 1rem; border-radius: 8px; border-left: 4px solid #ef4444;">';
        reasons.forEach(reason => {
          analysis += `<li class="failure-text" style="margin: 0.5rem 0;">${reason}</li>`;
        });
        analysis += '</ul>';
      }
      
      // Show modal with results
      const statusMessage = isValid ? 'Trade Approved' : 'Trade Rejected';
      const detailMessage = isValid ? 
        'This trade complies with NBA salary cap and apron regulations.' : 
        'This trade violates NBA CBA rules and cannot be executed.';
      
      showTradeModal(isValid, statusMessage, detailMessage, analysis, apronAnalysis);
    }

    function generateApronAnalysis(teamAnalysis, SALARY_CAP, LUXURY_TAX, FIRST_APRON, SECOND_APRON) {
      let html = '<div class="apron-title">📊 Salary Cap & Apron Impact Analysis</div>';
      html += '<div class="apron-grid">';
      
      teamAnalysis.forEach(team => {
        const currentStatus = getApronStatus(team.currentSalary, SALARY_CAP, LUXURY_TAX, FIRST_APRON, SECOND_APRON);
        const postStatus = getApronStatus(team.postTradeSalary, SALARY_CAP, LUXURY_TAX, FIRST_APRON, SECOND_APRON);
        
        html += `<div class="apron-card">`;
        html += `<h4>${team.name}</h4>`;
        
        // Current status
        html += `<div class="apron-metric">`;
        html += `<span class="apron-label">Current Payroll:</span>`;
        html += `<span class="apron-value ${currentStatus.class}">$${team.currentSalary.toLocaleString()}</span>`;
        html += `</div>`;
        
        html += `<div class="apron-bar">`;
        html += `<div class="apron-fill ${currentStatus.class}" style="width: ${Math.min(100, (team.currentSalary / SECOND_APRON) * 100)}%"></div>`;
        html += `</div>`;
        
        html += `<div class="apron-metric">`;
        html += `<span class="apron-label">Current Status:</span>`;
        html += `<span class="apron-value ${currentStatus.class}">${currentStatus.label}</span>`;
        html += `</div>`;
        
        // Post-trade status
        html += `<div class="apron-metric" style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid rgba(59, 130, 246, 0.2);">`;
        html += `<span class="apron-label">Post-Trade Payroll:</span>`;
        html += `<span class="apron-value ${postStatus.class}">$${team.postTradeSalary.toLocaleString()}</span>`;
        html += `</div>`;
        
        html += `<div class="apron-bar">`;
        html += `<div class="apron-fill ${postStatus.class}" style="width: ${Math.min(100, (team.postTradeSalary / SECOND_APRON) * 100)}%"></div>`;
        html += `</div>`;
        
        html += `<div class="apron-metric">`;
        html += `<span class="apron-label">Post-Trade Status:</span>`;
        html += `<span class="apron-value ${postStatus.class}">${postStatus.label}</span>`;
        html += `</div>`;
        
        // Distance to thresholds
        const distances = calculateDistances(team.postTradeSalary, SALARY_CAP, LUXURY_TAX, FIRST_APRON, SECOND_APRON);
        html += `<div style="margin-top: 1rem; font-size: 0.9rem;">`;
        distances.forEach(distance => {
          html += `<div class="apron-metric">`;
          html += `<span class="apron-label">${distance.label}:</span>`;
          html += `<span class="apron-value ${distance.class}">${distance.value}</span>`;
          html += `</div>`;
        });
        html += `</div>`;
        
        // Restrictions
        if (team.postTradeSalary > FIRST_APRON) {
          const restrictions = getApronRestrictions(team.postTradeSalary, FIRST_APRON, SECOND_APRON);
          html += `<div class="restriction-list">`;
          html += `<h5>Active Restrictions</h5>`;
          html += `<ul>`;
          restrictions.forEach(restriction => {
            html += `<li>${restriction}</li>`;
          });
          html += `</ul>`;
          html += `</div>`;
        }
        
        html += `</div>`;
      });
      
      html += '</div>';
      return html;
    }

    function getApronStatus(salary, SALARY_CAP, LUXURY_TAX, FIRST_APRON, SECOND_APRON) {
      if (salary > SECOND_APRON) {
        return { label: 'Second Apron', class: 'danger' };
      } else if (salary > FIRST_APRON) {
        return { label: 'First Apron', class: 'warning' };
      } else if (salary > LUXURY_TAX) {
        return { label: 'Luxury Tax', class: 'warning' };
      } else if (salary > SALARY_CAP) {
        return { label: 'Over Cap', class: 'safe' };
      } else {
        return { label: 'Under Cap', class: 'safe' };
      }
    }

    function calculateDistances(salary, SALARY_CAP, LUXURY_TAX, FIRST_APRON, SECOND_APRON) {
      const distances = [];
      
      if (salary < SALARY_CAP) {
        distances.push({
          label: 'Cap Space',
          value: `$${(SALARY_CAP - salary).toLocaleString()}`,
          class: 'safe'
        });
      }
      
      if (salary < LUXURY_TAX) {
        distances.push({
          label: 'To Luxury Tax',
          value: `$${(LUXURY_TAX - salary).toLocaleString()}`,
          class: 'safe'
        });
      } else {
        distances.push({
          label: 'Luxury Tax Bill',
          value: `$${calculateLuxuryTax(salary, LUXURY_TAX).toLocaleString()}`,
          class: 'warning'
        });
      }
      
      if (salary < FIRST_APRON) {
        distances.push({
          label: 'To First Apron',
          value: `$${(FIRST_APRON - salary).toLocaleString()}`,
          class: 'safe'
        });
      } else {
        distances.push({
          label: 'Over First Apron',
          value: `$${(salary - FIRST_APRON).toLocaleString()}`,
          class: 'warning'
        });
      }
      
      if (salary < SECOND_APRON) {
        distances.push({
          label: 'To Second Apron',
          value: `$${(SECOND_APRON - salary).toLocaleString()}`,
          class: salary > FIRST_APRON ? 'warning' : 'safe'
        });
      } else {
        distances.push({
          label: 'Over Second Apron',
          value: `$${(salary - SECOND_APRON).toLocaleString()}`,
          class: 'danger'
        });
      }
      
      return distances;
    }

    function getApronRestrictions(salary, FIRST_APRON, SECOND_APRON) {
      const restrictions = [];
      
      if (salary > FIRST_APRON) {
        restrictions.push('No sign-and-trade acquisitions');
        restrictions.push('Salary matching limited to 110%');
        restrictions.push('Cannot sign waived players over MLE');
      }
      
      if (salary > SECOND_APRON) {
        restrictions.push('No mid-level exception');
        restrictions.push('Cannot aggregate salaries in trades');
        restrictions.push('No cash in trades');
        restrictions.push('Cannot use prior trade exceptions');
        restrictions.push('Draft pick restrictions apply');
      }
      
      return restrictions;
    }

    function showTradeModal(isSuccess, title, message, details, apronAnalysis) {
      const modal = document.getElementById('tradeModal');
      const status = document.getElementById('tradeStatus');
      const messageEl = document.getElementById('tradeMessage');
      const subtitleEl = document.getElementById('tradeSubtitle');
      const detailsEl = document.getElementById('tradeDetails');
      const apronEl = document.getElementById('apronTracking');
      
      // Ensure modal exists
      if (!modal || !status || !messageEl || !subtitleEl || !detailsEl || !apronEl) {
        console.error('Modal elements not found');
        return;
      }
      
      // Reset modal state first
      resetModalState();
      
      // Enhanced status display with better emojis and animations
      if (isSuccess) {
        status.textContent = '🎉';
        status.className = 'trade-status success';
        messageEl.className = 'trade-message success';
        
        // Add confetti effect for successful trades
        setTimeout(() => {
          createConfettiEffect();
        }, 500);
      } else {
        status.textContent = '⚠️';
        status.className = 'trade-status failure';
        messageEl.className = 'trade-message failure';
      }
      
      messageEl.textContent = title;
      subtitleEl.textContent = message;
      
      // Enhanced details with loading animation
      detailsEl.innerHTML = '<div class="modal-loading"><div class="loading-spinner"></div></div>';
      apronEl.innerHTML = '';
      
      // Show modal with proper display
      modal.style.display = 'flex';
      modal.classList.add('show');
      document.body.style.overflow = 'hidden';
      
      // Add content with staggered animation
      setTimeout(() => {
        try {
          detailsEl.innerHTML = details;
          apronEl.innerHTML = apronAnalysis || '';
          
          // Update quick stats
          updateQuickStats();
          
          // Generate executive summary
          generateExecutiveSummary(isSuccess, title, message);
          
          // Animate content sections
          animateModalContent();
        } catch (error) {
          console.error('Error updating modal content:', error);
          detailsEl.innerHTML = '<p>Error loading trade details. Please try again.</p>';
        }
      }, 800);
      
      // Add sound effect (optional)
      playTradeResultSound(isSuccess);
    }

    function createConfettiEffect() {
      // Create confetti particles for successful trades
      const colors = ['#10b981', '#3b82f6', '#06b6d4', '#8b5cf6', '#f59e0b'];
      const confettiContainer = document.createElement('div');
      confettiContainer.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 10001;
      `;
      document.body.appendChild(confettiContainer);
      
      for (let i = 0; i < 50; i++) {
        const confetti = document.createElement('div');
        confetti.style.cssText = `
          position: absolute;
          width: 10px;
          height: 10px;
          background: ${colors[Math.floor(Math.random() * colors.length)]};
          top: -10px;
          left: ${Math.random() * 100}%;
          animation: confettiFall ${2 + Math.random() * 3}s linear forwards;
          border-radius: ${Math.random() > 0.5 ? '50%' : '0'};
        `;
        confettiContainer.appendChild(confetti);
      }
      
      // Add confetti animation
      const style = document.createElement('style');
      style.textContent = `
        @keyframes confettiFall {
          0% {
            transform: translateY(-10px) rotate(0deg);
            opacity: 1;
          }
          100% {
            transform: translateY(100vh) rotate(720deg);
            opacity: 0;
          }
        }
      `;
      document.head.appendChild(style);
      
      // Clean up after animation
      setTimeout(() => {
        document.body.removeChild(confettiContainer);
        document.head.removeChild(style);
      }, 5000);
    }

    function animateModalContent() {
      const sections = document.querySelectorAll('#tradeDetails > *, #apronTracking > *');
      sections.forEach((section, index) => {
        section.style.opacity = '0';
        section.style.transform = 'translateY(20px)';
        section.style.transition = 'all 0.5s ease';
        
        setTimeout(() => {
          section.style.opacity = '1';
          section.style.transform = 'translateY(0)';
        }, index * 150);
      });
    }

    function playTradeResultSound(isSuccess) {
      // Create audio context for sound effects (optional)
      try {
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        
        if (isSuccess) {
          // Success sound - ascending notes
          oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime); // C5
          oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1); // E5
          oscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.2); // G5
        } else {
          // Failure sound - descending notes
          oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime); // C5
          oscillator.frequency.setValueAtTime(466.16, audioContext.currentTime + 0.1); // Bb4
          oscillator.frequency.setValueAtTime(415.30, audioContext.currentTime + 0.2); // Ab4
        }
        
        gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
        
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.3);
      } catch (e) {
        // Sound not supported, continue silently
      }
    }

    function closeTradeModal() {
      const modal = document.getElementById('tradeModal');
      if (modal) {
        modal.classList.remove('show');
        modal.style.display = 'none';
        document.body.style.overflow = 'auto';
        
        // Reset modal state
        resetModalState();
      }
    }

    function resetModalState() {
      // Reset to first tab
      document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
      document.querySelectorAll('.tab-panel').forEach(panel => panel.classList.remove('active'));
      
      const firstTab = document.querySelector('[data-tab="details"]');
      const firstPanel = document.getElementById('tab-details');
      
      if (firstTab && firstPanel) {
        firstTab.classList.add('active');
        firstPanel.classList.add('active');
      }
      
      // Clear any temporary styles or states
      const quickStats = document.querySelectorAll('.quick-stat-value');
      quickStats.forEach(stat => stat.textContent = '-');
    }

    // Tab switching functionality
    function switchTab(tabName) {
      try {
        // Remove active class from all tabs and panels
        document.querySelectorAll('.tab-button').forEach(btn => {
          if (btn) btn.classList.remove('active');
        });
        document.querySelectorAll('.tab-panel').forEach(panel => {
          if (panel) panel.classList.remove('active');
        });
        
        // Add active class to selected tab and panel
        const selectedTab = document.querySelector(`[data-tab="${tabName}"]`);
        const selectedPanel = document.getElementById(`tab-${tabName}`);
        
        if (selectedTab && selectedPanel) {
          selectedTab.classList.add('active');
          selectedPanel.classList.add('active');
        }
      } catch (error) {
        console.error('Error switching tabs:', error);
      }
    }

    // Update quick stats in modal
    function updateQuickStats() {
      try {
        const teams = document.querySelectorAll('.team-block');
        let totalPlayers = 0;
        let totalSalary = 0;
        
        teams.forEach(team => {
          const selectedPlayers = team.querySelectorAll('input[type="checkbox"]:checked');
          totalPlayers += selectedPlayers.length;
          
          selectedPlayers.forEach(player => {
            try {
              const salaryCell = player.closest('li')?.querySelector('.salary-cell');
              if (salaryCell) {
                const salaryText = salaryCell.textContent || '0';
                const salary = parseInt(salaryText.replace(/[$,]/g, '')) || 0;
                totalSalary += salary;
              }
            } catch (e) {
              console.warn('Error parsing salary for player:', e);
            }
          });
        });
        
        // Update quick stats display safely
        const teamsStatEl = document.getElementById('quickStatTeams')?.querySelector('.quick-stat-value');
        const playersStatEl = document.getElementById('quickStatPlayers')?.querySelector('.quick-stat-value');
        const salaryStatEl = document.getElementById('quickStatSalary')?.querySelector('.quick-stat-value');
        
        if (teamsStatEl) teamsStatEl.textContent = teams.length;
        if (playersStatEl) playersStatEl.textContent = totalPlayers;
        if (salaryStatEl) {
          salaryStatEl.textContent = '$' + (totalSalary / 1000000).toFixed(1) + 'M';
        }
      } catch (error) {
        console.error('Error updating quick stats:', error);
      }
    }

    // Generate executive summary
    function generateExecutiveSummary(isSuccess, title, message) {
      const summaryEl = document.getElementById('tradeSummary');
      const teams = document.querySelectorAll('.team-block');
      
      let summary = `
        <div class="summary-section">
          <h4>🎯 Trade Overview</h4>
          <p><strong>Status:</strong> <span class="${isSuccess ? 'success-text' : 'failure-text'}">${title}</span></p>
          <p><strong>Analysis:</strong> ${message}</p>
          <div class="summary-highlight ${isSuccess ? '' : 'warning'}">
            <strong>${isSuccess ? '✅ Trade Approved' : '❌ Trade Rejected'}</strong><br>
            ${isSuccess ? 
              'This trade meets all NBA salary cap requirements and can be executed.' : 
              'This trade violates NBA CBA rules and cannot be completed as structured.'
            }
          </div>
        </div>
      `;

      // Add team breakdown
      summary += `
        <div class="summary-section">
          <h4>🏀 Team Breakdown</h4>
      `;
      
      teams.forEach((team, index) => {
        const teamSelect = team.querySelector('select');
        const teamName = teamSelect.options[teamSelect.selectedIndex]?.text || 'Unknown Team';
        const selectedPlayers = team.querySelectorAll('input[type="checkbox"]:checked');
        
        if (selectedPlayers.length > 0) {
          let teamSalary = 0;
          selectedPlayers.forEach(player => {
            const salaryText = player.closest('li').querySelector('.salary-cell').textContent;
            const salary = parseInt(salaryText.replace(/[$,]/g, ''));
            teamSalary += salary;
          });
          
          summary += `
            <p><strong>${teamName}:</strong> Trading ${selectedPlayers.length} player${selectedPlayers.length > 1 ? 's' : ''} 
            worth $${(teamSalary / 1000000).toFixed(1)}M in salary</p>
          `;
        }
      });
      
      summary += `</div>`;

      // Add recommendations
      summary += `
        <div class="summary-section">
          <h4>💡 Recommendations</h4>
          ${isSuccess ? `
            <div class="summary-highlight">
              <strong>Next Steps:</strong><br>
              • Review luxury tax implications<br>
              • Consider roster fit and chemistry<br>
              • Evaluate long-term salary cap flexibility<br>
              • Assess draft pick compensation needs
            </div>
          ` : `
            <div class="summary-highlight warning">
              <strong>To Make This Trade Work:</strong><br>
              • Adjust salary matching to meet NBA requirements<br>
              • Consider adding/removing players<br>
              • Review apron restrictions<br>
              • Explore alternative trade structures
            </div>
          `}
        </div>
      `;

      summaryEl.innerHTML = summary;
    }

    // Close modal when clicking outside
    document.addEventListener('click', function(e) {
      const modal = document.getElementById('tradeModal');
      if (e.target === modal) {
        closeTradeModal();
      }
    });

    // Close modal with Escape key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        closeTradeModal();
      }
    });

    // Debounce utility to prevent rapid clicks
    function debounce(func, wait) {
      let timeout;
      return function executedFunction(...args) {
        const later = () => {
          clearTimeout(timeout);
          func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
      };
    }

    // Initialize modal button event listeners
    document.addEventListener('DOMContentLoaded', function() {
      // Re-analyze button with debounce
      const reAnalyzeBtn = document.getElementById('reAnalyzeBtn');
      if (reAnalyzeBtn) {
        const debouncedReAnalyze = debounce(function() {
          closeTradeModal();
          setTimeout(() => {
            analyzeTrade();
          }, 300);
        }, 500);

        reAnalyzeBtn.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          this.disabled = true;
          debouncedReAnalyze();
          setTimeout(() => {
            this.disabled = false;
          }, 1000);
        });
      }

      // New trade button with debounce
      const newTradeBtn = document.getElementById('newTradeBtn');
      if (newTradeBtn) {
        const debouncedNewTrade = debounce(function() {
          closeTradeModal();
          setTimeout(() => {
            clearAllTrades();
          }, 300);
        }, 500);

        newTradeBtn.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          this.disabled = true;
          debouncedNewTrade();
          setTimeout(() => {
            this.disabled = false;
          }, 1000);
        });
      }
    });



    let teamCounter = 0;

    function addTeam() {
      teamCounter++;
      const container = document.getElementById('tradeContainer');
      
      const teamDiv = document.createElement('div');
      teamDiv.className = 'team-block';
      teamDiv.id = `team-${teamCounter}`;
      
      teamDiv.innerHTML = `
        <div class="team-header">
          <select onchange="loadTeamRoster(this, '${teamDiv.id}')">
            <option value="">Select Team</option>
            ${Object.entries(nbaTeams).map(([code, team]) => 
              `<option value="${code}">${team.name}</option>`
            ).join('')}
          </select>
          <button class="remove-team-btn" onclick="removeTeam('${teamDiv.id}')">×</button>
        </div>
        <ul class="players-list" id="players-${teamCounter}">
          <li style="text-align: center; color: #94a3b8; padding: 2rem;">Select a team to view roster</li>
        </ul>
        <div class="salary-tracking" id="salary-tracking-${teamCounter}" style="display: none;">
          <div class="salary-tracking-title">
            💰 Salary Cap Status
          </div>
          <div class="salary-metrics" id="salary-metrics-${teamCounter}">
            <!-- Salary metrics will be populated here -->
          </div>
        </div>
      `;
      
      container.appendChild(teamDiv);
    }

    function removeTeam(teamId) {
      const teamElement = document.getElementById(teamId);
      if (teamElement) {
        teamElement.remove();
      }
    }

    function loadTeamRoster(selectElement, teamId) {
      const teamCode = selectElement.value;
      const teamNumber = teamId.split('-')[1];
      const playersList = document.getElementById(`players-${teamNumber}`);
      const salaryTracking = document.getElementById(`salary-tracking-${teamNumber}`);
      
      if (!teamCode) {
        playersList.innerHTML = '<li style="text-align: center; color: #94a3b8; padding: 2rem;">Select a team to view roster</li>';
        salaryTracking.style.display = 'none';
        return;
      }

      // Show loading state
      playersList.innerHTML = `
        <li style="text-align: center; color: #3b82f6; padding: 2rem;">
          <div style="display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
            <div class="loading-spinner"></div>
            Loading ${nbaTeams[teamCode].name} roster...
          </div>
        </li>
      `;
      
      // Simulate loading delay for better UX
      setTimeout(() => {
        const players = playersData[teamCode] || [];
        
        if (players.length === 0) {
          playersList.innerHTML = '<li style="text-align: center; color: #94a3b8; padding: 2rem;">No roster data available</li>';
          salaryTracking.style.display = 'none';
          return;
        }
        
        // Calculate total team salary
        const totalSalary = players.reduce((sum, player) => sum + player.salary, 0);
        
        // Generate player list with enhanced interactivity
        playersList.innerHTML = players.map((player, index) => `
          <li style="animation: slideInUp 0.3s ease ${index * 0.05}s both;">
            <input type="checkbox" id="${teamCode}-${player.name.replace(/\s+/g, '-')}" 
                   onchange="updateSalaryTracking('${teamNumber}', '${teamCode}'); togglePlayerSelection(this)">
            <div class="player-avatar">${player.name.split(' ').map(n => n[0]).join('')}</div>
            <label for="${teamCode}-${player.name.replace(/\s+/g, '-')}">${player.name}</label>
            <span class="salary-cell">$${player.salary.toLocaleString()}</span>
          </li>
        `).join('');
        
        // Show and update salary tracking with animation
        salaryTracking.style.display = 'block';
        salaryTracking.style.animation = 'fadeInUp 0.5s ease';
        updateSalaryTracking(teamNumber, teamCode);
      }, 300);
    }

    function togglePlayerSelection(checkbox) {
      const listItem = checkbox.closest('li');
      if (checkbox.checked) {
        listItem.classList.add('selected');
      } else {
        listItem.classList.remove('selected');
      }
    }

    function updateSalaryTracking(teamNumber, teamCode) {
      const players = playersData[teamCode] || [];
      const totalSalary = players.reduce((sum, player) => sum + player.salary, 0);
      const metricsContainer = document.getElementById(`salary-metrics-${teamNumber}`);
      
      // Calculate distances to thresholds
      const capSpace = totalSalary < SALARY_CAP ? SALARY_CAP - totalSalary : 0;
      const luxuryTaxDistance = totalSalary < LUXURY_TAX ? LUXURY_TAX - totalSalary : 0;
      const firstApronDistance = totalSalary < FIRST_APRON ? FIRST_APRON - totalSalary : 0;
      const secondApronDistance = totalSalary < SECOND_APRON ? SECOND_APRON - totalSalary : 0;
      
      // Determine status classes
      const getStatusClass = (salary, threshold) => {
        if (salary < threshold) return 'safe';
        if (salary < threshold * 1.1) return 'warning';
        return 'danger';
      };
      
      const capClass = getStatusClass(totalSalary, SALARY_CAP);
      const luxuryClass = getStatusClass(totalSalary, LUXURY_TAX);
      const firstApronClass = getStatusClass(totalSalary, FIRST_APRON);
      const secondApronClass = getStatusClass(totalSalary, SECOND_APRON);
      
      metricsContainer.innerHTML = `
        <div class="salary-metric">
          <div class="salary-metric-label">Total Payroll</div>
          <div class="salary-metric-value">$${totalSalary.toLocaleString()}</div>
          <div class="salary-progress">
            <div class="salary-progress-fill ${secondApronClass}" 
                 style="width: ${Math.min(100, (totalSalary / SECOND_APRON) * 100)}%"></div>
          </div>
        </div>
        
        <div class="salary-metric">
          <div class="salary-metric-label">Cap Space</div>
          <div class="salary-metric-value ${capClass}">
            ${capSpace > 0 ? `$${capSpace.toLocaleString()}` : 'Over Cap'}
          </div>
        </div>
        
        <div class="salary-metric">
          <div class="salary-metric-label">To Luxury Tax</div>
          <div class="salary-metric-value ${luxuryClass}">
            ${luxuryTaxDistance > 0 ? `$${luxuryTaxDistance.toLocaleString()}` : `Over by $${(totalSalary - LUXURY_TAX).toLocaleString()}`}
          </div>
        </div>
        
        <div class="salary-metric">
          <div class="salary-metric-label">To First Apron</div>
          <div class="salary-metric-value ${firstApronClass}">
            ${firstApronDistance > 0 ? `$${firstApronDistance.toLocaleString()}` : `Over by $${(totalSalary - FIRST_APRON).toLocaleString()}`}
          </div>
        </div>
        
        <div class="salary-metric">
          <div class="salary-metric-label">To Second Apron</div>
          <div class="salary-metric-value ${secondApronClass}">
            ${secondApronDistance > 0 ? `$${secondApronDistance.toLocaleString()}` : `Over by $${(totalSalary - SECOND_APRON).toLocaleString()}`}
          </div>
        </div>
      `;
    }

    function clearAllTrades() {
      const container = document.getElementById('tradeContainer');
      container.innerHTML = '';
      teamCounter = 0;
      addTeam();
    }

    function randomTrade() {
      // Clear existing trades
      clearAllTrades();
      
      // Add two random teams
      addTeam();
      addTeam();
      
      // Get random teams
      const teamCodes = Object.keys(nbaTeams);
      const team1 = teamCodes[Math.floor(Math.random() * teamCodes.length)];
      let team2 = teamCodes[Math.floor(Math.random() * teamCodes.length)];
      while (team2 === team1) {
        team2 = teamCodes[Math.floor(Math.random() * teamCodes.length)];
      }
      
      // Set the teams
      setTimeout(() => {
        const selects = document.querySelectorAll('.team-block select');
        if (selects[0]) {
          selects[0].value = team1;
          loadTeamRoster(selects[0], 'team-1');
        }
        if (selects[1]) {
          selects[1].value = team2;
          loadTeamRoster(selects[1], 'team-2');
        }
      }, 100);
    }

    // Initialize with one team
    document.addEventListener('DOMContentLoaded', function() {
      addTeam();
      
      // Initialize export functionality
      initializeExportFunctionality();
    });

    function initializeExportFunctionality() {
      const exportTradeBtn = document.getElementById('exportTradeBtn');
      const exportModal = document.getElementById('exportModal');
      const exportCanvas = document.getElementById('exportCanvas');
      const exportPreview = document.getElementById('exportPreview');
      const copyTradeBtn = document.getElementById('copyTradeBtn');
      const downloadTradeBtn = document.getElementById('downloadTradeBtn');
      const closeExportModal = document.getElementById('closeExportModal');

      if (exportTradeBtn) {
        exportTradeBtn.addEventListener('click', async () => {
          exportTradeBtn.disabled = true;
          exportTradeBtn.textContent = '📸 Generating...';
          
          try {
            // Load html2canvas from CDN
            if (!window.html2canvas) {
              const script = document.createElement('script');
              script.src = 'https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js';
              document.head.appendChild(script);
              
              await new Promise((resolve, reject) => {
                script.onload = resolve;
                script.onerror = reject;
              });
            }
            
            // Capture the modal content (excluding the export button)
            const modalBody = document.querySelector('.modal-body');
            const exportContainer = modalBody.querySelector('.export-container');
            
            // Temporarily hide the export button
            if (exportContainer) {
              exportContainer.style.display = 'none';
            }
            
            const canvas = await html2canvas(modalBody, {
              backgroundColor: '#0f172a',
              scale: 2,
              useCORS: true,
              allowTaint: true,
              logging: false,
              width: modalBody.offsetWidth,
              height: modalBody.offsetHeight - (exportContainer ? exportContainer.offsetHeight : 0)
            });

            // Show the export button again
            if (exportContainer) {
              exportContainer.style.display = 'block';
            }

            // Create final canvas with branding
            const footerHeight = 120;
            const finalCanvas = document.createElement('canvas');
            finalCanvas.width = canvas.width;
            finalCanvas.height = canvas.height + footerHeight;
            const ctx = finalCanvas.getContext('2d');

            // Dark background for professional look
            ctx.fillStyle = '#0f172a';
            ctx.fillRect(0, 0, finalCanvas.width, finalCanvas.height);
            
            // Add border
            ctx.strokeStyle = '#3b82f6';
            ctx.lineWidth = 6;
            ctx.strokeRect(20, 20, finalCanvas.width - 40, finalCanvas.height - 40);

            // Draw the captured content
            ctx.drawImage(canvas, 20, 20);

            // Add footer branding
            const y = finalCanvas.height - 60;
            ctx.fillStyle = '#ffffff';
            ctx.font = 'bold 32px Georgia, serif';
            ctx.textAlign = 'center';
            ctx.fillText('SixersHoops.com', finalCanvas.width / 2, y);

            ctx.fillStyle = '#3b82f6';
            ctx.font = '20px Arial, sans-serif';
            ctx.fillText('NBA Trade Simulator Pro', finalCanvas.width / 2, y + 35);

            // Add decorative line
            ctx.strokeStyle = '#3b82f6';
            ctx.lineWidth = 4;
            ctx.beginPath();
            ctx.moveTo(finalCanvas.width / 2 - 200, y - 25);
            ctx.lineTo(finalCanvas.width / 2 + 200, y - 25);
            ctx.stroke();

            // Show export modal
            exportModal.style.display = 'flex';
            exportPreview.src = finalCanvas.toDataURL('image/png');

            // Store canvas for download/copy
            exportCanvas.width = finalCanvas.width;
            exportCanvas.height = finalCanvas.height;
            exportCanvas.getContext('2d').drawImage(finalCanvas, 0, 0);

          } catch (err) {
            console.error('Export failed:', err);
            alert('Export failed - please try again.');
          } finally {
            exportTradeBtn.disabled = false;
            exportTradeBtn.textContent = '📸 Share Trade Analysis';
          }
        });
      }

      if (copyTradeBtn) {
        copyTradeBtn.addEventListener('click', async () => {
          try {
            exportCanvas.toBlob(async (blob) => {
              await navigator.clipboard.write([
                new ClipboardItem({ 'image/png': blob })
              ]);
              copyTradeBtn.textContent = '✅ Copied!';
              setTimeout(() => {
                copyTradeBtn.textContent = '📋 Copy to Clipboard';
              }, 2000);
            });
          } catch (err) {
            console.error('Copy failed:', err);
            alert('Copy failed - please try again.');
          }
        });
      }

      if (downloadTradeBtn) {
        downloadTradeBtn.addEventListener('click', () => {
          const a = document.createElement('a');
          a.download = 'nba-trade-analysis.png';
          a.href = exportCanvas.toDataURL('image/png');
          a.click();
        });
      }

      if (closeExportModal) {
        closeExportModal.addEventListener('click', () => {
          exportModal.style.display = 'none';
        });
      }

      // Close export modal when clicking outside
      if (exportModal) {
        exportModal.addEventListener('click', (e) => {
          if (e.target === exportModal) {
            exportModal.style.display = 'none';
          }
        });
      }

      // Close export modal with Escape key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && exportModal && exportModal.style.display === 'flex') {
          exportModal.style.display = 'none';
        }
      });
    }

    // Mobile hamburger menu functionality
    document.addEventListener('DOMContentLoaded', function() {
      const hamburger = document.querySelector('.hamburger');
      const navRight = document.querySelector('.nav-right');
      
      if (hamburger && navRight) {
        hamburger.addEventListener('click', function() {
          navRight.classList.toggle('open');
          hamburger.setAttribute('aria-expanded', 
            hamburger.getAttribute('aria-expanded') === 'true' ? 'false' : 'true'
          );
        });
      }
    });
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>NBA Trade Machine</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:400,600,700&display=swap">
  <link rel="stylesheet" href="styles.css" />
  <style>
    body {
      font-family: 'Inter', Arial, sans-serif;
      background: #f6f8fa;
      margin: 0;
      color: #23272F;
    }
    /* Navbar (same as your site) ... */
    .navbar {
      position: fixed;
      top: 0;
      width: 100vw;
      background: #0a174e;
      color: #fff;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 8px rgba(10,23,78,0.08);
      padding: 0.5rem 2rem;
      z-index: 1001;
    }
    .nav-left {
      display: flex;
      align-items: center;
      gap: 1rem;
    }
    .nav-logo {
      width: 40px;
      height: 40px;
      object-fit: contain;
    }
    .site-title {
      font-size: 1.4rem;
      font-weight: 700;
      letter-spacing: 1px;
      color: #fff;
    }
    .nav-right {
      display: flex;
      align-items: center;
      gap: 1.5rem;
    }
    .nav-link {
      text-decoration: none;
      color: #fff;
      font-weight: 500;
      padding: 0.5rem 1rem;
      border-radius: 4px;
      transition: background 0.2s;
      position: relative;
    }
    .nav-link.active, .nav-link:hover {
      background: #0057e7;
      color: #fff;
    }
    .nav-dropdown {
      position: relative;
      display: inline-block;
      margin-left: 2rem;
    }
    .dropdown-btn {
      background: none;
      border: none;
      color: #fff;
      font-weight: 500;
      padding: 0.5rem 1rem;
      cursor: pointer;
      border-radius: 4px;
      transition: background 0.2s;
      font-size: 1rem;
      outline: none;
    }
    .dropdown-btn:hover,
    .nav-dropdown:hover .dropdown-btn {
      background: #0057e7;
    }
    .dropdown-content {
      display: none;
      position: absolute;
      top: 110%;
      left: 0;
      min-width: 220px;
      background: #fff;
      box-shadow: 0 4px 20px rgba(10,23,78,0.13);
      border-radius: 8px;
      z-index: 1000;
      flex-direction: column;
      padding: 0.5rem 0;
    }
    .nav-dropdown:hover .dropdown-content,
    .nav-dropdown:focus-within .dropdown-content {
      display: flex;
    }
    .dropdown-link {
      color: #0a174e;
      text-decoration: none;
      padding: 0.7rem 1.2rem;
      transition: background 0.2s, color 0.2s;
      font-weight: 500;
      font-size: 1rem;
      border-radius: 4px;
      margin: 0 0.3rem;
      outline: none;
    }
    .dropdown-link:hover {
      background: #e6f0ff;
      color: #0057e7;
    }
    .hamburger {
      display: none;
      flex-direction: column;
      gap: 6px;
      cursor: pointer;
      background: none;
      border: none;
      z-index: 101;
    }
    .hamburger span {
      width: 32px;
      height: 4px;
      background: #fff;
      border-radius: 2px;
      transition: all 0.3s;
      box-shadow: 0 2px 8px rgba(10,23,78,0.08);
    }
    @media (max-width: 950px) {
      .navbar { padding: 0.5rem 1rem; }
      .nav-right {
        display: none;
        position: absolute;
        top: 60px;
        left: 0;
        width: 100vw;
        background: #0a174e;
        flex-direction: column;
        box-shadow: 0 8px 24px rgba(10,23,78,0.17);
        padding-bottom: 1rem;
        z-index: 99;
        max-height: 0;
        overflow: hidden;
        border-radius: 0 0 16px 16px;
        border-top: 1px solid #0057e7;
        align-items: flex-start;
      }
      .nav-right.open { display: flex; max-height: 1000px; overflow: visible; animation: navShow 0.25s;}
      @keyframes navShow {
        from { opacity: 0; transform: translateY(-10px);}
        to { opacity: 1; transform: translateY(0);}
      }
      .hamburger { display: flex; position: fixed; top: 18px; right: 32px; margin-left: 0; background: none; border: none;}
      .dropdown-content { position: static; min-width: unset; box-shadow: none; background: transparent; border-radius: 0; padding: 0;}
      .dropdown-link { color: #fff; padding: 0.8rem 1.6rem;}
      .dropdown-link:hover { background: #0057e7; color: #fff;}
    }
    /* --- End Navbar --- */

    h1 {
      background: linear-gradient(90deg,#0a174e 60%,#0057e7 100%);
      color: #fff;
      padding: 2.5rem 0 1.2rem 0;
      margin: 0 0 1.3rem 0;
      text-align: center;
      font-weight: 800;
      font-size: 2.2rem;
      letter-spacing: 1.2px;
      box-shadow: 0 2px 12px rgba(10,23,78,0.08);
    }
    .trade-controls {
      text-align: center;
      margin: 1.3rem 0 2.2rem 0;
    }
    .trade-controls button {
      background: #0057e7;
      color: #fff;
      font-weight: 600;
      font-size: 1.08rem;
      padding: 0.7rem 1.8rem;
      border-radius: 8px;
      border: none;
      margin: 0 0.7rem;
      cursor: pointer;
      transition: background 0.18s;
    }
    .trade-controls button:disabled {
      background: #bbb;
      cursor: not-allowed;
    }
    .trade-container {
      display: flex;
      flex-wrap: wrap;
      gap: 2.5rem;
      justify-content: center;
      margin: 2.5rem 0;
    }
    .team-block {
      background: #fff;
      border-radius: 22px;
      box-shadow: 0 6px 40px rgba(10,23,78,0.13);
      padding: 2.2rem 1.7rem 1.8rem 1.7rem;
      min-width: 350px;
      max-width: 410px;
      flex: 1 1 350px;
      display: flex;
      flex-direction: column;
      align-items: stretch;
      margin-bottom: 1rem;
      position: relative;
      transition: box-shadow 0.17s, transform 0.12s;
    }
    .team-block:hover {
      box-shadow: 0 10px 48px rgba(0,87,231,0.18);
      transform: translateY(-2px) scale(1.01);
    }
    .team-block .remove-team-btn {
      position: absolute;
      top: 14px;
      right: 18px;
      background: none;
      color: #c20000;
      border: none;
      font-size: 1.25rem;
      font-weight: bold;
      cursor: pointer;
      z-index: 2;
      padding: 0 0.2rem;
      transition: color 0.18s;
    }
    .team-block .remove-team-btn:hover {
      color: #e74c3c;
    }
    .team-select label {
      font-weight: 600;
      color: #0057e7;
      margin-right: 0.7rem;
      font-size: 1.08rem;
    }
    .team-select select {
      font-size: 1.08rem;
      padding: 0.33rem 1rem;
      border-radius: 7px;
      border: 1px solid #bbb;
      margin-bottom: 1.3rem;
      margin-top: 0.2rem;
      background: #f6f8fa;
      font-weight: 500;
    }
    /* --- Modern Players List --- */
    .players-list {
      list-style: none;
      padding: 0;
      margin: 0;
      max-height: 320px;
      overflow-y: auto;
      border-radius: 14px;
      background: #f9fbfc;
      border: 1.5px solid #e4eaf2;
      box-shadow: 0 2px 10px rgba(10,23,78,0.05);
      margin-bottom: 1.3rem;
      display: flex;
      flex-direction: column;
      gap: 0.6rem;
    }
    .players-list li {
      display: flex;
      align-items: center;
      gap: 1.1rem;
      padding: 0.82rem 1.1rem;
      background: #fff;
      border-radius: 10px;
      font-size: 1.12rem;
      box-shadow: 0 1.5px 6px rgba(0,87,231,0.04);
      position: relative;
      transition: background 0.15s, box-shadow 0.12s, transform 0.11s;
      cursor: pointer;
      border: 1px solid #e9eef3;
    }
    .players-list li.selected,
    .players-list li:hover {
      background: #e6f0ff;
      box-shadow: 0 2px 10px rgba(0,87,231,0.13);
      transform: scale(1.02);
      border: 1.5px solid #0057e7;
    }
    .player-avatar {
      width: 38px;
      height: 38px;
      border-radius: 50%;
      background: linear-gradient(120deg,#dbeafe 70%,#e0e7ef 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.21em;
      font-weight: bold;
      color: #0a174e;
      flex-shrink: 0;
      margin-right: 6px;
      box-shadow: 0 2px 8px rgba(10,23,78,0.07);
      border: 2px solid #fff;
      letter-spacing: 0.01em;
      text-transform: uppercase;
    }
    .players-list input[type=checkbox] {
      margin-right: 0.1em;
      accent-color: #0057e7;
      cursor: pointer;
      width: 1.27em; height: 1.27em;
      border-radius: 5px;
      border: 1.5px solid #0057e7;
      box-shadow: 0 0.5px 2px rgba(0,87,231,0.06);
      transition: box-shadow 0.11s;
      flex-shrink: 0;
    }
    .players-list label {
      flex: 1;
      cursor: pointer;
      font-weight: 600;
      letter-spacing: 0.01em;
      color: #273a58;
    }
    .players-list .salary-cell {
      color: #0057e7;
      min-width: 124px;
      text-align: right;
      font-weight: 700;
      font-size: 1.09rem;
      letter-spacing: 0.01em;
    }
    .totals {
      margin: 1.1rem 0 0 0;
      font-weight: 700;
      font-size: 1.18rem;
      color: #333;
      text-align: right;
    }
    .payroll-box {
      margin-top: 1.1rem;
      background: #f3f7fb;
      border-radius: 9px;
      padding: 1.1rem 1.2rem 0.7rem 1.2rem;
      font-size: 1.07rem;
      color: #0a174e;
      box-shadow: 0 2px 10px rgba(0,87,231,0.05);
    }
    .payroll-box .line {
      margin-bottom: 0.47rem;
    }
    .payroll-box .level {
      font-weight: 700;
      min-width: 130px;
      display: inline-block;
    }
    .payroll-box .over { color: #b91c1c; font-weight: 700;}
    .payroll-box .under { color: #15803d; font-weight: 700;}
    .trade-btn {
      margin: 2.4rem auto 1.6rem auto;
      display: block;
      background: #0057e7;
      color: #fff;
      font-size: 1.27rem;
      font-weight: bold;
      border-radius: 13px;
      padding: 1.1rem 3.2rem;
      border: none;
      cursor: pointer;
      transition: background 0.2s, box-shadow 0.18s;
      box-shadow: 0 4px 16px rgba(0,87,231,0.13);
      letter-spacing: 0.03em;
    }
    .trade-btn:hover {
      background: #0a174e;
      box-shadow: 0 8px 28px rgba(0,87,231,0.17);
    }
    .result-block {
      background: #fff;
      border-radius: 14px;
      max-width: 700px;
      margin: 2rem auto;
      box-shadow: 0 4px 16px rgba(10,23,78,0.13);
      padding: 1.7rem 2.5rem;
      font-size: 1.16rem;
      font-weight: 500;
      border-left: 8px solid #eee;
      text-align: left;
    }
    .result-block.success {
      border-left: 8px solid #13a813;
      color: #13a813;
      background: #f3fff4;
    }
    .result-block.fail {
      border-left: 8px solid #c20000;
      color: #c20000;
      background: #fff7f7;
    }
    .result-title {
      font-size: 1.27rem;
      font-weight: 700;
      margin-bottom: 0.6rem;
      letter-spacing: 0.5px;
    }
    .back-home-btn {
      display: inline-block;
      background: #0a174e;
      color: #fff;
      padding: 0.7rem 2.2rem;
      border-radius: 8px;
      font-size: 1.12rem;
      font-weight: 700;
      text-decoration: none;
      box-shadow: 0 2px 8px rgba(10,23,78,0.12);
      transition: background 0.2s;
      margin: 2.7rem auto 2.5rem auto;
      text-align: center;
      display: block;
      width: fit-content;
    }
    .back-home-btn:hover {
      background: #0057e7;
      color: #fff;
    }
    @media (max-width: 1200px) {
      .trade-container { flex-direction: column; align-items: center;}
      .team-block { width: 99vw; max-width: 480px;}
    }
    @media (max-width: 600px) {
      .team-block { padding: 1.1rem 0.6rem; min-width: 0; }
      .result-block { padding: 1.1rem 0.7rem; }
      .trade-btn { padding: 0.7rem 1.2rem; font-size: 1.07rem;}
      .back-home-btn { margin: 1.5rem auto 1.5rem auto;}
    }
  </style>
</head>
<body>
  <!-- Modern Navbar (with Home and Trade Machine navs) -->
  <nav class="navbar">
    <div class="nav-left">
      <img src="sixershoopslogo.png" alt="SixersHoops Logo" class="nav-logo" />
      <span class="site-title">SixersHoops</span>
    </div>
    <button class="hamburger" aria-label="Menu" aria-expanded="false">
      <span></span>
      <span></span>
      <span></span>
    </button>
    <div class="nav-right">
      <a href="index.html" class="nav-link">Home</a>
      <div style="margin-left: 2rem;" class="nav-dropdown">
        <button class="dropdown-btn" aria-haspopup="true" aria-expanded="false">Cap &amp; Draft Management</button>
        <div class="dropdown-content">
          <a href="salary.html" class="dropdown-link">Salary Breakdown</a>
          <a href="draft.html" class="dropdown-link">Future Draft Capital</a>
          <a href="depth.html" class="dropdown-link">Depth Chart</a>
        </div>
      </div>
      <a href="nba-trade-machine.html" class="nav-link active" style="margin-left: 2rem;">Trade Machine</a>
    </div>
  </nav>
  <div style="height:72px"></div> <!-- offset for fixed nav -->
  <h1>NBA Trade Machine</h1>
  <div class="trade-controls">
    <button id="addTeamBtn">+ Add Team</button>
    <button id="removeTeamBtn">− Remove Team</button>
  </div>
  <form id="tradeForm" autocomplete="off">
    <div class="trade-container" id="tradeContainer"></div>
    <button type="button" class="trade-btn" id="tryTrade">Propose Trade</button>
  </form>
  <div id="tradeResult"></div>
  <a href="index.html" class="back-home-btn">← Back to Home</a>
  <script>
    // NBA thresholds
    const SALARY_CAP = 154647000;
    const LUXURY_TAX = 187895000;
    const FIRST_APRON = 195945000;
    const SECOND_APRON = 207824000;

    const maxTeams = 5, minTeams = 2;
    const teams = {
      "Atlanta Hawks": [
        { name: "Trae Young", salary: 45999660 },
        { name: "Kristaps Porziņģis", salary: 30731707 },
        { name: "Jalen Johnson", salary: 30000000 },
        { name: "Nickeil Alexander-Walker", salary: 15161800 },
        { name: "Onyeka Okongwu", salary: 15000000 },
        { name: "Zaccharie Risacher", salary: 13197720 },
        { name: "Luke Kennard", salary: 11000000 },
        { name: "Dyson Daniels", salary: 7707709 },
        { name: "Kobe Bufkin", salary: 4503720 },
        { name: "Asa Newell", salary: 3237480 },
        { name: "Vít Krejčí", salary: 2349578 },
        { name: "Caleb Houstan", salary: 2296274 },
        { name: "Mouhamed Gueye", salary: 2221677 },
        { name: "Nikola Đurišić", salary: 1272870 }
      ],
      "Boston Celtics": [
        { name: "Jayson Tatum", salary: 54126450 },
        { name: "Jaylen Brown", salary: 53142264 },
        { name: "Derrick White", salary: 27750700 },
        { name: "Anfernee Simons", salary: 27678571 },
        { name: "Sam Hauser", salary: 10044644 },
        { name: "Georges Niang", salary: 8200000 },
        { name: "Payton Pritchard", salary: 7232143 },
        { name: "Hugo González", salary: 2783880 },
        { name: "Baylor Scheierman", salary: 2619000 },
        { name: "Xavier Tillman", salary: 2546674 },
        { name: "Luka Garza", salary: 2461463 },
        { name: "Josh Minott", salary: 2378870 },
        { name: "Neemias Queta", salary: 2349578 },
        { name: "JD Davison", salary: 2270735 },
        { name: "Jordan Walsh", salary: 2221677 }
      ],
      "Brooklyn Nets": [
        { name: "Michael Porter Jr.", salary: 38333050 },
        { name: "Nicolas Claxton", salary: 25352272 },
        { name: "Terance Mann", salary: 15500000 },
        { name: "Egor Đëmin", salary: 6889200 },
        { name: "Day'Ron Sharpe", salary: 6000000 },
        { name: "Ziaire Williams", salary: 6000000 },
        { name: "Nolan Traoré", salary: 3811560 },
        { name: "Noah Clowney", salary: 3398640 },
        { name: "Dariq Whitehead", salary: 3262560 },
        { name: "Drake Powell", salary: 3372240 },
        { name: "Ben Saraf", salary: 2884560 },
        { name: "Danny Wolf", salary: 2801280 },
        { name: "Keon Johnson", salary: 2349578 },
        { name: "Jalen Wilson", salary: 2221677 },
        { name: "Tyrese Martin", salary: 2191897 },
        { name: "Drew Timme", salary: 1955378 }
      ]
    };
    let teamBlocks = [
      { team: "Atlanta Hawks", outgoing: [], incoming: [] },
      { team: "Boston Celtics", outgoing: [], incoming: [] }
    ];
    function salaryFmt(val) {
      return "$" + val.toLocaleString('en-US', {maximumFractionDigits: 0});
    }
    function initials(name) {
      return name
        .split(' ')
        .map(w => w[0])
        .join('')
        .toUpperCase()
        .slice(0,2);
    }
    function payrollBox(players) {
      let total = players.reduce((a,p)=>a+p.salary,0);
      function line(label, threshold) {
        let diff = total - threshold;
        let txt = (diff > 0)
          ? `<span class="over">-${salaryFmt(Math.abs(diff))} over</span>`
          : `<span class="under">${salaryFmt(Math.abs(diff))} under</span>`;
        return `<div class="line"><span class="level">${label}:</span> ${txt}</div>`;
      }
      return `
        <div class="payroll-box">
          <div class="line"><span class="level">Total Payroll</span>: ${salaryFmt(total)}</div>
          ${line("Salary Cap", SALARY_CAP)}
          ${line("Luxury Tax", LUXURY_TAX)}
          ${line("First Apron", FIRST_APRON)}
          ${line("Second Apron", SECOND_APRON)}
        </div>
      `;
    }
    function renderTeams() {
      const ctr = document.getElementById('tradeContainer');
      ctr.innerHTML = '';
      teamBlocks.forEach((block, idx) => {
        const usedTeams = teamBlocks.map(tb => tb.team);
        let teamOpts = '';
        for (let t of Object.keys(teams)) {
          teamOpts += `<option value="${t}" ${block.team === t ? 'selected' : (usedTeams.includes(t) ? 'disabled' : '')}>${t}</option>`;
        }
        const sel = block.outgoing || [];
        let plist = '';
        teams[block.team].forEach((p, pidx) => {
          plist += `
            <li${sel.includes(pidx) ? ' class="selected"' : ''}>
              <input type="checkbox" id="cb${idx}_${pidx}" data-teamidx="${idx}" data-pidx="${pidx}" ${sel.includes(pidx) ? 'checked' : ''}/>
              <span class="player-avatar">${initials(p.name)}</span>
              <label for="cb${idx}_${pidx}">${p.name}</label>
              <span class="salary-cell">${salaryFmt(p.salary)}</span>
            </li>
          `;
        });
        let total = sel.map(pidx => teams[block.team][pidx].salary).reduce((a,b) => a+b, 0);
        let removeBtn = '';
        if (teamBlocks.length > minTeams)
          removeBtn = `<button class="remove-team-btn" title="Remove team" data-remove="${idx}">&times;</button>`;
        ctr.innerHTML += `
          <div class="team-block" data-teamidx="${idx}">
            ${removeBtn}
            <div class="team-select">
              <label>Team ${idx+1}:</label>
              <select class="teamSel" data-teamidx="${idx}">
                ${teamOpts}
              </select>
            </div>
            <ul class="players-list">
              ${plist}
            </ul>
            <div class="totals">Outgoing Salary: <span id="outT${idx}">${salaryFmt(total)}</span></div>
            ${payrollBox(teams[block.team])}
          </div>
        `;
      });
      document.querySelectorAll('.teamSel').forEach(sel => {
        sel.onchange = function() {
          const idx = +this.dataset.teamidx;
          if (teamBlocks.map(tb => tb.team).includes(this.value)) return;
          teamBlocks[idx].team = this.value;
          teamBlocks[idx].outgoing = [];
          renderTeams();
        }
      });
      document.querySelectorAll('.players-list input[type=checkbox]').forEach(cb => {
        cb.onchange = function() {
          const tidx = +this.dataset.teamidx, pidx = +this.dataset.pidx;
          let arr = teamBlocks[tidx].outgoing || [];
          if (this.checked) {
            arr.push(pidx);
          } else {
            arr = arr.filter(x => x !== pidx);
          }
          teamBlocks[tidx].outgoing = arr;
          renderTeams();
        }
      });
      document.querySelectorAll('.remove-team-btn').forEach(btn => {
        btn.onclick = function() {
          const idx = +this.dataset.remove;
          teamBlocks.splice(idx, 1);
          renderTeams();
        }
      });
      document.getElementById('removeTeamBtn').disabled = (teamBlocks.length <= minTeams);
      document.getElementById('addTeamBtn').disabled = (teamBlocks.length >= maxTeams);
    }
    renderTeams();
    document.getElementById('addTeamBtn').onclick = function() {
      const used = teamBlocks.map(tb => tb.team);
      const avail = Object.keys(teams).find(t => !used.includes(t));
      if (avail) teamBlocks.push({team: avail, outgoing: [], incoming: []});
      renderTeams();
    };
    document.getElementById('removeTeamBtn').onclick = function() {
      if (teamBlocks.length > minTeams) {
        teamBlocks.pop();
        renderTeams();
      }
    };
    document.getElementById('tryTrade').onclick = function() {
      let tradeMap = teamBlocks.map(tb => ({
        team: tb.team,
        outgoingIdx: tb.outgoing,
        outgoing: tb.outgoing.map(idx => teams[tb.team][idx]),
      }));
      if (tradeMap.some(tm => tm.outgoing.length === 0)) {
        showResult('Trade Failed', 'Each team must trade at least one player.', false);
        return;
      }
      let teamCount = teamBlocks.length;
      let allSend = teamBlocks.map((tb, i) => tb.outgoing.map(idx => ({...teams[tb.team][idx], from: tb.team, idx})));
      let allPlayers = teamBlocks.map((tb, i) => teams[tb.team]);
      let allTeams = teamBlocks.map(tb => tb.team);
      let incoming = [];
      for (let i=0; i<teamCount; ++i) {
        let incArr = [];
        for (let j=0; j<teamCount; ++j) {
          if (i === j) continue;
          incArr.push(...allSend[j]);
        }
        incoming[i] = incArr;
      }
      let tradeOK = true, tradeDetails = [];
      for (let i=0; i<teamCount; ++i) {
        let outgoingSalary = tradeMap[i].outgoing.reduce((a, b) => a + b.salary, 0);
        let incomingSalary = incoming[i].reduce((a, b) => a + b.salary, 0);
        let maxIncoming = outgoingSalary * 1.25 + 250000;
        let stdPlayersOrig = teams[allTeams[i]].length;
        let stdOutgoing = tradeMap[i].outgoing.length;
        let stdIncoming = incoming[i].length;
        let stdAfter = stdPlayersOrig - stdOutgoing + stdIncoming;
        let reasons = [];
        if (stdAfter < 13) {
          tradeOK = false;
          reasons.push('Would leave fewer than 13 standard contracts.');
        }
        if (incomingSalary > maxIncoming) {
          tradeOK = false;
          reasons.push(`Incoming salary (${salaryFmt(incomingSalary)}) exceeds CBA limit (${salaryFmt(maxIncoming)}).`);
        }
        tradeDetails.push({
          team: allTeams[i],
          outgoingSalary, incomingSalary, maxIncoming, stdAfter, reasons
        });
      }
      if (!tradeOK) {
        let msg = '';
        tradeDetails.forEach(td => {
          if (td.reasons.length)
            msg += `<div><b>${td.team}:</b> ${td.reasons.join(' ')}</div>`;
        });
        showResult('Trade Failed', msg, false);
        return;
      }
      let msg = `<div class="result-title">Trade Successful!</div>`;
      teamBlocks.forEach((tb, i) => {
        msg += `<b>${tb.team} trades:</b> ${tradeMap[i].outgoing.map(p => p.name).join(', ')}<br>`;
        msg += `<b>${tb.team} receives:</b> ${incoming[i].map(p => p.name + (p.from ? ` (from ${p.from})` : '')).join(', ') || "(none)"}<br>`;
        msg += `<span style="font-size:0.97em;color:#444;">Incoming salary: ${salaryFmt(incoming[i].reduce((a, b) => a + b.salary, 0))}, Outgoing: ${salaryFmt(tradeMap[i].outgoing.reduce((a, b) => a + b.salary, 0))}</span><br><br>`;
      });
      showResult('Trade Successful!', msg, true);
    };
    function showResult(title, msg, ok) {
      document.getElementById('tradeResult').innerHTML = `
        <div class="result-block ${ok ? 'success' : 'fail'}">
          <div class="result-title">${title}</div>
          ${msg}
        </div>
      `;
    }
    // Navbar hamburger JS for mobile
    document.addEventListener("DOMContentLoaded", function() {
      const hamburger = document.querySelector(".hamburger");
      const navRight = document.querySelector(".nav-right");
      const dropdownBtn = document.querySelector(".dropdown-btn");
      const dropdownContent = document.querySelector(".dropdown-content");
      if (hamburger) hamburger.addEventListener("click", function() {
        navRight.classList.toggle("open");
        hamburger.setAttribute("aria-expanded", navRight.classList.contains("open"));
      });
      if (dropdownBtn) dropdownBtn.addEventListener("click", function(e) {
        e.stopPropagation();
        dropdownContent.classList.toggle("show");
        dropdownBtn.setAttribute("aria-expanded", dropdownContent.classList.contains("show"));
      });
      document.addEventListener("click", function(e) {
        if (dropdownBtn && dropdownContent && !dropdownBtn.contains(e.target) && !dropdownContent.contains(e.target)) {
          dropdownContent.classList.remove("show");
          dropdownBtn.setAttribute("aria-expanded", "false");
        }
      });
      document.querySelectorAll(".nav-link, .dropdown-link").forEach(link => {
        link.addEventListener("click", () => {
          navRight.classList.remove("open");
          if (hamburger) hamburger.setAttribute("aria-expanded", "false");
          if (dropdownContent && dropdownBtn) {
            dropdownContent.classList.remove("show");
            dropdownBtn.setAttribute("aria-expanded", "false");
          }
        });
      });
    });
  </script>
</body>
</html>

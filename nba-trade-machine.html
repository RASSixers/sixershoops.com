<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>NBA Trade Machine</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:400,600,700&display=swap">
  
  <!-- Navbar Styles - Auto-updates when you modify navbar-styles.css -->
  <link rel="stylesheet" href="navbar-styles.css">
  <style>
    body {
      font-family: 'Inter', Arial, sans-serif;
      background: #f6f8fa;
      margin: 0;
      color: #23272F;
      padding-top: 80px; /* Space for fixed navbar */
    }
    h1 {
      background: linear-gradient(90deg,#0a174e 60%,#0057e7 100%);
      color: #fff;
      padding: 2.5rem 0 1.2rem 0;
      margin: 0 0 1.1rem 0;
      text-align: center;
      font-weight: 800;
      font-size: 2.2rem;
      letter-spacing: 1.2px;
      box-shadow: 0 2px 12px rgba(10,23,78,0.08);
    }
    .description-block {
      max-width: 850px;
      margin: 1.3rem auto 2.3rem auto;
      background: #fff;
      border-radius: 18px;
      padding: 1.6rem 2.1rem 1.2rem 2.1rem;
      box-shadow: 0 2px 16px rgba(10,23,78,0.10);
      font-size: 1.1rem;
      color: #234;
      line-height: 1.72;
      border-left: 7px solid #0057e7;
    }
    .description-block strong {
      color: #0057e7;
    }
    .trade-controls {
      text-align: center;
      margin: 1.3rem 0 2.2rem 0;
    }
    .trade-controls button {
      background: #0057e7;
      color: #fff;
      font-weight: 600;
      font-size: 1.08rem;
      padding: 0.7rem 1.8rem;
      border-radius: 8px;
      border: none;
      margin: 0 0.7rem;
      cursor: pointer;
      transition: background 0.18s;
    }
    .trade-controls button:disabled {
      background: #bbb;
      cursor: not-allowed;
    }
    .trade-container {
      display: flex;
      flex-wrap: wrap;
      gap: 2.5rem;
      justify-content: center;
      margin: 2.5rem 0;
    }
    .team-block {
      background: #fff;
      border-radius: 22px;
      box-shadow: 0 6px 40px rgba(10,23,78,0.13);
      padding: 1.7rem 1.4rem 1.4rem 1.4rem;
      min-width: 350px;
      max-width: 410px;
      flex: 1 1 350px;
      display: flex;
      flex-direction: column;
      align-items: stretch;
      margin-bottom: 1rem;
      position: relative;
      transition: box-shadow 0.17s, transform 0.12s;
    }
    .team-block:hover {
      box-shadow: 0 10px 48px rgba(0,87,231,0.18);
      transform: translateY(-2px) scale(1.01);
    }
    .team-header {
      display: flex;
      align-items: center;
      gap: 1.2rem;
      background: linear-gradient(90deg, #0057e7 60%, #2688ff 100%);
      border-radius: 16px;
      box-shadow: 0 2px 12px rgba(0,87,231,0.09);
      padding: 0.75rem 1.1rem;
      margin-bottom: 1.15rem;
      min-height: 55px;
    }
    .team-label {
      color: #fff;
      font-weight: 700;
      font-size: 1.18rem;
      margin-right: 0.8rem;
      letter-spacing: 0.02em;
    }
    .team-header select {
      font-size: 1.1rem;
      border-radius: 8px;
      border: none;
      padding: 0.45rem 1.2rem;
      font-weight: 600;
      background: #ecf3fb;
      color: #0a174e;
      box-shadow: 0 2px 9px rgba(10,23,78,0.06);
      transition: background 0.14s;
    }
    .remove-team-btn {
      background: none;
      color: #fff;
      border: none;
      font-size: 1.25rem;
      font-weight: bold;
      cursor: pointer;
      margin-left: auto;
      margin-right: -0.4rem;
      transition: color 0.18s;
      box-shadow: none;
      padding: 0;
      opacity: 0.85;
    }
    .remove-team-btn:hover { color: #ffc2c2; }
    .players-list {
      list-style: none;
      padding: 0;
      margin: 0;
      max-height: 320px;
      overflow-y: auto;
      border-radius: 14px;
      background: #f9fbfc;
      border: 1.5px solid #e4eaf2;
      box-shadow: 0 2px 10px rgba(10,23,78,0.05);
      margin-bottom: 1.3rem;
      display: flex;
      flex-direction: column;
      gap: 0.6rem;
    }
    .players-list li {
      display: flex;
      align-items: center;
      gap: 1.1rem;
      padding: 0.82rem 1.1rem;
      background: #fff;
      border-radius: 10px;
      font-size: 1.12rem;
      box-shadow: 0 1.5px 6px rgba(0,87,231,0.04);
      position: relative;
      transition: background 0.15s, box-shadow 0.12s, transform 0.11s;
      cursor: pointer;
      border: 1px solid #e9eef3;
    }
    .players-list li.selected,
    .players-list li:hover {
      background: #e6f0ff;
      box-shadow: 0 2px 10px rgba(0,87,231,0.13);
      transform: scale(1.02);
      border: 1.5px solid #0057e7;
    }
    .player-avatar {
      width: 38px;
      height: 38px;
      border-radius: 50%;
      background: linear-gradient(120deg,#dbeafe 70%,#e0e7ef 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.21em;
      font-weight: bold;
      color: #0a174e;
      flex-shrink: 0;
      margin-right: 6px;
      box-shadow: 0 2px 8px rgba(10,23,78,0.07);
      border: 2px solid #fff;
      letter-spacing: 0.01em;
      text-transform: uppercase;
    }
    .players-list input[type=checkbox] {
      margin-right: 0.1em;
      accent-color: #0057e7;
      cursor: pointer;
      width: 1.27em; height: 1.27em;
      border-radius: 5px;
      border: 1.5px solid #0057e7;
      box-shadow: 0 0.5px 2px rgba(0,87,231,0.06);
      transition: box-shadow 0.11s;
      flex-shrink: 0;
    }
    .players-list label {
      flex: 1;
      cursor: pointer;
      font-weight: 600;
      letter-spacing: 0.01em;
      color: #273a58;
    }
    .players-list .salary-cell {
      color: #0057e7;
      min-width: 124px;
      text-align: right;
      font-weight: 700;
      font-size: 1.09rem;
      letter-spacing: 0.01em;
    }
    .totals {
      margin: 1.1rem 0 0 0;
      font-weight: 700;
      font-size: 1.18rem;
      color: #333;
      text-align: right;
    }
    .payroll-box {
      margin-top: 1.1rem;
      background: #f3f7fb;
      border-radius: 9px;
      padding: 1.1rem 1.2rem 0.7rem 1.2rem;
      font-size: 1.07rem;
      color: #0a174e;
      box-shadow: 0 2px 10px rgba(0,87,231,0.05);
    }
    .payroll-box .line { margin-bottom: 0.47rem; }
    .payroll-box .level {
      font-weight: 700;
      min-width: 130px;
      display: inline-block;
    }
    .payroll-box .over { color: #b91c1c; font-weight: 700;}
    .payroll-box .under { color: #15803d; font-weight: 700;}
    .trade-btn {
      margin: 2.4rem auto 1.6rem auto;
      display: block;
      background: #0057e7;
      color: #fff;
      font-size: 1.27rem;
      font-weight: bold;
      border-radius: 13px;
      padding: 1.1rem 3.2rem;
      border: none;
      cursor: pointer;
      transition: background 0.2s, box-shadow 0.18s;
      box-shadow: 0 4px 16px rgba(0,87,231,0.13);
      letter-spacing: 0.03em;
    }
    .trade-btn:hover {
      background: #0a174e;
      box-shadow: 0 8px 28px rgba(0,87,231,0.17);
    }
    .result-block {
      background: #fff;
      border-radius: 14px;
      max-width: 700px;
      margin: 2rem auto;
      box-shadow: 0 4px 16px rgba(10,23,78,0.13);
      padding: 1.7rem 2.5rem;
      font-size: 1.16rem;
      font-weight: 500;
      border-left: 8px solid #eee;
      text-align: left;
    }
    .result-block.success {
      border-left: 8px solid #13a813;
      color: #13a813;
      background: #f3fff4;
    }
    .result-block.fail {
      border-left: 8px solid #c20000;
      color: #c20000;
      background: #fff7f7;
    }
    .result-title {
      font-size: 1.27rem;
      font-weight: 700;
      margin-bottom: 0.6rem;
      letter-spacing: 0.5px;
    }
    .back-home-btn {
      display: inline-block;
      background: #0a174e;
      color: #fff;
      padding: 0.7rem 2.2rem;
      border-radius: 8px;
      font-size: 1.12rem;
      font-weight: 700;
      text-decoration: none;
      box-shadow: 0 2px 8px rgba(10,23,78,0.12);
      transition: background 0.2s;
      margin: 2.7rem auto 2.5rem auto;
      text-align: center;
      display: block;
      width: fit-content;
    }
    .back-home-btn:hover {
      background: #0057e7;
      color: #fff;
    }
    @media (max-width: 1200px) {
      .trade-container { flex-direction: column; align-items: center;}
      .team-block { width: 99vw; max-width: 480px;}
    }
    @media (max-width: 600px) {
      .team-block { padding: 1.1rem 0.6rem; min-width: 0; }
      .result-block { padding: 1.1rem 0.7rem; }
      .trade-btn { padding: 0.7rem 1.2rem; font-size: 1.07rem;}
      .back-home-btn { margin: 1.5rem auto 1.5rem auto;}
    }
  </style>
</head>
<body>
  <!-- Navigation will be automatically injected here by nav.js -->

  <h1>üîÑ NBA Trade Machine</h1>

  <div class="description-block">
    <strong>Welcome to the NBA Trade Machine!</strong> This interactive tool allows you to simulate trades between NBA teams, analyze salary cap implications, and explore potential trade scenarios. Select players from different teams, analyze the financial impact, and see if your proposed trades would work under NBA salary cap rules.
  </div>

  <div class="trade-controls">
    <button onclick="addTeam()">+ Add Team</button>
    <button onclick="clearAllTrades()">Clear All</button>
    <button onclick="randomTrade()">Random Trade</button>
  </div>

  <div class="trade-container" id="tradeContainer">
    <!-- Teams will be dynamically added here -->
  </div>

  <button class="trade-btn" onclick="analyzeTrade()">üìä Analyze Trade</button>

  <div id="tradeResult" class="result-block" style="display: none;">
    <div class="result-title">Trade Analysis</div>
    <div id="resultContent"></div>
  </div>

  <a href="index.html" class="back-home-btn">‚Üê Back to Home</a>

  <!-- Navigation JavaScript - Auto-updates when you modify nav.js -->
  <script src="nav.js"></script>
  
  <script>
    // NBA Teams data
    const nbaTeams = {
      'PHI': { name: 'Philadelphia 76ers', color: '#0057e7' },
      'LAL': { name: 'Los Angeles Lakers', color: '#552583' },
      'GSW': { name: 'Golden State Warriors', color: '#1D428A' },
      'BOS': { name: 'Boston Celtics', color: '#007A33' },
      'MIA': { name: 'Miami Heat', color: '#98002E' },
      'BRK': { name: 'Brooklyn Nets', color: '#000000' },
      'MIL': { name: 'Milwaukee Bucks', color: '#00471B' },
      'DAL': { name: 'Dallas Mavericks', color: '#00538C' },
      'DEN': { name: 'Denver Nuggets', color: '#0E2240' },
      'PHX': { name: 'Phoenix Suns', color: '#1D1160' }
    };

    // Sample player data (you can expand this with real NBA data)
    const playersData = {
      'PHI': [
        { name: "Joel Embiid", salary: 51415938, position: "C" },
        { name: "Tyrese Maxey", salary: 35000000, position: "PG" },
        { name: "Paul George", salary: 49176471, position: "SF" },
        { name: "Caleb Martin", salary: 8000000, position: "SF" },
        { name: "Kelly Oubre Jr.", salary: 8018519, position: "SF" },
        { name: "Kyle Lowry", salary: 2087519, position: "PG" },
        { name: "Andre Drummond", salary: 5000000, position: "C" },
        { name: "Eric Gordon", salary: 3303771, position: "SG" },
        { name: "Reggie Jackson", salary: 2087519, position: "PG" },
        { name: "Guerschon Yabusele", salary: 2087519, position: "PF" }
      ],
      'LAL': [
        { name: "LeBron James", salary: 48728845, position: "SF" },
        { name: "Anthony Davis", salary: 43219440, position: "PF" },
        { name: "Russell Westbrook", salary: 47063478, position: "PG" },
        { name: "Austin Reaves", salary: 12000000, position: "SG" }
      ],
      'GSW': [
        { name: "Stephen Curry", salary: 55761217, position: "PG" },
        { name: "Klay Thompson", salary: 43219440, position: "SG" },
        { name: "Draymond Green", salary: 27586224, position: "PF" },
        { name: "Andrew Wiggins", salary: 26271818, position: "SF" }
      ]
    };

    let teams = [];
    let tradeId = 0;

    function addTeam() {
      const teamId = `team-${++tradeId}`;
      const teamBlock = createTeamBlock(teamId);
      document.getElementById('tradeContainer').appendChild(teamBlock);
    }

    function createTeamBlock(teamId) {
      const div = document.createElement('div');
      div.className = 'team-block';
      div.id = teamId;
      
      div.innerHTML = `
        <div class="team-header">
          <span class="team-label">Team</span>
          <select onchange="loadTeamPlayers('${teamId}', this.value)">
            <option value="">Select Team</option>
            ${Object.entries(nbaTeams).map(([code, team]) => 
              `<option value="${code}">${team.name}</option>`
            ).join('')}
          </select>
          <button class="remove-team-btn" onclick="removeTeam('${teamId}')" title="Remove Team">√ó</button>
        </div>
        <ul class="players-list" id="${teamId}-players">
          <li style="text-align: center; color: #666; font-style: italic; padding: 2rem;">
            Select a team to view players
          </li>
        </ul>
        <div class="totals">
          <div>Selected: <span id="${teamId}-total">$0</span></div>
        </div>
        <div class="payroll-box">
          <div class="line"><span class="level">Team Salary:</span> <span id="${teamId}-team-salary">$0</span></div>
          <div class="line"><span class="level">Luxury Tax:</span> <span id="${teamId}-luxury-tax">$0</span></div>
        </div>
      `;
      
      return div;
    }

    function loadTeamPlayers(teamId, teamCode) {
      if (!teamCode) return;
      
      const players = playersData[teamCode] || [];
      const playersList = document.getElementById(`${teamId}-players`);
      
      if (players.length === 0) {
        playersList.innerHTML = '<li style="text-align: center; color: #666; font-style: italic; padding: 2rem;">No players available</li>';
        return;
      }
      
      playersList.innerHTML = players.map(player => `
        <li>
          <input type="checkbox" id="${teamId}-${player.name}" onchange="updateTotals('${teamId}')">
          <div class="player-avatar">${player.name.split(' ').map(n => n[0]).join('')}</div>
          <label for="${teamId}-${player.name}">${player.name}</label>
          <span class="salary-cell">$${player.salary.toLocaleString()}</span>
        </li>
      `).join('');
      
      updateTotals(teamId);
    }

    function updateTotals(teamId) {
      const checkboxes = document.querySelectorAll(`#${teamId}-players input[type="checkbox"]:checked`);
      let total = 0;
      
      checkboxes.forEach(checkbox => {
        const salaryText = checkbox.closest('li').querySelector('.salary-cell').textContent;
        const salary = parseInt(salaryText.replace(/[$,]/g, ''));
        total += salary;
      });
      
      document.getElementById(`${teamId}-total`).textContent = `$${total.toLocaleString()}`;
      
      // Update team salary and luxury tax (simplified calculation)
      const teamSalary = total;
      const luxuryTaxThreshold = 165000000; // Approximate 2024-25 luxury tax threshold
      const luxuryTax = teamSalary > luxuryTaxThreshold ? (teamSalary - luxuryTaxThreshold) * 1.5 : 0;
      
      document.getElementById(`${teamId}-team-salary`).textContent = `$${teamSalary.toLocaleString()}`;
      document.getElementById(`${teamId}-luxury-tax`).textContent = luxuryTax > 0 ? 
        `$${luxuryTax.toLocaleString()}` : '$0';
      
      // Color coding
      const luxuryElement = document.getElementById(`${teamId}-luxury-tax`);
      luxuryElement.className = luxuryTax > 0 ? 'over' : 'under';
    }

    function removeTeam(teamId) {
      document.getElementById(teamId).remove();
    }

    function clearAllTrades() {
      document.getElementById('tradeContainer').innerHTML = '';
      document.getElementById('tradeResult').style.display = 'none';
      tradeId = 0;
    }

    function randomTrade() {
      clearAllTrades();
      
      // Add two random teams
      addTeam();
      addTeam();
      
      const teamCodes = Object.keys(nbaTeams);
      const team1Code = teamCodes[Math.floor(Math.random() * teamCodes.length)];
      let team2Code = teamCodes[Math.floor(Math.random() * teamCodes.length)];
      while (team2Code === team1Code) {
        team2Code = teamCodes[Math.floor(Math.random() * teamCodes.length)];
      }
      
      // Load teams
      const selects = document.querySelectorAll('.team-block select');
      selects[0].value = team1Code;
      selects[1].value = team2Code;
      
      loadTeamPlayers('team-1', team1Code);
      loadTeamPlayers('team-2', team2Code);
      
      // Select random players
      setTimeout(() => {
        const checkboxes1 = document.querySelectorAll('#team-1-players input[type="checkbox"]');
        const checkboxes2 = document.querySelectorAll('#team-2-players input[type="checkbox"]');
        
        if (checkboxes1.length > 0) {
          checkboxes1[Math.floor(Math.random() * checkboxes1.length)].checked = true;
          updateTotals('team-1');
        }
        
        if (checkboxes2.length > 0) {
          checkboxes2[Math.floor(Math.random() * checkboxes2.length)].checked = true;
          updateTotals('team-2');
        }
      }, 100);
    }

    function analyzeTrade() {
      const teams = document.querySelectorAll('.team-block');
      if (teams.length < 2) {
        alert('Please add at least 2 teams to analyze a trade.');
        return;
      }
      
      let analysis = '<h3>Trade Analysis Results</h3>';
      let totalSalaryOut = 0;
      let totalSalaryIn = 0;
      let isValid = true;
      let reasons = [];
      
      teams.forEach((team, index) => {
        const teamId = team.id;
        const selectedPlayers = team.querySelectorAll('input[type="checkbox"]:checked');
        const teamSelect = team.querySelector('select');
        const teamName = teamSelect.options[teamSelect.selectedIndex]?.text || 'Unknown Team';
        
        if (selectedPlayers.length === 0) {
          reasons.push(`${teamName} has no players selected`);
          isValid = false;
          return;
        }
        
        let teamSalary = 0;
        selectedPlayers.forEach(player => {
          const salaryText = player.closest('li').querySelector('.salary-cell').textContent;
          const salary = parseInt(salaryText.replace(/[$,]/g, ''));
          teamSalary += salary;
        });
        
        if (index === 0) {
          totalSalaryOut = teamSalary;
        } else {
          totalSalaryIn += teamSalary;
        }
        
        analysis += `<p><strong>${teamName}:</strong> ${selectedPlayers.length} player(s), $${teamSalary.toLocaleString()}</p>`;
      });
      
      // Simple trade validity check (NBA salary matching rules are complex)
      const salaryDifference = Math.abs(totalSalaryIn - totalSalaryOut);
      const allowedDifference = Math.max(totalSalaryOut * 0.25 + 100000, 5000000);
      
      if (salaryDifference > allowedDifference) {
        isValid = false;
        reasons.push(`Salary difference too large: $${salaryDifference.toLocaleString()} (max allowed: $${allowedDifference.toLocaleString()})`);
      }
      
      analysis += `<hr>`;
      analysis += `<p><strong>Salary Impact:</strong> ${totalSalaryIn > totalSalaryOut ? '+' : ''}$${(totalSalaryIn - totalSalaryOut).toLocaleString()}</p>`;
      analysis += `<p><strong>Trade Status:</strong> <span class="${isValid ? 'under' : 'over'}">${isValid ? 'VALID' : 'INVALID'}</span></p>`;
      
      if (!isValid) {
        analysis += `<p><strong>Issues:</strong></p><ul>`;
        reasons.forEach(reason => {
          analysis += `<li>${reason}</li>`;
        });
        analysis += `</ul>`;
      }
      
      const resultBlock = document.getElementById('tradeResult');
      resultBlock.className = `result-block ${isValid ? 'success' : 'fail'}`;
      resultBlock.style.display = 'block';
      document.getElementById('resultContent').innerHTML = analysis;
      
      resultBlock.scrollIntoView({ behavior: 'smooth' });
    }

    // Initialize with one team
    document.addEventListener('DOMContentLoaded', function() {
      addTeam();
    });

    // Mobile hamburger menu functionality
    document.addEventListener('DOMContentLoaded', function() {
      const hamburger = document.querySelector('.hamburger');
      const navRight = document.querySelector('.nav-right');
      
      if (hamburger && navRight) {
        hamburger.addEventListener('click', function() {
          navRight.classList.toggle('open');
          hamburger.setAttribute('aria-expanded', 
            hamburger.getAttribute('aria-expanded') === 'true' ? 'false' : 'true'
          );
        });
      }
    });
  </script>
</body>
</html>

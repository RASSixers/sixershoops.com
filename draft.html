<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>NBA Trade Machine - Professional Edition</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" href="/favicon.ico" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <!-- Simple Social Media Meta Tags -->
  <meta property="og:title" content="NBA Trade Machine | SixersHoops" />
  <meta property="og:description" content="Create and analyze NBA trades with our professional trade machine." />
  <meta property="og:image" content="trade-machine-social.png" />
  
  <style>
    :root {
      --primary-color: #0a174e;
      --secondary-color: #0057e7;
      --accent-color: #2688ff;
      --success-color: #22c55e;
      --warning-color: #f59e0b;
      --error-color: #ef4444;
      --text-primary: #1e293b;
      --text-secondary: #64748b;
      --text-muted: #94a3b8;
      --background-primary: #ffffff;
      --background-secondary: #f8fafc;
      --background-tertiary: #f1f5f9;
      --border-color: #e2e8f0;
      --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
      --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
      --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
      --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
      --radius-sm: 6px;
      --radius-md: 8px;
      --radius-lg: 12px;
      --radius-xl: 16px;
      --radius-2xl: 20px;
    }

    * {
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      margin: 0;
      color: var(--text-primary);
      padding-top: 60px;
      line-height: 1.6;
      font-weight: 400;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    
    /* NAVIGATION BAR - SAME AS CONTACT PAGE */
    .navbar {
      position: fixed;
      top: 0;
      width: 100%;
      background: #0a174e;
      color: #fff;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 8px rgba(10,23,78,0.08);
      padding: 0.5rem 2rem;
      z-index: 1001;
      height: 60px;
    }

    .nav-left {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .nav-logo {
      width: 40px;
      height: 40px;
      object-fit: contain;
      border-radius: 6px;
    }

    .site-title {
      font-size: 1.4rem;
      font-weight: 700;
      letter-spacing: 1px;
      color: #fff;
    }

    .nav-right {
      display: flex;
      align-items: center;
      gap: 1.5rem;
    }

    .nav-link {
      text-decoration: none;
      color: #fff;
      font-weight: 500;
      padding: 0.6rem 1.2rem;
      border-radius: 6px;
      transition: all 0.2s ease;
      position: relative;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .nav-link.active, .nav-link:hover {
      background: rgba(255, 255, 255, 0.15);
      color: #fff;
      transform: translateY(-1px);
      border-color: rgba(255, 255, 255, 0.2);
    }

    .nav-dropdown {
      position: relative;
      display: inline-block;
    }

    .dropdown-btn, .nav-action {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      color: #fff;
      font-weight: 500;
      padding: 0.6rem 1.2rem;
      cursor: pointer;
      border-radius: 6px;
      transition: all 0.2s ease;
      font-size: 1rem;
      outline: none;
    }

    .dropdown-btn:hover, .nav-action:hover,
    .nav-dropdown:hover .dropdown-btn,
    .nav-dropdown:hover .nav-action {
      background: rgba(255, 255, 255, 0.15);
      transform: translateY(-1px);
      border-color: rgba(255, 255, 255, 0.2);
    }
    .dropdown-content {
      display: none;
      position: absolute;
      top: 110%;
      left: 0;
      min-width: 220px;
      background: #fff;
      box-shadow: 0 4px 20px rgba(10,23,78,0.13);
      border-radius: 8px;
      z-index: 1000;
      flex-direction: column;
      padding: 0.5rem 0;
    }

    .nav-dropdown:hover .dropdown-content,
    .nav-dropdown:focus-within .dropdown-content {
      display: flex;
    }

    .dropdown-link {
      color: #0a174e;
      text-decoration: none;
      padding: 0.7rem 1.2rem;
      transition: background 0.2s, color 0.2s;
      font-weight: 500;
      font-size: 1rem;
      border-radius: 4px;
      margin: 0 0.3rem;
      outline: none;
    }

    .dropdown-link:hover {
      background: #e6f0ff;
      color: #0057e7;
    }

    .hamburger {
      display: none;
      flex-direction: column;
      gap: 6px;
      cursor: pointer;
      background: none;
      border: none;
      z-index: 101;
    }

    .hamburger span {
      width: 32px;
      height: 4px;
      background: #fff;
      border-radius: 2px;
      transition: all 0.3s;
      box-shadow: 0 2px 8px rgba(10,23,78,0.08);
    }
    @media (max-width: 768px) {
      .navbar {
        padding: 0.5rem 1rem;
      }
      
      .nav-right {
        position: fixed;
        top: 60px;
        right: 0;
        background: #0a174e;
        flex-direction: column;
        width: 100%;
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s ease;
        box-shadow: 0 4px 8px rgba(10,23,78,0.1);
        gap: 0;
        align-items: stretch;
        padding: 0;
      }
      
      .nav-right.open { 
        display: flex; 
        max-height: 1000px; 
        overflow: visible; 
        animation: navShow 0.25s;
      }
      
      @keyframes navShow {
        from { opacity: 0; transform: translateY(-10px);}
        to { opacity: 1; transform: translateY(0);}
      }
      
      .hamburger { 
        display: flex; 
        position: fixed; 
        top: 18px; 
        right: 32px; 
        margin-left: 0; 
        background: none; 
        border: none;
      }
      
      .dropdown-content { 
        position: static; 
        min-width: unset; 
        box-shadow: none; 
        background: transparent; 
        border-radius: 0; 
        padding: 0;
      }
      
      .dropdown-link { 
        color: #fff; 
        padding: 0.8rem 1.6rem;
      }
      
      .dropdown-link:hover { 
        background: #0057e7; 
        color: #fff;
      }
    }
    
    /* HERO SECTION */
    .hero-section {
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      color: #fff;
      padding: 4rem 0 3rem 0;
      margin: 0;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .hero-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.05)" stroke-width="1"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
      opacity: 0.3;
    }

    h1 {
      font-size: 3.5rem;
      font-weight: 800;
      letter-spacing: -0.025em;
      margin: 0 0 1rem 0;
      text-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      position: relative;
      z-index: 1;
    }

    .hero-subtitle {
      font-size: 1.25rem;
      font-weight: 400;
      opacity: 0.9;
      margin: 0;
      position: relative;
      z-index: 1;
    }
    
    .description-block {
      max-width: 900px;
      margin: 2rem auto;
      background: var(--background-primary);
      border-radius: var(--radius-2xl);
      padding: 2rem 2.5rem;
      box-shadow: var(--shadow-xl);
      font-size: 1.125rem;
      color: var(--text-primary);
      line-height: 1.7;
      border: 1px solid var(--border-color);
      position: relative;
    }

    .description-block::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 4px;
      height: 100%;
      background: linear-gradient(135deg, var(--secondary-color) 0%, var(--accent-color) 100%);
      border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
    }
    
    .description-block strong {
      color: var(--secondary-color);
      font-weight: 600;
    }

    /* TESTING DISCLAIMER BANNER */
    .testing-disclaimer {
      background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
      color: #ffffff;
      padding: 1rem 2rem;
      text-align: center;
      margin: 1rem auto 2rem auto;
      max-width: 1200px;
      border-radius: var(--radius-xl);
      box-shadow: var(--shadow-lg);
      border: 2px solid rgba(245, 158, 11, 0.3);
      position: relative;
      overflow: hidden;
    }

    .testing-disclaimer::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      animation: shimmer 3s infinite;
    }

    @keyframes shimmer {
      0% { left: -100%; }
      100% { left: 100%; }
    }

    .disclaimer-title {
      font-size: 1.2rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      position: relative;
      z-index: 1;
    }

    .disclaimer-text {
      font-size: 1rem;
      font-weight: 500;
      opacity: 0.95;
      line-height: 1.5;
      position: relative;
      z-index: 1;
    }

    .feature-highlight {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      background: linear-gradient(135deg, var(--secondary-color) 0%, var(--accent-color) 100%);
      color: white;
      padding: 0.25rem 0.75rem;
      border-radius: var(--radius-md);
      font-size: 0.9rem;
      font-weight: 600;
      margin: 0 0.25rem;
    }
    
    .trade-controls {
      text-align: center;
      margin: 2rem 0 3rem 0;
      display: flex;
      justify-content: center;
      gap: 1rem;
      flex-wrap: wrap;
    }
    
    .trade-controls button {
      background: linear-gradient(135deg, var(--secondary-color) 0%, var(--accent-color) 100%);
      color: #fff;
      font-weight: 600;
      font-size: 1rem;
      padding: 1rem 2rem;
      border-radius: var(--radius-xl);
      border: none;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: var(--shadow-lg);
      letter-spacing: -0.025em;
      position: relative;
      overflow: hidden;
      min-width: 140px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .trade-controls button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s ease;
    }

    .trade-controls button:hover::before {
      left: 100%;
    }
    
    .trade-controls button:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow-xl);
    }

    .trade-controls button:active {
      transform: translateY(-1px);
    }
    
    .trade-controls button:disabled {
      background: var(--text-muted);
      cursor: not-allowed;
      transform: none;
      box-shadow: var(--shadow-sm);
    }

    .trade-controls button:disabled::before {
      display: none;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--secondary-color) 0%, var(--accent-color) 100%);
    }

    .btn-success {
      background: linear-gradient(135deg, var(--success-color) 0%, #16a34a 100%);
    }

    .btn-secondary {
      background: linear-gradient(135deg, var(--text-secondary) 0%, var(--text-muted) 100%);
    }

    /* EXPORT MODAL STYLES - SAME AS DEPTH.HTML */
    .export-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 2000;
      justify-content: center;
      align-items: center;
    }

    .export-modal-content {
      background: #fff;
      border-radius: 16px;
      padding: 2rem;
      max-width: 600px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      text-align: center;
      position: relative;
    }

    .export-preview {
      max-width: 100%;
      height: auto;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      margin-bottom: 1.5rem;
    }

    .export-actions {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
    }

    .copy-btn, .download-btn, .close-btn {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .copy-btn {
      background: #007bff;
      color: #fff;
    }

    .download-btn {
      background: #28a745;
      color: #fff;
    }

    .close-btn {
      background: #6c757d;
      color: #fff;
    }

    .copy-btn:hover, .download-btn:hover, .close-btn:hover {
      transform: translateY(-2px);
      opacity: 0.9;
    }

    /* BOTTOM ADVERTISEMENT ROW - 5 IN A ROW FLAT (SAME AS INDEX.HTML) */
    .bottom-ads {
      display: flex;
      justify-content: center;
      gap: 0.5rem;
      margin: 3rem 0 2rem 0;
      flex-wrap: nowrap;
      padding: 0 1rem;
      width: 100%;
      max-width: 1600px;
      margin-left: auto;
      margin-right: auto;
    }

    .ad-space {
      width: 300px;
      height: 250px;
      background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      border: 2px dashed #cbd5e0;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
      color: #64748b;
      font-weight: 600;
      text-align: center;
      transition: all 0.3s ease;
      flex: 0 0 300px;
    }

    .ad-space:hover {
      border-color: #94a3b8;
      background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
    }
    
    .trade-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(420px, 1fr));
      gap: 2rem;
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 1.5rem;
    }
    
    .team-block {
      background: var(--background-primary);
      border-radius: var(--radius-2xl);
      box-shadow: var(--shadow-lg);
      padding: 0;
      display: flex;
      flex-direction: column;
      position: relative;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      overflow: hidden;
      border: 1px solid var(--border-color);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }
    
    .team-block:hover {
      box-shadow: var(--shadow-xl);
      transform: translateY(-8px) scale(1.02);
      border-color: var(--secondary-color);
    }

    .team-block::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--secondary-color) 0%, var(--accent-color) 100%);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .team-block:hover::before {
      opacity: 1;
    }
    
    .team-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      background: linear-gradient(135deg, #0057e7 0%, #2688ff 100%);
      padding: 1.2rem 1.5rem;
      margin: 0;
      min-height: 60px;
      position: relative;
    }
    
    .team-header::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, rgba(255,255,255,0.3) 0%, rgba(255,255,255,0.1) 100%);
    }
    
    .team-label {
      color: #fff;
      font-weight: 700;
      font-size: 1.3rem;
      letter-spacing: 0.5px;
      text-shadow: 0 1px 2px rgba(0,0,0,0.2);
      flex-shrink: 0;
    }
    
    .team-header select {
      font-size: 1.1rem;
      border-radius: 10px;
      border: none;
      padding: 0.6rem 1.3rem;
      font-weight: 600;
      background: rgba(255,255,255,0.95);
      color: #0a174e;
      box-shadow: 0 3px 12px rgba(0,0,0,0.15);
      transition: all 0.3s ease;
      flex: 1;
      backdrop-filter: blur(10px);
    }
    
    .team-header select:hover {
      background: #fff;
      box-shadow: 0 5px 20px rgba(0,0,0,0.2);
      transform: translateY(-1px);
    }
    
    .remove-team-btn {
      background: rgba(255,255,255,0.15);
      color: #fff;
      border: none;
      font-size: 1.4rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      padding: 0.5rem;
      border-radius: 8px;
      opacity: 0.8;
      backdrop-filter: blur(10px);
    }
    
    .remove-team-btn:hover { 
      background: rgba(255,107,107,0.9);
      opacity: 1;
      transform: scale(1.1);
    }
    
    /* MODERN PLAYERS LIST */
    .players-list {
      list-style: none;
      padding: 1.5rem;
      margin: 0;
      display: flex;
      flex-direction: column;
      gap: 0.8rem;
      background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
      min-height: 200px;
    }
    
    .players-list li {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem 1.2rem;
      background: #fff;
      border-radius: 16px;
      font-size: 1.05rem;
      box-shadow: 0 2px 12px rgba(0,87,231,0.08);
      position: relative;
      transition: all 0.3s ease;
      cursor: pointer;
      border: 2px solid transparent;
      overflow: hidden;
    }
    
    .players-list li::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, #0057e7 0%, #2688ff 100%);
      transform: scaleX(0);
      transition: transform 0.3s ease;
    }
    
    .players-list li.selected::before,
    .players-list li:hover::before {
      transform: scaleX(1);
    }
    
    .players-list li.selected,
    .players-list li:hover {
      background: linear-gradient(135deg, #e6f0ff 0%, #f0f7ff 100%);
      box-shadow: 0 6px 24px rgba(0,87,231,0.2);
      transform: translateY(-2px);
      border-color: rgba(0,87,231,0.3);
    }
    
    .player-avatar {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      background: linear-gradient(135deg, #0057e7 0%, #2688ff 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1em;
      font-weight: 700;
      color: #fff;
      flex-shrink: 0;
      box-shadow: 0 4px 12px rgba(0,87,231,0.3);
      border: 3px solid #fff;
      letter-spacing: 0.5px;
      text-transform: uppercase;
      position: relative;
      overflow: hidden;
    }
    
    .player-avatar::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.3) 50%, transparent 70%);
      transform: rotate(45deg);
      transition: all 0.6s ease;
      opacity: 0;
    }
    
    .players-list li:hover .player-avatar::after {
      opacity: 1;
      animation: shimmer 1.5s ease-in-out;
    }
    
    @keyframes shimmer {
      0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
      100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
    }
    
    .players-list input[type=checkbox] {
      margin-right: 0.3em;
      accent-color: #0057e7;
      cursor: pointer;
      width: 1.3em; 
      height: 1.3em;
      border-radius: 6px;
      border: 2px solid #0057e7;
      box-shadow: 0 2px 8px rgba(0,87,231,0.2);
      transition: all 0.3s ease;
      flex-shrink: 0;
    }
    
    .players-list input[type=checkbox]:checked {
      transform: scale(1.1);
      box-shadow: 0 4px 16px rgba(0,87,231,0.4);
    }
    
    .players-list label {
      flex: 1;
      cursor: pointer;
      font-weight: 600;
      letter-spacing: 0.3px;
      color: #1e293b;
      transition: color 0.3s ease;
      min-width: 0; /* Allow text to shrink */
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    
    .players-list li:hover label {
      color: #0057e7;
    }
    
    .players-list .salary-cell {
      color: #0057e7;
      min-width: 85px;
      width: 85px;
      text-align: right;
      font-weight: 700;
      font-size: 0.95rem;
      letter-spacing: 0.3px;
      padding: 0.4rem 0.6rem;
      background: rgba(0,87,231,0.1);
      border-radius: 8px;
      transition: all 0.3s ease;
      flex-shrink: 0;
      font-family: 'Courier New', monospace;
    }
    
    .players-list li:hover .salary-cell {
      background: rgba(0,87,231,0.2);
      transform: scale(1.05);
    }
    
    .totals {
      margin: 0;
      font-weight: 700;
      font-size: 1.2rem;
      color: #1e293b;
      text-align: center;
      padding: 1rem 1.5rem;
      background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
      border-top: 1px solid rgba(0,87,231,0.1);
    }
    
    /* MODERN PAYROLL BOX WITH SPACE CALCULATIONS */
    .payroll-box {
      margin: 0;
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
      padding: 1.5rem;
      font-size: 0.95rem;
      color: #fff;
      position: relative;
      overflow: hidden;
    }
    
    .payroll-box::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, #0057e7 0%, #2688ff 50%, #0057e7 100%);
    }
    
    .payroll-line {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.7rem;
      padding: 0.5rem 0;
      border-bottom: 1px solid rgba(255,255,255,0.1);
      transition: all 0.3s ease;
    }
    
    .payroll-line:last-child {
      border-bottom: none;
      margin-bottom: 0;
      font-weight: 700;
      font-size: 1.05rem;
      background: rgba(255,255,255,0.05);
      border-radius: 8px;
      padding: 0.8rem;
    }
    
    .payroll-line:hover {
      background: rgba(255,255,255,0.05);
      border-radius: 8px;
      padding-left: 0.8rem;
      padding-right: 0.8rem;
    }
    
    .payroll-label {
      font-weight: 600;
      color: rgba(255,255,255,0.9);
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.9rem;
    }
    
    .payroll-value {
      font-weight: 700;
      font-family: 'Courier New', monospace;
      letter-spacing: 0.5px;
      font-size: 0.9rem;
    }
    
    .payroll-value.over {
      color: #ef4444;
      text-shadow: 0 0 8px rgba(239,68,68,0.5);
    }
    
    .payroll-value.under {
      color: #22c55e;
      text-shadow: 0 0 8px rgba(34,197,94,0.5);
    }
    
    .payroll-value.close {
      color: #f59e0b;
      text-shadow: 0 0 8px rgba(245,158,11,0.5);
    }
    
    /* STATUS INDICATORS */
    .status-indicator {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      display: inline-block;
      margin-right: 0.5rem;
    }
    
    .status-indicator.over {
      background: #ef4444;
      box-shadow: 0 0 8px rgba(239,68,68,0.6);
    }
    
    .status-indicator.under {
      background: #22c55e;
      box-shadow: 0 0 8px rgba(34,197,94,0.6);
    }
    
    .status-indicator.close {
      background: #f59e0b;
      box-shadow: 0 0 8px rgba(245,158,11,0.6);
    }
    
    /* TRADE RESTRICTIONS ALERT */
    .trade-restrictions {
      background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
      border: 2px solid #f59e0b;
      border-radius: 12px;
      padding: 1rem;
      margin: 1rem 0;
      color: #92400e;
      font-size: 0.9rem;
      font-weight: 600;
    }
    
    .trade-restrictions.severe {
      background: linear-gradient(135deg, #fecaca 0%, #fca5a5 100%);
      border-color: #ef4444;
      color: #991b1b;
    }
    
    .trade-restrictions h4 {
      margin: 0 0 0.5rem 0;
      font-size: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .trade-restrictions ul {
      margin: 0.5rem 0 0 0;
      padding-left: 1.2rem;
    }
    
    .trade-restrictions li {
      margin-bottom: 0.3rem;
    }
    
    /* TRADE RESULT MODAL */
    .trade-modal {
      display: none;
      position: fixed;
      z-index: 2000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(5px);
      animation: modalFadeIn 0.3s ease;
    }
    
    @keyframes modalFadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    .modal-content {
      background: #fff;
      margin: 2% auto;
      padding: 0;
      border-radius: 20px;
      width: 96%;
      max-width: 1200px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      animation: modalSlideIn 0.4s ease;
      overflow: hidden;
      max-height: 96vh;
      overflow-y: auto;
    }
    
    @keyframes modalSlideIn {
      from { transform: translateY(-50px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    
    .modal-header {
      padding: 1.5rem 2rem;
      background: linear-gradient(135deg, #0057e7 0%, #2688ff 100%);
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .modal-header.success {
      background: linear-gradient(135deg, #10b981 0%, #34d399 100%);
    }
    
    .modal-header.failed {
      background: linear-gradient(135deg, #dc2626 0%, #ef4444 100%);
    }
    
    .modal-title {
      font-size: 1.5rem;
      font-weight: 700;
      margin: 0;
      text-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }
    
    .close-btn {
      background: none;
      border: none;
      color: white;
      font-size: 1.8rem;
      cursor: pointer;
      padding: 0.2rem;
      border-radius: 4px;
      transition: background 0.2s ease;
    }
    
    .close-btn:hover {
      background: rgba(255, 255, 255, 0.2);
    }
    
    .modal-body {
      padding: 2rem;
    }
    
    .trade-summary {
      display: flex;
      justify-content: space-between;
      gap: 2rem;
      margin-bottom: 1.5rem;
    }
    
    .team-summary {
      flex: 1;
      background: #f8fafc;
      border-radius: 12px;
      padding: 1.2rem;
      border: 2px solid #e4eaf2;
    }
    
    .team-summary h4 {
      margin: 0 0 1rem 0;
      color: #0a174e;
      font-size: 1.2rem;
      font-weight: 700;
    }
    
    .player-item {
      display: flex;
      align-items: center;
      gap: 0.8rem;
      margin-bottom: 0.8rem;
      padding: 0.6rem;
      background: white;
      border-radius: 8px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.05);
    }
    
    .player-item:last-child {
      margin-bottom: 0;
    }
    
    .player-item .player-avatar {
      width: 32px;
      height: 32px;
      font-size: 0.9rem;
    }
    
    .player-name {
      flex: 1;
      font-weight: 600;
      color: #273a58;
    }
    
    .player-salary {
      color: #0057e7;
      font-weight: 700;
      font-size: 0.95rem;
    }
    
    .error-message {
      background: #fef2f2;
      border: 2px solid #fecaca;
      border-radius: 12px;
      padding: 1.2rem;
      color: #dc2626;
      font-weight: 600;
      text-align: center;
      margin-top: 1rem;
    }
    
    .success-message {
      background: #f0fdf4;
      border: 2px solid #bbf7d0;
      border-radius: 12px;
      padding: 1.2rem;
      color: #16a34a;
      font-weight: 600;
      text-align: center;
      margin-top: 1rem;
    }
    
    /* SOCIAL MEDIA SHARING STYLES */
    .social-sharing {
      margin-top: 2rem;
      padding: 1.5rem;
      background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      border-radius: 12px;
      border: 1px solid var(--border-color);
    }
    
    .social-sharing h4 {
      margin: 0 0 1rem 0;
      color: var(--text-primary);
      font-size: 1.1rem;
      font-weight: 700;
      text-align: center;
    }
    
    .social-buttons {
      display: flex;
      justify-content: center;
      gap: 1rem;
      flex-wrap: wrap;
    }
    
    .social-btn {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1.25rem;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 600;
      font-size: 0.9rem;
      transition: all 0.3s ease;
      border: none;
      cursor: pointer;
      min-width: 120px;
      justify-content: center;
    }
    
    .social-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }
    
    .social-btn.twitter {
      background: #1da1f2;
      color: white;
    }
    
    .social-btn.twitter:hover {
      background: #1a91da;
    }
    
    .social-btn.facebook {
      background: #4267b2;
      color: white;
    }
    
    .social-btn.facebook:hover {
      background: #365899;
    }
    
    .social-btn.reddit {
      background: #ff4500;
      color: white;
    }
    
    .social-btn.reddit:hover {
      background: #e03d00;
    }
    
    .social-btn.copy {
      background: var(--secondary-color);
      color: white;
    }
    
    .social-btn.copy:hover {
      background: var(--primary-color);
    }
    
    .social-btn.copy.copied {
      background: var(--success-color);
    }
    
    .social-btn.image {
      background: #6f42c1;
      color: white;
    }
    
    .social-btn.image:hover {
      background: #5a2d91;
    }
    
    .social-btn.image.generating {
      background: var(--warning-color);
      cursor: wait;
    }
    
    .social-btn i {
      font-size: 1.1rem;
    }
    
    /* RESPONSIVE IMPROVEMENTS */
    @media (max-width: 768px) {
      body {
        padding-top: 70px;
      }

      h1 {
        font-size: 2.5rem;
      }

      .hero-subtitle {
        font-size: 1rem;
      }

      .description-block {
        margin: 1.5rem;
        padding: 1.5rem;
        font-size: 1rem;
      }

      .trade-controls {
        margin: 1.5rem 0 2rem 0;
        gap: 0.75rem;
      }

      .trade-controls button {
        padding: 0.875rem 1.5rem;
        font-size: 0.9rem;
        min-width: 120px;
      }

      .trade-container {
        grid-template-columns: 1fr;
        gap: 1.5rem;
        padding: 0 1rem;
      }
      
      .modal-content {
        width: 95%;
        margin: 5% auto;
      }
      
      .trade-summary {
        flex-direction: column;
        gap: 1rem;
      }
      
      .players-list li {
        padding: 0.8rem 1rem;
        gap: 0.8rem;
      }
      
      .player-avatar {
        width: 36px;
        height: 36px;
      }
      
      .salary-cell {
        min-width: 75px;
        width: 75px;
        font-size: 0.85rem;
      }
      
      .payroll-line {
        font-size: 0.85rem;
      }
    }
  </style>
</head>
<body>
  <!-- NAVIGATION BAR - EXACT SAME AS CONTACT PAGE -->
  <nav class="navbar">
    <div class="nav-left">
      <img src="sixershoopslogo.png" alt="SixersHoops Logo" class="nav-logo" />
      <span class="site-title">SixersHoops</span>
    </div>
    <button class="hamburger" aria-label="Menu" aria-expanded="false">
      <span></span>
      <span></span>
      <span></span>
    </button>
    <div class="nav-right">
      <a href="/home" class="nav-link">Home</a>
      <div class="nav-dropdown">
        <button class="nav-action dropdown-btn" aria-haspopup="true" aria-expanded="false">Cap & Draft Management</button>
        <div class="dropdown-content">
          <a href="/salary" class="dropdown-link">Salary Breakdown</a>
          <a href="/draft" class="dropdown-link">Future Draft Capital</a>
          <a href="/depth" class="dropdown-link">Depth Chart</a>
        </div>
      </div>
      <a href="/nba-trade-machine" class="nav-link active">Trade Machine</a>
      <a href="/contact" class="nav-link">Contact Us</a>
    </div>
  </nav>

  <!-- HERO SECTION -->
  <div class="hero-section">
    <h1>NBA Trade Machine</h1>
    <p class="hero-subtitle">Professional Edition - Build Perfect Trades with Advanced Analytics</p>
  </div>
  
  <div class="description-block">
    <strong>Build your perfect trade!</strong> Select players from different teams and see if your trade works under NBA salary cap rules. The machine will automatically calculate 
    <span class="feature-highlight">
      <i class="fas fa-chart-line"></i>
      salary matching
    </span>, 
    <span class="feature-highlight">
      <i class="fas fa-shield-alt"></i>
      apron restrictions
    </span>, and 
    <span class="feature-highlight">
      <i class="fas fa-coins"></i>
      available cap space
    </span>.
  </div>

  <!-- Testing Disclaimer Banner -->
  <div class="testing-disclaimer">
    <div class="disclaimer-title">
      <i class="fas fa-flask"></i>
      Beta Testing Phase
    </div>
    <div class="disclaimer-text">
      This trade machine is currently in testing phases. Player rosters are close to accurate but may not be fully up-to-date. Additional features, roster updates, and enhanced trade validation will be added in future updates. Thank you for your patience as we perfect this tool!
    </div>
  </div>

  <div class="trade-controls">
    <button class="btn-primary" onclick="addTeam()">
      <i class="fas fa-plus"></i>
      Add Team
    </button>
    <button class="btn-success" onclick="executeTrade()">
      <i class="fas fa-exchange-alt"></i>
      Execute Trade
    </button>
    <button class="btn-secondary" onclick="clearTrade()">
      <i class="fas fa-trash-alt"></i>
      Clear All
    </button>
  </div>

  <div class="trade-container" id="tradeContainer">
    <!-- Teams will be added here dynamically -->
  </div>

  <!-- TRADE RESULT MODAL -->
  <div id="tradeModal" class="trade-modal">
    <div class="modal-content">
      <div class="modal-header" id="modalHeader">
        <h2 class="modal-title" id="modalTitle">Trade Result</h2>
        <button class="close-btn" onclick="closeModal()">&times;</button>
      </div>
      <div class="modal-body">
        <div class="trade-summary" id="tradeSummary">
          <!-- Trade summary will be populated here -->
        </div>
        <div id="tradeMessage">
          <!-- Success or error message will be shown here -->
        </div>
        <div id="socialSharing" class="social-sharing" style="display: none; text-align: center; margin-top: 1rem;">
          <button class="export-btn" id="tradeExportBtn" onclick="generateTradeImage()" style="background: linear-gradient(135deg, var(--secondary-color) 0%, var(--accent-color) 100%); color: #fff; font-weight: 600; font-size: 1rem; padding: 1rem 2rem; border-radius: var(--radius-xl); border: none; cursor: pointer; transition: all 0.3s ease; box-shadow: var(--shadow-lg);">
            📸 Export for Social Media
          </button>
          <canvas id="tradeCanvas" style="display: none;" width="1200" height="800"></canvas>
        </div>
      </div>
    </div>
  </div>

  <!-- Export Modal -->
  <div id="tradeExportModal" class="export-modal">
    <div class="export-modal-content">
      <h2 style="color: #0a174e; margin-bottom: 1rem;">Export Trade Result</h2>
      <p style="color: #6c757d; margin-bottom: 1.5rem;">Your trade analysis is ready for social media sharing!</p>
      <canvas id="tradeExportCanvas" style="display: none;"></canvas>
      <img id="tradeExportPreview" class="export-preview" alt="Trade export preview">
      <div class="export-actions">
        <button id="tradeCopyBtn" class="copy-btn">📋 Copy to Clipboard</button>
        <button id="tradeDownloadBtn" class="download-btn">📥 Download Image</button>
        <button id="tradeCloseModal" class="close-btn">✕ Close</button>
      </div>
    </div>
  </div>

  <!-- Bottom Advertisement Row - 5 in a row flat (same as index.html) -->
  <div class="bottom-ads">
    <div class="ad-space">
      <script>
      (function(tnro){
      var d = document,
          s = d.createElement('script'),
          l = d.scripts[d.scripts.length - 1];
      s.settings = tnro || {};
      s.src = "\/\/grimy-bicycle.com\/bLXgVos\/d.Gglg0SYlWdcT\/Kevmz9IuPZCUWl\/kCPWTqYV1JNrT\/YKxSOVDOcWtXNdjxU\/1dNIjlE\/4EOhA_";
      s.async = true;
      s.referrerPolicy = 'no-referrer-when-downgrade';
      l.parentNode.insertBefore(s, l);
      })({})
      </script>
    </div>
    <div class="ad-space">
      <script>
      (function(yfxbc){
      var d = document,
          s = d.createElement('script'),
          l = d.scripts[d.scripts.length - 1];
      s.settings = yfxbc || {};
      s.src = "\/\/grimy-bicycle.com\/bOXqVvsSd.GFl\/0TYsWEcZ\/Levmd9\/uLZHUGlpkiPJTPYp1\/NeT\/Y-xZOOTGcgtINljhUo1IN\/j\/Ez5NOeAW";
      s.async = true;
      s.referrerPolicy = 'no-referrer-when-downgrade';
      l.parentNode.insertBefore(s, l);
      })({})
      </script>
    </div>
    <div class="ad-space">
      <script>
      (function(lsadao){
      var d = document,
          s = d.createElement('script'),
          l = d.scripts[d.scripts.length - 1];
      s.settings = lsadao || {};
      s.src = "\/\/grimy-bicycle.com\/bUXHV.sFduG\/lp0yYCWvcl\/ceQmU9\/urZYUTlTkWPWTYY_1fNeTNYayPMcDLcdtJNSj\/Uw1pNzj-IKwGOyAw";
      s.async = true;
      s.referrerPolicy = 'no-referrer-when-downgrade';
      l.parentNode.insertBefore(s, l);
      })({})
      </script>
    </div>
    <div class="ad-space">
      <script>
      (function(ugfujh){
      var d = document,
          s = d.createElement('script'),
          l = d.scripts[d.scripts.length - 1];
      s.settings = ugfujh || {};
      s.src = "\/\/grimy-bicycle.com\/byXwV.sFdnGNlh0QYDWdcW\/SeQm-9KuaZ\/UFlkkmPcTiYK1\/NLTFYByyMuT_cQtDNKjMUc1yNgj-IHxSOXAU";
      s.async = true;
      s.referrerPolicy = 'no-referrer-when-downgrade';
      l.parentNode.insertBefore(s, l);
      })({})
      </script>
    </div>
    <div class="ad-space">
      <script>
      (function(hno){
      var d = document,
          s = d.createElement('script'),
          l = d.scripts[d.scripts.length - 1];
      s.settings = hno || {};
      s.src = "\/\/grimy-bicycle.com\/byXpVisxd.G\/lh0ZYkWocm\/NeLm_9buNZ\/UOlwkbP-T\/Yi1UN\/TIYIyiMljscjt\/NyjCU\/1hNtj\/Iay\/O\/AZ";
      s.async = true;
      s.referrerPolicy = 'no-referrer-when-downgrade';
      l.parentNode.insertBefore(s, l);
      })({})
      </script>
    </div>
  </div>

  <script>
    // Updated NBA teams and players data for 2024-25 season
    const nbaTeams = {
  'Atlanta Hawks': [
    {name: 'Trae Young', salary: 45999660},
    {name: 'Kristaps Porziņģis', salary: 30731707},
    {name: 'Jalen Johnson', salary: 30000000},
    {name: 'Nickeil Alexander-Walker', salary: 15161800},
    {name: 'Onyeka Okongwu', salary: 15000000},
    {name: 'Zaccharie Risacher', salary: 13197720},
    {name: 'Luke Kennard', salary: 11000000},
    {name: 'Dyson Daniels', salary: 7707709},
    {name: 'Kobe Bufkin', salary: 4503720},
    {name: 'Asa Newell', salary: 3237480},
    {name: 'Vít Krejčí', salary: 2349578},
    {name: 'Caleb Houstan', salary: 2296274},
    {name: 'Mouhamed Gueye', salary: 2221677},
    {name: 'Nikola Đurišić', salary: 1272870}
  ],
  'Boston Celtics': [
    {name: 'Jayson Tatum', salary: 54126450},
    {name: 'Jaylen Brown', salary: 53142264},
    {name: 'Derrick White', salary: 27750000},
    {name: 'Anfernee Simons', salary: 27678571},
    {name: 'Sam Hauser', salary: 10044644},
    {name: 'Georges Niang', salary: 8200000},
    {name: 'Payton Pritchard', salary: 7232143},
    {name: 'Hugo González', salary: 2783880},
    {name: 'Baylor Scheierman', salary: 2619000},
    {name: 'Xavier Tillman', salary: 2546674},
    {name: 'Luka Garza', salary: 2461463},
    {name: 'Josh Minott', salary: 2378870},
    {name: 'Neemias Queta', salary: 2349578},
    {name: 'Jordan Walsh', salary: 2221677}
  ],
  'Brooklyn Nets': [
    {name: 'Michael Porter Jr.', salary: 38333050},
    {name: 'Nicolas Claxton', salary: 25352272},
    {name: 'Terance Mann', salary: 15500000},
    {name: 'Egor Demin', salary: 6889200},
    {name: 'Day\'Ron Sharpe', salary: 6000000},
    {name: 'Ziaire Williams', salary: 6000000},
    {name: 'Nolan Traoré', salary: 3811560},
    {name: 'Noah Clowney', salary: 3398640},
    {name: 'Dariq Whitehead', salary: 3262560},
    {name: 'Drake Powell', salary: 3372240},
    {name: 'Ben Saraf', salary: 2884560},
    {name: 'Danny Wolf', salary: 2801280},
    {name: 'Keon Johnson', salary: 2349578},
    {name: 'Jalen Wilson', salary: 2221677},
    {name: 'Tyrese Martin', salary: 2191897},
    {name: 'Drew Timme', salary: 1955378}
  ],
  'Charlotte Hornets': [
    {name: 'LaMelo Ball', salary: 37958760},
    {name: 'Miles Bridges', salary: 25000000},
    {name: 'Collin Sexton', salary: 18975000},
    {name: 'Josh Green', salary: 13666666},
    {name: 'Grant Williams', salary: 13645500},
    {name: 'Brandon Miller', salary: 11968800},
    {name: 'Kon Knueppel', salary: 10015680},
    {name: 'Pat Connaughton', salary: 9423860},
    {name: 'Tre Mann', salary: 8000000},
    {name: 'Tidjane Salaün', salary: 7863240},
    {name: 'Liam McNeeley', salary: 2763960},
    {name: 'DaQuan Jeffries', salary: 2743770},
    {name: 'Nick Smith Jr.', salary: 2710680},
    {name: 'Spencer Dinwiddie', salary: 2296270},
    {name: 'Sion James', salary: 2296270},
    {name: 'Ryan Kalkbrenner', salary: 2296270},
    {name: 'Mason Plumlee', salary: 2296270},
    {name: 'Mousa Diabate', salary: 2270730}
  ],
  'Chicago Bulls': [
    {name: 'Nikola Vučević', salary: 21481481},
    {name: 'Zach Collins', salary: 18080496},
    {name: 'Patrick Williams', salary: 18000000},
    {name: 'Kevin Huerter', salary: 17991071},
    {name: 'Coby White', salary: 12888889},
    {name: 'Isaac Okoro', salary: 11000000},
    {name: 'Jalen Smith', salary: 9000000},
    {name: 'Tre Jones', salary: 8000000},
    {name: 'Ayo Dosunmu', salary: 7518518},
    {name: 'Jevon Carter', salary: 6809524},
    {name: 'Matas Buzelis', salary: 5455560},
    {name: 'Noa Essengue', salary: 5429520},
    {name: 'Dalen Terry', salary: 5399118},
    {name: 'Julian Phillips', salary: 2221677}
  ],
  'Cleveland Cavaliers': [
    {name: 'Donovan Mitchell', salary: 46394100},
    {name: 'Evan Mobley', salary: 46394100},
    {name: 'Darius Garland', salary: 39446090},
    {name: 'DeAndre Hunter', salary: 23303571},
    {name: 'Jarrett Allen', salary: 20000000},
    {name: 'Max Strus', salary: 15936452},
    {name: 'Lonzo Ball', salary: 10000000},
    {name: 'Sam Merrill', salary: 8482144},
    {name: 'Dean Wade', salary: 6623456},
    {name: 'Jaylon Tyson', salary: 3492480},
    {name: 'Larry Nance Jr.', salary: 2296274},
    {name: 'Craig Porter Jr.', salary: 2221677},
    {name: 'Tyrese Proctor', salary: 1272870}
  ],
  'Dallas Mavericks': [
    {name: 'Anthony Davis', salary: 54126450},
    {name: 'Kyrie Irving', salary: 36566002},
    {name: 'Klay Thompson', salary: 16666667},
    {name: 'Daniel Gafford', salary: 14386320},
    {name: 'P.J. Washington', salary: 14152174},
    {name: 'Cooper Flagg', salary: 13825920},
    {name: 'Caleb Martin', salary: 9594044},
    {name: 'Naji Marshall', salary: 9000000},
    {name: 'Max Christie', salary: 7714286},
    {name: 'Jaden Hardy', salary: 6000000},
    {name: 'D\'Angelo Russell', salary: 5685000},
    {name: 'Dereck Lively II', salary: 5253360},
    {name: 'Dwight Powell', salary: 4000000},
    {name: 'Olivier-Maxence Prosper', salary: 3007080},
    {name: 'Dante Exum', salary: 2296274},
    {name: 'Brandon Williams', salary: 2270735}
  ],
  'Denver Nuggets': [
    {name: 'Nikola Jokić', salary: 55224520},
    {name: 'Jamal Murray', salary: 46394100},
    {name: 'Aaron Gordon', salary: 22841450},
    {name: 'Cameron Johnson', salary: 21057060},
    {name: 'Jonas Valančiūnas', salary: 10395000},
    {name: 'Zeke Nnaji', salary: 8177770},
    {name: 'Christian Braun', salary: 4921790},
    {name: 'Peyton Watson', salary: 4356470},
    {name: 'DaRon Holmes', salary: 3218760},
    {name: 'Julian Strawther', salary: 2674200},
    {name: 'Bruce Brown', salary: 2296270},
    {name: 'Tim Hardaway Jr.', salary: 2296270},
    {name: 'Jalen Pickett', salary: 2221670},
    {name: 'Hunter Tyson', salary: 2221670}
  ],
  'Detroit Pistons': [
    {name: 'Cade Cunningham', salary: 46394100},
    {name: 'Tobias Harris', salary: 26634147},
    {name: 'Duncan Robinson', salary: 16834692},
    {name: 'Isaiah Stewart', salary: 15000000},
    {name: 'Caris LeVert', salary: 14104000},
    {name: 'Jaden Ivey', salary: 10107163},
    {name: 'Ausar Thompson', salary: 8775000},
    {name: 'Ron Holland', salary: 8657280},
    {name: 'Jalen Duren', salary: 6483144},
    {name: 'Paul Reed', salary: 5335894},
    {name: 'Marcus Sasser', salary: 2886720},
    {name: 'Bobi Klintman', salary: 1955378},
    {name: 'Chaz Lanier', salary: 1372870}
  ],
  'Golden State Warriors': [
    {name: 'Stephen Curry', salary: 59606817},
    {name: 'Jimmy Butler', salary: 54126450},
    {name: 'Draymond Green', salary: 25892857},
    {name: 'Moses Moody', salary: 11574075},
    {name: 'Buddy Hield', salary: 9219512},
    {name: 'Brandin Podziemski', salary: 3687960},
    {name: 'Trayce Jackson-Davis', salary: 2221677},
    {name: 'Gui Santos', salary: 2221677},
    {name: 'Quinten Post', salary: 1955378}
  ],
  'Houston Rockets': [
    {name: 'Kevin Durant', salary: 54708609},
    {name: 'Alperen Şengün', salary: 33944954},
    {name: 'Fred VanVleet', salary: 25000000},
    {name: 'Steven Adams', salary: 14130434},
    {name: 'Dorian Finney-Smith', salary: 12700000},
    {name: 'Jabari Smith Jr.', salary: 12350392},
    {name: 'Reed Sheppard', salary: 10603560},
    {name: 'Amen Thompson', salary: 9690600},
    {name: 'Clint Capela', salary: 6700000},
    {name: 'Tari Eason', salary: 5675766},
    {name: 'Jeff Green', salary: 2296274},
    {name: 'Aaron Holiday', salary: 2296274},
    {name: 'Josh Okogie', salary: 2296274},
    {name: 'Jae\'Sean Tate', salary: 2296274}
  ],
  'Indiana Pacers': [
    {name: 'Tyrese Haliburton', salary: 45550512},
    {name: 'Pascal Siakam', salary: 45550512},
    {name: 'Andrew Nembhard', salary: 18102000},
    {name: 'Obi Toppin', salary: 14000000},
    {name: 'Aaron Nesmith', salary: 11000000},
    {name: 'T.J. McConnell', salary: 10200000},
    {name: 'Bennedict Mathurin', salary: 9187573},
    {name: 'Isaiah Jackson', salary: 7600000},
    {name: 'Jarace Walker', salary: 6665520},
    {name: 'Tony Bradley', salary: 2940876},
    {name: 'Ben Sheppard', salary: 2790720},
    {name: 'James Wiseman', salary: 2667947},
    {name: 'Jay Huff', salary: 2349578},
    {name: 'Johnny Furphy', salary: 1955378},
    {name: 'Kam Jones', salary: 1272870}
  ],
  'Los Angeles Clippers': [
    {name: 'Kawhi Leonard', salary: 50000000},
    {name: 'James Harden', salary: 39182693},
    {name: 'John Collins', salary: 26580000},
    {name: 'Ivica Zubac', salary: 18102000},
    {name: 'Bogdan Bogdanović', salary: 16020000},
    {name: 'Derrick Jones Jr.', salary: 10000000},
    {name: 'Brook Lopez', salary: 8750000},
    {name: 'Nicolas Batum', salary: 5601600},
    {name: 'Kris Dunn', salary: 5426400},
    {name: 'Bradley Beal', salary: 5354000},
    {name: 'Yanic Konan Niederhauser', salary: 2743800},
    {name: 'Kobe Brown', salary: 2654880},
    {name: 'Chris Paul', salary: 2296274},
    {name: 'Cam Christie', salary: 1955378}
  ],
  'Los Angeles Lakers': [
    {name: 'LeBron James', salary: 52627153},
    {name: 'Luka Dončić', salary: 45999660},
    {name: 'Rui Hachimura', salary: 18259259},
    {name: 'Austin Reaves', salary: 13937574},
    {name: 'Jarred Vanderbilt', salary: 11571429},
    {name: 'Gabe Vincent', salary: 11500000},
    {name: 'Maxi Kleber', salary: 11000000},
    {name: 'Deandre Ayton', salary: 8104000},
    {name: 'Jake LaRavia', salary: 6000000},
    {name: 'Marcus Smart', salary: 5134000},
    {name: 'Dalton Knecht', salary: 4010160},
    {name: 'Jaxson Hayes', salary: 3449323},
    {name: 'Bronny James', salary: 1955378},
    {name: 'Adou Thiero', salary: 1272870}
  ],
  'Memphis Grizzlies': [
    {name: 'Ja Morant', salary: 39446090},
    {name: 'Jaren Jackson Jr.', salary: 35000000},
    {name: 'Kentavious Caldwell-Pope', salary: 21621500},
    {name: 'Santi Aldama', salary: 18485916},
    {name: 'Brandon Clarke', salary: 12500000},
    {name: 'Ty Jerome', salary: 8781000},
    {name: 'John Konchar', salary: 6165000},
    {name: 'Zach Edey', salary: 6045000},
    {name: 'Cedric Coward', salary: 5715120},
    {name: 'Cam Spencer', salary: 2537989},
    {name: 'Vince Williams Jr.', salary: 2301587},
    {name: 'Jock Landale', salary: 2296274},
    {name: 'Scotty Pippen Jr.', salary: 2270735},
    {name: 'GG Jackson', salary: 2221677},
    {name: 'Jaylen Wells', salary: 1955378}
  ],
  'Miami Heat': [
    {name: 'Bam Adebayo', salary: 37096620},
    {name: 'Tyler Herro', salary: 31000000},
    {name: 'Andrew Wiggins', salary: 28223210},
    {name: 'Terry Rozier', salary: 26643030},
    {name: 'Norman Powell', salary: 20482750},
    {name: 'Davion Mitchell', salary: 11600000},
    {name: 'Simone Fontecchio', salary: 8307690},
    {name: 'Haywood Highsmith', salary: 5616000},
    {name: 'Nikola Jović', salary: 4445410},
    {name: 'Kel\'el Ware', salary: 4443360},
    {name: 'Jaime Jaquez Jr.', salary: 3861600},
    {name: 'Kasparas Jakučionis', salary: 3658800},
    {name: 'Keshad Johnson', salary: 1955378},
    {name: 'Pelle Larsson', salary: 1955378}
  ],
  'Milwaukee Bucks': [
    {name: 'Giannis Antetokounmpo', salary: 54126450},
    {name: 'Myles Turner', salary: 25318251},
    {name: 'Kyle Kuzma', salary: 22410605},
    {name: 'Bobby Portis', salary: 13445754},
    {name: 'Kevin Porter Jr.', salary: 5134000},
    {name: 'Ryan Rollins', salary: 4000000},
    {name: 'Gary Trent Jr.', salary: 3697105},
    {name: 'Gary Harris', salary: 3634153},
    {name: 'Taurean Prince', salary: 3303774},
    {name: 'Jericho Sims', salary: 2461463},
    {name: 'A.J. Green', salary: 2301587},
    {name: 'Cole Anthony', salary: 2296274},
    {name: 'Chris Livingston', salary: 2296274},
    {name: 'Andre Jackson Jr.', salary: 2221677},
    {name: 'Tyler Smith', salary: 1955378}
  ],
  'Minnesota Timberwolves': [
    {name: 'Anthony Edwards', salary: 45550512},
    {name: 'Rudy Gobert', salary: 35000000},
    {name: 'Julius Randle', salary: 30864198},
    {name: 'Jaden McDaniels', salary: 24393103},
    {name: 'Naz Reid', salary: 21551724},
    {name: 'Donte DiVincenzo', salary: 11990000},
    {name: 'Mike Conley Jr.', salary: 10774038},
    {name: 'Rob Dillingham', salary: 6576120},
    {name: 'Joan Beringer', salary: 4201080},
    {name: 'Terrence Shannon Jr.', salary: 2674080},
    {name: 'Joe Ingles', salary: 2296274},
    {name: 'Leonard Miller', salary: 2221677},
    {name: 'Jaylen Clark', salary: 2191897}
  ],
  'New Orleans Pelicans': [
    {name: 'Zion Williamson', salary: 39446090},
    {name: 'Jordan Poole', salary: 31848210},
    {name: 'Dejounte Murray', salary: 30801130},
    {name: 'Trey Murphy III', salary: 25000000},
    {name: 'Herb Jones', salary: 13937570},
    {name: 'Kevon Looney', salary: 8000000},
    {name: 'Jeremiah Fears', salary: 7520040},
    {name: 'Saddiq Bey', salary: 6118640},
    {name: 'Derik Queen', salary: 5157960},
    {name: 'Jordan Hawkins', salary: 4741320},
    {name: 'Jose Alvarado', salary: 4500000},
    {name: 'Yves Missi', salary: 3353040},
    {name: 'Karlo Matković', salary: 1955378},
    {name: 'Micah Peavy', salary: 1272870}
  ],
  'New York Knicks': [
    {name: 'Karl-Anthony Towns', salary: 53142264},
    {name: 'OG Anunoby', salary: 39568960},
    {name: 'Jalen Brunson', salary: 34944000},
    {name: 'Mikal Bridges', salary: 24900000},
    {name: 'Josh Hart', salary: 19472240},
    {name: 'Mitchell Robinson', salary: 12954540},
    {name: 'Guerschon Yabusele', salary: 5500000},
    {name: 'Miles McBride', salary: 4333330},
    {name: 'Pacôme Dadiet', salary: 2847600},
    {name: 'Jordan Clarkson', salary: 2296274},
    {name: 'Tyler Kolek', salary: 2191897},
    {name: 'Ariel Hukporti', salary: 1955378}
  ],
  'Oklahoma City Thunder': [
    {name: 'Shai Gilgeous-Alexander', salary: 38333050},
    {name: 'Isaiah Hartenstein', salary: 28500000},
    {name: 'Luguentz Dort', salary: 18222222},
    {name: 'Alex Caruso', salary: 18102000},
    {name: 'Chet Holmgren', salary: 13731368},
    {name: 'Isaiah Joe', salary: 12362338},
    {name: 'Aaron Wiggins', salary: 9672897},
    {name: 'Jaylin Williams', salary: 8450000},
    {name: 'Kenrich Williams', salary: 7163000},
    {name: 'Ousmane Dieng', salary: 6670882},
    {name: 'Jalen Williams', salary: 6580997},
    {name: 'Cason Wallace', salary: 5820240},
    {name: 'Nikola Topić', salary: 5182920},
    {name: 'Thomas Sorber', salary: 4655040},
    {name: 'Ajay Mitchell', salary: 3000000}
  ],
  'Orlando Magic': [
    {name: 'Franz Wagner', salary: 38661750},
    {name: 'Desmond Bane', salary: 36725670},
    {name: 'Jalen Suggs', salary: 35000000},
    {name: 'Paolo Banchero', salary: 15334769},
    {name: 'Jonathan Isaac', salary: 15000000},
    {name: 'Wendell Carter Jr.', salary: 10850000},
    {name: 'Goga Bitadze', salary: 8333333},
    {name: 'Anthony Black', salary: 7970280},
    {name: 'Tyus Jones', salary: 7000000},
    {name: 'Jett Howard', salary: 5529720},
    {name: 'Moe Wagner', salary: 5000000},
    {name: 'Tristan da Silva', salary: 3809520},
    {name: 'Jase Richardson', salary: 2983320},
    {name: 'Noah Penda', salary: 1272870}
  ],
  'Philadelphia 76ers': [
    {name: 'Joel Embiid', salary: 55224520},
    {name: 'Paul George', salary: 51666090},
    {name: 'Tyrese Maxey', salary: 37958760},
    {name: 'VJ Edgecombe', salary: 11108880},
    {name: 'Kelly Oubre Jr.', salary: 8382150},
    {name: 'Andre Drummond', salary: 5000000},
    {name: 'Jared McCain', salary: 4221360},
    {name: 'Trendon Watford', salary: 2461460},
    {name: 'Eric Gordon', salary: 2296274},
    {name: 'Kyle Lowry', salary: 2296274},
    {name: 'Ricky Council IV', salary: 2221677},
    {name: 'Justin Edwards', salary: 2048490},
    {name: 'Adem Bona', salary: 1955378},
    {name: 'Johni Broome', salary: 1272870}
  ],
  'Phoenix Suns': [
    {name: 'Devin Booker', salary: 53142264},
    {name: 'Jalen Green', salary: 33584490},
    {name: 'Dillon Brooks', salary: 21124110},
    {name: 'Grayson Allen', salary: 16875000},
    {name: 'Royce O\'Neale', salary: 10125000},
    {name: 'Mark Williams', salary: 6276530},
    {name: 'Khaman Maluach', salary: 6016080},
    {name: 'Nick Richards', salary: 5000000},
    {name: 'Ryan Dunn', salary: 2657760},
    {name: 'Jordan Goodwin', salary: 2349578},
    {name: 'Jared Butler', salary: 2296274},
    {name: 'Collin Gillespie', salary: 2296274},
    {name: 'Nigel Hayes-Davis', salary: 2048490},
    {name: 'Oso Ighodaro', salary: 1955378},
    {name: 'Rasheer Fleming', salary: 1272870}
  ],
  'Portland Trail Blazers': [
    {name: 'Jrue Holiday', salary: 32400000},
    {name: 'Jerami Grant', salary: 32000001},
    {name: 'Deni Avdija', salary: 14375000},
    {name: 'Damian Lillard', salary: 14104000},
    {name: 'Robert Williams', salary: 13285713},
    {name: 'Matisse Thybulle', salary: 11550000},
    {name: 'Scoot Henderson', salary: 10748040},
    {name: 'Shaedon Sharpe', salary: 8399983},
    {name: 'Donovan Clingan', salary: 7178400},
    {name: 'Yang Hansen', salary: 4422360},
    {name: 'Kris Murray', salary: 3132000},
    {name: 'Blake Wesley', salary: 2296274},
    {name: 'Toumani Camara', salary: 2221677},
    {name: 'Duop Reath', salary: 2221677},
    {name: 'Rayan Rupert', salary: 2221677}
  ],
  'Sacramento Kings': [
    {name: 'Zach LaVine', salary: 47499660},
    {name: 'Domantas Sabonis', salary: 42336000},
    {name: 'DeMar DeRozan', salary: 24750000},
    {name: 'Malik Monk', salary: 18797619},
    {name: 'Dennis Schroder', salary: 14104000},
    {name: 'Keegan Murray', salary: 11144093},
    {name: 'Dario Šarić', salary: 5426400},
    {name: 'Devin Carter', salary: 4923720},
    {name: 'Nique Clifford', salary: 3108120},
    {name: 'Terence Davis', salary: 2546675},
    {name: 'Keon Ellis', salary: 2301587},
    {name: 'Drew Eubanks', salary: 2296274},
    {name: 'Doug McDermott', salary: 2296274},
    {name: 'Isaac Jones', salary: 1955378},
    {name: 'Maxime Raynaud', salary: 1272870}
  ],
  'San Antonio Spurs': [
    {name: 'De\'Aaron Fox', salary: 37096620},
    {name: 'Devin Vassell', salary: 27000000},
    {name: 'Harrison Barnes', salary: 19000000},
    {name: 'Keldon Johnson', salary: 17500000},
    {name: 'Kelly Olynyk', salary: 13445122},
    {name: 'Victor Wembanyama', salary: 13376880},
    {name: 'Dylan Harper', salary: 12370320},
    {name: 'Luke Kornet', salary: 11000000},
    {name: 'Stephon Castle', salary: 9560520},
    {name: 'Jeremy Sochan', salary: 7096231},
    {name: 'Carter Bryant', salary: 4900320},
    {name: 'Julian Champagnie', salary: 3000000},
    {name: 'Jordan McLaughlin', salary: 2296274},
    {name: 'Lindy Waters III', salary: 2296274}
  ],
  'Toronto Raptors': [
    {name: 'Scottie Barnes', salary: 38661750},
    {name: 'Brandon Ingram', salary: 38095238},
    {name: 'Immanuel Quickley', salary: 32500000},
    {name: 'R.J. Barrett', salary: 27705357},
    {name: 'Jakob Poeltl', salary: 19500000},
    {name: 'Ochai Agbaji', salary: 6383525},
    {name: 'Collin Murray-Boyles', salary: 6332520},
    {name: 'Gradey Dick', salary: 4990560},
    {name: 'Ja\'Kobe Walter', salary: 3638160},
    {name: 'Sandro Mamukelashvili', salary: 2461463},
    {name: 'Garrett Temple', salary: 2296274},
    {name: 'A.J. Lawson', salary: 2270735},
    {name: 'Colin Castleton', salary: 2191897},
    {name: 'Jamison Battle', salary: 1955378},
    {name: 'Jonathan Mogbo', salary: 1955378},
    {name: 'Jamal Shead', salary: 1955378}
  ],
  'Utah Jazz': [
    {name: 'Lauri Markkanen', salary: 46394100},
    {name: 'Jusuf Nurkić', salary: 19375000},
    {name: 'Kyle Anderson', salary: 9219512},
    {name: 'Ace Bailey', salary: 9069840},
    {name: 'KJ Martin', salary: 8025000},
    {name: 'Taylor Hendricks', salary: 6127080},
    {name: 'Cody Williams', salary: 5742480},
    {name: 'Walker Kessler', salary: 4878938},
    {name: 'Keyonte George', salary: 4278960},
    {name: 'Kevin Love', salary: 4150000},
    {name: 'Svi Mykhailiuk', salary: 3675000},
    {name: 'Walter Clayton Jr.', salary: 3991320},
    {name: 'Kyle Filipowski', salary: 3000000},
    {name: 'Brice Sensabaugh', salary: 2693760},
    {name: 'Isaiah Collier', salary: 2638200}
  ],
  'Washington Wizards': [
    {name: 'Khris Middleton', salary: 33296296},
    {name: 'C.J. McCollum', salary: 30666667},
    {name: 'Corey Kispert', salary: 13975000},
    {name: 'Alex Sarr', salary: 11808240},
    {name: 'Tre Johnson', salary: 8237640},
    {name: 'Bilal Coulibaly', salary: 7275600},
    {name: 'Malaki Branham', salary: 4962033},
    {name: 'Bub Carrington', salary: 4677600},
    {name: 'Cam Whitmore', salary: 3539760},
    {name: 'Will Riley', salary: 3512520},
    {name: 'AJ Johnson', salary: 3090480},
    {name: 'Kyshawn George', salary: 2966760},
    {name: 'Dillon Jones', salary: 2753280},
    {name: 'Justin Champagnie', salary: 2349578},
    {name: 'Marvin Bagley', salary: 2296274}
  ]
};

    // Updated salary cap thresholds for 2024-25 season
    const salaryCapInfo = {
      salaryCap: 154647000,
      luxuryTax: 187895000,
      firstApron: 195945000,  // Corrected first apron
      secondApron: 207824000  // Corrected second apron
    };

    let teamCount = 0;
    let selectedPlayers = {};
    let teamRosterTotals = {}; // Store full roster totals for each team

    function addTeam() {
      teamCount++;
      const container = document.getElementById('tradeContainer');
      
      const teamBlock = document.createElement('div');
      teamBlock.className = 'team-block';
      teamBlock.id = `team-${teamCount}`;
      
      teamBlock.innerHTML = `
        <div class="team-header">
          <span class="team-label">Team ${teamCount}</span>
          <select onchange="loadPlayers(${teamCount}, this.value)">
            <option value="">Select Team</option>
            ${Object.keys(nbaTeams).map(team => `<option value="${team}">${team}</option>`).join('')}
          </select>
          <button class="remove-team-btn" onclick="removeTeam(${teamCount})">×</button>
        </div>
        <ul class="players-list" id="players-${teamCount}">
          <li style="text-align: center; color: #666; font-style: italic; padding: 2rem;">Select a team to view players</li>
        </ul>
        <div class="totals" id="totals-${teamCount}">Selected Players: $0</div>
        <div class="payroll-box" id="payroll-${teamCount}">
          <div class="payroll-line">
            <span class="payroll-label">
              <span class="status-indicator under"></span>
              Cap Space
            </span>
            <span class="payroll-value under" id="cap-space-${teamCount}">$0</span>
          </div>
          <div class="payroll-line">
            <span class="payroll-label">
              <span class="status-indicator under"></span>
              Tax Space
            </span>
            <span class="payroll-value under" id="tax-space-${teamCount}">$0</span>
          </div>
          <div class="payroll-line">
            <span class="payroll-label">
              <span class="status-indicator under"></span>
              1st Apron Space
            </span>
            <span class="payroll-value under" id="first-apron-space-${teamCount}">$0</span>
          </div>
          <div class="payroll-line">
            <span class="payroll-label">
              <span class="status-indicator under"></span>
              2nd Apron Space
            </span>
            <span class="payroll-value under" id="second-apron-space-${teamCount}">$0</span>
          </div>
          <div class="payroll-line">
            <span class="payroll-label">Team Total</span>
            <span class="payroll-value under" id="team-total-${teamCount}">$0</span>
          </div>
        </div>
        <div id="trade-restrictions-${teamCount}"></div>
      `;
      
      container.appendChild(teamBlock);
      selectedPlayers[teamCount] = [];
    }

    function removeTeam(teamId) {
      const teamBlock = document.getElementById(`team-${teamId}`);
      if (teamBlock) {
        teamBlock.remove();
        delete selectedPlayers[teamId];
        delete teamRosterTotals[teamId];
      }
    }

    function loadPlayers(teamId, teamName) {
      if (!teamName) return;
      
      const playersList = document.getElementById(`players-${teamId}`);
      const players = nbaTeams[teamName];
      
      if (!players) return;
      
      // Calculate team total salary
      const teamTotal = players.reduce((sum, player) => sum + player.salary, 0);
      teamRosterTotals[teamId] = teamTotal;
      
      playersList.innerHTML = players.map((player, index) => `
        <li>
          <input type="checkbox" id="player-${teamId}-${index}" 
                 onchange="togglePlayer(${teamId}, ${index}, '${player.name.replace(/'/g, "\\'")}', ${player.salary})">
          <div class="player-avatar">${player.name.split(' ').map(n => n[0]).join('')}</div>
          <label for="player-${teamId}-${index}">${player.name}</label>
          <span class="salary-cell">$${formatSalary(player.salary)}</span>
        </li>
      `).join('');
      
      selectedPlayers[teamId] = [];
      updateAllTeamsPayrollInfo();
    }

    function formatSalary(salary) {
      if (salary >= 1000000) {
        return (salary / 1000000).toFixed(1) + 'M';
      } else if (salary >= 1000) {
        return (salary / 1000).toFixed(0) + 'K';
      } else {
        return salary.toString();
      }
    }

    function togglePlayer(teamId, playerIndex, playerName, salary) {
      const checkbox = document.getElementById(`player-${teamId}-${playerIndex}`);
      const playerData = {name: playerName, salary: salary};
      
      if (checkbox.checked) {
        selectedPlayers[teamId].push(playerData);
        checkbox.parentElement.classList.add('selected');
      } else {
        selectedPlayers[teamId] = selectedPlayers[teamId].filter(p => p.name !== playerName);
        checkbox.parentElement.classList.remove('selected');
      }
      
      // Update payroll info for all teams since incoming salaries may have changed
      updateAllTeamsPayrollInfo();
    }

    function updateAllTeamsPayrollInfo() {
      // Update payroll info for all teams with selected players
      Object.keys(selectedPlayers).forEach(teamId => {
        if (document.getElementById(`team-${teamId}`)) {
          updatePayrollInfo(teamId);
        }
      });
    }

    function updatePayrollInfo(teamId) {
      const selectedTotal = selectedPlayers[teamId].reduce((sum, player) => sum + player.salary, 0);
      const rosterTotal = teamRosterTotals[teamId] || 0;
      
      // Calculate incoming salary from other teams
      const incomingTotal = calculateIncomingSalary(teamId);
      
      // Calculate post-trade total (roster total - outgoing + incoming)
      const postTradeTotal = rosterTotal - selectedTotal + incomingTotal;
      
      // Update selected players total
      document.getElementById(`totals-${teamId}`).textContent = `Selected Players: $${formatSalary(selectedTotal)}`;
      
      // Update team total
      const teamTotalElement = document.getElementById(`team-total-${teamId}`);
      if (teamTotalElement) {
        teamTotalElement.textContent = `$${formatSalary(postTradeTotal)}`;
        updateStatusClass(teamTotalElement, postTradeTotal);
      }
      
      // Calculate and update space for each threshold
      updateSpaceCalculation(teamId, 'cap-space', salaryCapInfo.salaryCap, postTradeTotal);
      updateSpaceCalculation(teamId, 'tax-space', salaryCapInfo.luxuryTax, postTradeTotal);
      updateSpaceCalculation(teamId, 'first-apron-space', salaryCapInfo.firstApron, postTradeTotal);
      updateSpaceCalculation(teamId, 'second-apron-space', salaryCapInfo.secondApron, postTradeTotal);
      
      // Update trade restrictions
      updateTradeRestrictions(teamId, postTradeTotal);
    }

    function calculateIncomingSalary(teamId) {
      // Calculate total salary coming to this team from all other teams
      let incomingTotal = 0;
      const teamsWithPlayers = Object.keys(selectedPlayers).filter(id => 
        id !== teamId && selectedPlayers[id].length > 0
      );
      
      if (teamsWithPlayers.length > 0) {
        // In a multi-team trade, this team gets a proportional share of all other outgoing salaries
        const totalOutgoingFromOthers = teamsWithPlayers.reduce((sum, otherId) => 
          sum + selectedPlayers[otherId].reduce((playerSum, player) => playerSum + player.salary, 0), 0
        );
        
        // For simplicity, assume equal distribution in multi-team trades
        // In reality, this would be determined by the specific trade structure
        incomingTotal = totalOutgoingFromOthers / (Object.keys(selectedPlayers).filter(id => selectedPlayers[id].length > 0).length - 1);
      }
      
      return incomingTotal;
    }

    function updateSpaceCalculation(teamId, elementId, threshold, currentTotal) {
      const element = document.getElementById(`${elementId}-${teamId}`);
      const indicator = element.parentElement.querySelector('.status-indicator');
      
      if (element) {
        const space = threshold - currentTotal;
        if (space >= 0) {
          element.textContent = `$${formatSalary(space)}`;
          element.className = 'payroll-value under';
          indicator.className = 'status-indicator under';
        } else {
          element.textContent = `-$${formatSalary(Math.abs(space))}`;
          element.className = 'payroll-value over';
          indicator.className = 'status-indicator over';
        }
      }
    }

    function updateStatusClass(element, total) {
      element.className = 'payroll-value';
      if (total > salaryCapInfo.secondApron) {
        element.classList.add('over');
      } else if (total > salaryCapInfo.firstApron) {
        element.classList.add('close');
      } else {
        element.classList.add('under');
      }
    }

    function updateTradeRestrictions(teamId, postTradeTotal) {
      const restrictionsDiv = document.getElementById(`trade-restrictions-${teamId}`);
      
      if (postTradeTotal > salaryCapInfo.secondApron) {
        restrictionsDiv.innerHTML = `
          <div class="trade-restrictions severe">
            <h4>⚠️ Second Apron Restrictions</h4>
            <ul>
              <li>Cannot use mid-level exception</li>
              <li>Cannot aggregate salaries in trades</li>
              <li>Cannot use trade exceptions</li>
              <li>Cannot include cash in trades</li>
              <li>Cannot take back more salary than sent out</li>
            </ul>
          </div>
        `;
      } else if (postTradeTotal > salaryCapInfo.firstApron) {
        restrictionsDiv.innerHTML = `
          <div class="trade-restrictions">
            <h4>⚠️ First Apron Restrictions</h4>
            <ul>
              <li>Cannot acquire players via sign-and-trade</li>
              <li>Cannot sign waived players over $12.9M</li>
              <li>Cannot take back more salary than sent out</li>
            </ul>
          </div>
        `;
      } else {
        restrictionsDiv.innerHTML = '';
      }
    }

    function executeTrade() {
      const teams = Object.keys(selectedPlayers).filter(teamId => selectedPlayers[teamId].length > 0);
      
      if (teams.length < 2) {
        showTradeResult(false, 'You need at least 2 teams with selected players to execute a trade.', {});
        return;
      }
      
      // Calculate trade validity with apron rules
      const teamTotals = teams.map(teamId => {
        const outgoing = selectedPlayers[teamId].reduce((sum, player) => sum + player.salary, 0);
        const rosterTotal = teamRosterTotals[teamId] || 0;
        const incoming = calculateIncomingSalary(teamId);
        const postTradeTotal = rosterTotal - outgoing + incoming;
        
        return {
          teamId,
          outgoing,
          incoming,
          postTradeTotal,
          players: selectedPlayers[teamId],
          teamName: document.querySelector(`#team-${teamId} select`).value
        };
      });
      
      let tradeValid = true;
      let errorMessages = [];
      
      // Check apron restrictions for each team
      teamTotals.forEach(team => {
        if (team.postTradeTotal > salaryCapInfo.secondApron) {
          // Second apron teams cannot take back more than they send out
          if (team.incoming > team.outgoing) {
            tradeValid = false;
            errorMessages.push(`${team.teamName} is in second apron and cannot take back more salary than sent out.`);
          }
        } else if (team.postTradeTotal > salaryCapInfo.firstApron) {
          // First apron teams cannot take back more than they send out
          if (team.incoming > team.outgoing) {
            tradeValid = false;
            errorMessages.push(`${team.teamName} is in first apron and cannot take back more salary than sent out.`);
          }
        }
      });
      
      // Standard salary matching rules for non-apron teams
      if (teams.length === 2 && tradeValid) {
        const [team1, team2] = teamTotals;
        const difference = Math.abs(team1.outgoing - team2.outgoing);
        const higherSalary = Math.max(team1.outgoing, team2.outgoing);
        
        // Check if either team has apron restrictions (based on POST-TRADE totals)
        const team1HasApronRestrictions = team1.postTradeTotal > salaryCapInfo.firstApron;
        const team2HasApronRestrictions = team2.postTradeTotal > salaryCapInfo.firstApron;
        
        if (!team1HasApronRestrictions && !team2HasApronRestrictions) {
          // Standard 125% + $100k rule for teams not in apron
          const allowedDifference = higherSalary * 0.25 + 100000;
          
          if (difference > allowedDifference) {
            tradeValid = false;
            errorMessages.push(`Trade salaries don't match. Difference of $${formatSalary(difference)} exceeds the allowed $${formatSalary(allowedDifference)}.`);
          }
        }
        // Note: Teams with apron restrictions already checked above - they must match exactly (incoming <= outgoing)
      }
      
      const tradeData = {};
      teamTotals.forEach(team => {
        tradeData[team.teamName] = team.players;
      });
      
      const errorMessage = errorMessages.join(' ');
      showTradeResult(tradeValid, errorMessage, tradeData);
    }

    function showTradeResult(success, message, tradeData) {
      const modal = document.getElementById('tradeModal');
      const header = document.getElementById('modalHeader');
      const title = document.getElementById('modalTitle');
      const summary = document.getElementById('tradeSummary');
      const messageDiv = document.getElementById('tradeMessage');
      
      // Set modal style based on success/failure
      header.className = `modal-header ${success ? 'success' : 'failed'}`;
      title.textContent = success ? 'Trade Successful!' : 'Trade Failed';
      
      // Clear previous content
      summary.innerHTML = '';
      messageDiv.innerHTML = '';
      
      // Show trade summary
      Object.keys(tradeData).forEach(teamName => {
        const teamDiv = document.createElement('div');
        teamDiv.className = 'team-summary';
        
        const playersHtml = tradeData[teamName].map(player => `
          <div class="player-item">
            <div class="player-avatar">${player.name.split(' ').map(n => n[0]).join('')}</div>
            <span class="player-name">${player.name}</span>
            <span class="player-salary">$${formatSalary(player.salary)}</span>
          </div>
        `).join('');
        
        const totalSalary = tradeData[teamName].reduce((sum, player) => sum + player.salary, 0);
        
        teamDiv.innerHTML = `
          <h4>${teamName} (Total: $${formatSalary(totalSalary)})</h4>
          ${playersHtml}
        `;
        
        summary.appendChild(teamDiv);
      });
      
      // Show success or error message
      if (success) {
        messageDiv.innerHTML = `
          <div class="success-message">
            🎉 Trade completed successfully! All salary cap and apron requirements have been met.
          </div>
        `;
        // Show social sharing section for successful trades
        document.getElementById('socialSharing').style.display = 'block';
      } else {
        messageDiv.innerHTML = `
          <div class="error-message">
            ❌ ${message}
          </div>
        `;
        // Hide social sharing section for failed trades
        document.getElementById('socialSharing').style.display = 'none';
      }
      
      modal.style.display = 'block';
    }

    function closeModal() {
      document.getElementById('tradeModal').style.display = 'none';
    }

    // Social Media Sharing Functions
    function generateTradeText() {
      const teams = Object.keys(selectedPlayers).filter(teamId => selectedPlayers[teamId].length > 0);
      let tradeText = "🏀 NBA Trade Machine - Check out this trade:\n\n";
      
      teams.forEach(teamId => {
        const teamName = Object.keys(nbaTeams)[teamId];
        const players = selectedPlayers[teamId];
        const totalSalary = players.reduce((sum, player) => sum + player.salary, 0);
        
        tradeText += `${teamName} trades:\n`;
        players.forEach(player => {
          tradeText += `• ${player.name} ($${formatSalary(player.salary)})\n`;
        });
        tradeText += `Total: $${formatSalary(totalSalary)}\n`;
        
        // Add cap space information
        const capSpaceElement = document.getElementById(`cap-space-${teamId}`);
        const taxSpaceElement = document.getElementById(`tax-space-${teamId}`);
        if (capSpaceElement && taxSpaceElement) {
          tradeText += `Cap Space: ${capSpaceElement.textContent}\n`;
          tradeText += `Tax Space: ${taxSpaceElement.textContent}\n`;
        }
        tradeText += "\n";
      });
      
      tradeText += "Created with NBA Trade Machine - Professional Edition";
      return tradeText;
    }



    function generateTradeImage() {
      const exportBtn = document.getElementById('tradeExportBtn');
      const exportModal = document.getElementById('tradeExportModal');
      const exportCanvas = document.getElementById('tradeExportCanvas');
      const exportPreview = document.getElementById('tradeExportPreview');
      
      exportBtn.disabled = true;
      exportBtn.textContent = '📸 Generating...';

      try {
        generateTradeImageForSharing((socialCanvas) => {
          // Show modal with preview
          exportModal.style.display = 'flex';
          exportPreview.src = socialCanvas.toDataURL('image/png');
          
          // Store canvas for download/copy
          exportCanvas.width = socialCanvas.width;
          exportCanvas.height = socialCanvas.height;
          const exportCtx = exportCanvas.getContext('2d');
          exportCtx.drawImage(socialCanvas, 0, 0);
          
          // Reset button
          exportBtn.disabled = false;
          exportBtn.textContent = '📸 Export for Social Media';
        });
      } catch (error) {
        console.error('Export failed:', error);
        alert('Export failed. Please try again.');
        exportBtn.disabled = false;
        exportBtn.textContent = '📸 Export for Social Media';
      }
    }

    function generateTradeImageForSharing(callback) {
      // Create a new canvas specifically for social media (1200x630)
      const socialCanvas = document.createElement('canvas');
      socialCanvas.width = 1200;
      socialCanvas.height = 630;
      const ctx = socialCanvas.getContext('2d');
      
      // Clear canvas
      ctx.clearRect(0, 0, socialCanvas.width, socialCanvas.height);
      
      // Set background to match trade machine (light gradient)
      const gradient = ctx.createLinearGradient(0, 0, 0, socialCanvas.height);
      gradient.addColorStop(0, '#f8fafc');
      gradient.addColorStop(1, '#e2e8f0');
      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, socialCanvas.width, socialCanvas.height);
      
      // Add header section with blue gradient (like the hero section)
      const headerGradient = ctx.createLinearGradient(0, 0, socialCanvas.width, 0);
      headerGradient.addColorStop(0, '#0a174e');
      headerGradient.addColorStop(1, '#0057e7');
      ctx.fillStyle = headerGradient;
      ctx.fillRect(0, 0, socialCanvas.width, 120);
      
      // Add main title
      ctx.fillStyle = '#ffffff';
      ctx.font = 'bold 42px Inter, Arial, sans-serif';
      ctx.textAlign = 'center';
      ctx.shadowColor = 'rgba(0, 0, 0, 0.3)';
      ctx.shadowBlur = 4;
      ctx.shadowOffsetY = 2;
      ctx.fillText('SixersHoops Trade Machine', socialCanvas.width / 2, 45);
      
      // Add subtitle
      ctx.font = '24px Inter, Arial, sans-serif';
      ctx.fillText('Trade Analysis Complete', socialCanvas.width / 2, 85);
      
      // Reset shadow
      ctx.shadowColor = 'transparent';
      ctx.shadowBlur = 0;
      ctx.shadowOffsetY = 0;
      
      // Get teams involved in trade
      const teams = Object.keys(selectedPlayers).filter(teamId => selectedPlayers[teamId].length > 0);
      
      // Create stunning professional design
      const blockWidth = Math.min(350, (socialCanvas.width - 120) / teams.length - 20);
      const blockHeight = 320;
      const startX = (socialCanvas.width - (teams.length * blockWidth + (teams.length - 1) * 30)) / 2;
      let currentX = startX;
      const blockY = 140;
      
      teams.forEach((teamId, index) => {
        const teamName = Object.keys(nbaTeams)[teamId];
        const players = selectedPlayers[teamId];
        const totalSalary = players.reduce((sum, player) => sum + player.salary, 0);
        
        // Create stunning card with multiple gradients and effects
        const cardGradient = ctx.createLinearGradient(currentX, blockY, currentX + blockWidth, blockY + blockHeight);
        cardGradient.addColorStop(0, '#ffffff');
        cardGradient.addColorStop(0.1, '#fefefe');
        cardGradient.addColorStop(1, '#f8fafc');
        ctx.fillStyle = cardGradient;
        
        // Add dramatic shadow
        ctx.shadowColor = 'rgba(10, 23, 78, 0.25)';
        ctx.shadowBlur = 20;
        ctx.shadowOffsetX = 0;
        ctx.shadowOffsetY = 8;
        
        // Draw main card with rounded corners
        const radius = 20;
        ctx.beginPath();
        ctx.moveTo(currentX + radius, blockY);
        ctx.lineTo(currentX + blockWidth - radius, blockY);
        ctx.quadraticCurveTo(currentX + blockWidth, blockY, currentX + blockWidth, blockY + radius);
        ctx.lineTo(currentX + blockWidth, blockY + blockHeight - radius);
        ctx.quadraticCurveTo(currentX + blockWidth, blockY + blockHeight, currentX + blockWidth - radius, blockY + blockHeight);
        ctx.lineTo(currentX + radius, blockY + blockHeight);
        ctx.quadraticCurveTo(currentX, blockY + blockHeight, currentX, blockY + blockHeight - radius);
        ctx.lineTo(currentX, blockY + radius);
        ctx.quadraticCurveTo(currentX, blockY, currentX + radius, blockY);
        ctx.closePath();
        ctx.fill();
        
        // Add subtle border
        ctx.strokeStyle = 'rgba(10, 23, 78, 0.1)';
        ctx.lineWidth = 2;
        ctx.stroke();
        
        // Reset shadow
        ctx.shadowColor = 'transparent';
        ctx.shadowBlur = 0;
        ctx.shadowOffsetX = 0;
        ctx.shadowOffsetY = 0;
        
        // Create stunning header with team colors
        const headerGradient = ctx.createLinearGradient(currentX, blockY, currentX + blockWidth, blockY + 70);
        headerGradient.addColorStop(0, '#0a174e');
        headerGradient.addColorStop(0.5, '#1e3a8a');
        headerGradient.addColorStop(1, '#3b82f6');
        ctx.fillStyle = headerGradient;
        
        // Draw header with rounded top
        ctx.beginPath();
        ctx.moveTo(currentX + radius, blockY);
        ctx.lineTo(currentX + blockWidth - radius, blockY);
        ctx.quadraticCurveTo(currentX + blockWidth, blockY, currentX + blockWidth, blockY + radius);
        ctx.lineTo(currentX + blockWidth, blockY + 70);
        ctx.lineTo(currentX, blockY + 70);
        ctx.lineTo(currentX, blockY + radius);
        ctx.quadraticCurveTo(currentX, blockY, currentX + radius, blockY);
        ctx.closePath();
        ctx.fill();
        
        // Add header shine effect
        const shineGradient = ctx.createLinearGradient(currentX, blockY, currentX + blockWidth, blockY + 35);
        shineGradient.addColorStop(0, 'rgba(255, 255, 255, 0.3)');
        shineGradient.addColorStop(1, 'rgba(255, 255, 255, 0)');
        ctx.fillStyle = shineGradient;
        ctx.beginPath();
        ctx.moveTo(currentX + radius, blockY);
        ctx.lineTo(currentX + blockWidth - radius, blockY);
        ctx.quadraticCurveTo(currentX + blockWidth, blockY, currentX + blockWidth, blockY + radius);
        ctx.lineTo(currentX + blockWidth, blockY + 35);
        ctx.lineTo(currentX, blockY + 35);
        ctx.lineTo(currentX, blockY + radius);
        ctx.quadraticCurveTo(currentX, blockY, currentX + radius, blockY);
        ctx.closePath();
        ctx.fill();
        
        // Team name with stunning typography
        ctx.fillStyle = '#ffffff';
        ctx.font = 'bold 22px Inter, Arial, sans-serif';
        ctx.textAlign = 'center';
        ctx.shadowColor = 'rgba(0, 0, 0, 0.5)';
        ctx.shadowBlur = 4;
        ctx.shadowOffsetY = 2;
        ctx.fillText(teamName, currentX + blockWidth / 2, blockY + 45);
        
        // Reset shadow
        ctx.shadowColor = 'transparent';
        ctx.shadowBlur = 0;
        ctx.shadowOffsetY = 0;
        
        // Players section with beautiful styling
        let playerY = blockY + 95;
        ctx.textAlign = 'left';
        
        // Add "TRADING:" label
        ctx.fillStyle = '#64748b';
        ctx.font = 'bold 14px Inter, Arial, sans-serif';
        ctx.fillText('TRADING:', currentX + 20, playerY);
        playerY += 25;
        
        players.forEach((player, playerIndex) => {
          // Alternating background for players
          if (playerIndex % 2 === 0) {
            ctx.fillStyle = 'rgba(248, 250, 252, 0.8)';
            ctx.fillRect(currentX + 10, playerY - 18, blockWidth - 20, 30);
          }
          
          // Player name with professional styling
          ctx.fillStyle = '#1e293b';
          ctx.font = 'bold 16px Inter, Arial, sans-serif';
          ctx.fillText(player.name, currentX + 20, playerY);
          
          // Player salary with currency styling
          ctx.fillStyle = '#059669';
          ctx.font = '14px Inter, Arial, sans-serif';
          ctx.fillText(`$${formatSalary(player.salary)}`, currentX + 20, playerY + 16);
          
          playerY += 35;
        });
        
        // Stunning total section with gradient background
        const totalGradient = ctx.createLinearGradient(currentX + 10, blockY + blockHeight - 70, currentX + blockWidth - 10, blockY + blockHeight - 10);
        totalGradient.addColorStop(0, '#f0f9ff');
        totalGradient.addColorStop(1, '#e0f2fe');
        ctx.fillStyle = totalGradient;
        ctx.fillRect(currentX + 10, blockY + blockHeight - 70, blockWidth - 20, 60);
        
        // Add subtle border to total section
        ctx.strokeStyle = 'rgba(14, 165, 233, 0.2)';
        ctx.lineWidth = 1;
        ctx.strokeRect(currentX + 10, blockY + blockHeight - 70, blockWidth - 20, 60);
        
        // Total label
        ctx.fillStyle = '#0369a1';
        ctx.font = 'bold 16px Inter, Arial, sans-serif';
        ctx.fillText('TOTAL VALUE:', currentX + 20, blockY + blockHeight - 45);
        
        // Total amount with stunning styling
        ctx.fillStyle = '#059669';
        ctx.font = 'bold 20px Inter, Arial, sans-serif';
        ctx.fillText(`$${formatSalary(totalSalary)}`, currentX + 20, blockY + blockHeight - 20);
        
        currentX += blockWidth + 30;
      });
      
      // Add stunning trade arrow with glow effect
      if (teams.length === 2) {
        const arrowX = socialCanvas.width / 2;
        const arrowY = blockY + blockHeight / 2;
        
        // Glow effect
        ctx.shadowColor = '#3b82f6';
        ctx.shadowBlur = 20;
        ctx.fillStyle = '#3b82f6';
        ctx.font = 'bold 60px Arial';
        ctx.textAlign = 'center';
        ctx.fillText('⇄', arrowX, arrowY + 20);
        
        // Main arrow
        ctx.shadowBlur = 0;
        ctx.fillStyle = '#ffffff';
        ctx.fillText('⇄', arrowX, arrowY + 20);
      }
      
      // Add stunning status badge
      const badgeY = blockY + blockHeight + 50;
      const badgeWidth = 200;
      const badgeHeight = 50;
      const badgeX = (socialCanvas.width - badgeWidth) / 2;
      
      // Badge gradient
      const badgeGradient = ctx.createLinearGradient(badgeX, badgeY, badgeX + badgeWidth, badgeY + badgeHeight);
      badgeGradient.addColorStop(0, '#10b981');
      badgeGradient.addColorStop(1, '#059669');
      ctx.fillStyle = badgeGradient;
      
      // Badge shadow
      ctx.shadowColor = 'rgba(16, 185, 129, 0.4)';
      ctx.shadowBlur = 15;
      ctx.shadowOffsetY = 5;
      
      // Draw badge
      ctx.beginPath();
      ctx.moveTo(badgeX + 25, badgeY);
      ctx.lineTo(badgeX + badgeWidth - 25, badgeY);
      ctx.quadraticCurveTo(badgeX + badgeWidth, badgeY, badgeX + badgeWidth, badgeY + 25);
      ctx.lineTo(badgeX + badgeWidth, badgeY + badgeHeight - 25);
      ctx.quadraticCurveTo(badgeX + badgeWidth, badgeY + badgeHeight, badgeX + badgeWidth - 25, badgeY + badgeHeight);
      ctx.lineTo(badgeX + 25, badgeY + badgeHeight);
      ctx.quadraticCurveTo(badgeX, badgeY + badgeHeight, badgeX, badgeY + badgeHeight - 25);
      ctx.lineTo(badgeX, badgeY + 25);
      ctx.quadraticCurveTo(badgeX, badgeY, badgeX + 25, badgeY);
      ctx.closePath();
      ctx.fill();
      
      // Reset shadow
      ctx.shadowColor = 'transparent';
      ctx.shadowBlur = 0;
      ctx.shadowOffsetY = 0;
      
      // Badge text
      ctx.fillStyle = '#ffffff';
      ctx.font = 'bold 24px Inter, Arial, sans-serif';
      ctx.textAlign = 'center';
      ctx.fillText('✓ TRADE VALID', socialCanvas.width / 2, badgeY + 32);
      
      // Add stunning branding section
      const brandingText = 'sixershoops.com';
      ctx.font = 'bold 28px Inter, Arial, sans-serif';
      ctx.textAlign = 'center';
      const textWidth = ctx.measureText(brandingText).width;
      const brandingX = socialCanvas.width / 2;
      const brandingY = socialCanvas.height - 30;
      
      // Create attractive branding background with gradient
      const brandingGradient = ctx.createLinearGradient(brandingX - textWidth/2 - 40, brandingY - 35, brandingX + textWidth/2 + 40, brandingY + 15);
      brandingGradient.addColorStop(0, '#0a174e');
      brandingGradient.addColorStop(0.5, '#1e3a8a');
      brandingGradient.addColorStop(1, '#3b82f6');
      ctx.fillStyle = brandingGradient;
      
      // Add branding shadow
      ctx.shadowColor = 'rgba(10, 23, 78, 0.4)';
      ctx.shadowBlur = 12;
      ctx.shadowOffsetY = 4;
      
      // Draw rounded branding background
      const brandingRadius = 25;
      ctx.beginPath();
      ctx.moveTo(brandingX - textWidth/2 - 40 + brandingRadius, brandingY - 35);
      ctx.lineTo(brandingX + textWidth/2 + 40 - brandingRadius, brandingY - 35);
      ctx.quadraticCurveTo(brandingX + textWidth/2 + 40, brandingY - 35, brandingX + textWidth/2 + 40, brandingY - 35 + brandingRadius);
      ctx.lineTo(brandingX + textWidth/2 + 40, brandingY + 15 - brandingRadius);
      ctx.quadraticCurveTo(brandingX + textWidth/2 + 40, brandingY + 15, brandingX + textWidth/2 + 40 - brandingRadius, brandingY + 15);
      ctx.lineTo(brandingX - textWidth/2 - 40 + brandingRadius, brandingY + 15);
      ctx.quadraticCurveTo(brandingX - textWidth/2 - 40, brandingY + 15, brandingX - textWidth/2 - 40, brandingY + 15 - brandingRadius);
      ctx.lineTo(brandingX - textWidth/2 - 40, brandingY - 35 + brandingRadius);
      ctx.quadraticCurveTo(brandingX - textWidth/2 - 40, brandingY - 35, brandingX - textWidth/2 - 40 + brandingRadius, brandingY - 35);
      ctx.closePath();
      ctx.fill();
      
      // Add shine effect to branding
      const brandingShine = ctx.createLinearGradient(brandingX - textWidth/2 - 40, brandingY - 35, brandingX + textWidth/2 + 40, brandingY - 20);
      brandingShine.addColorStop(0, 'rgba(255, 255, 255, 0.4)');
      brandingShine.addColorStop(1, 'rgba(255, 255, 255, 0)');
      ctx.fillStyle = brandingShine;
      ctx.beginPath();
      ctx.moveTo(brandingX - textWidth/2 - 40 + brandingRadius, brandingY - 35);
      ctx.lineTo(brandingX + textWidth/2 + 40 - brandingRadius, brandingY - 35);
      ctx.quadraticCurveTo(brandingX + textWidth/2 + 40, brandingY - 35, brandingX + textWidth/2 + 40, brandingY - 35 + brandingRadius);
      ctx.lineTo(brandingX + textWidth/2 + 40, brandingY - 20);
      ctx.lineTo(brandingX - textWidth/2 - 40, brandingY - 20);
      ctx.lineTo(brandingX - textWidth/2 - 40, brandingY - 35 + brandingRadius);
      ctx.quadraticCurveTo(brandingX - textWidth/2 - 40, brandingY - 35, brandingX - textWidth/2 - 40 + brandingRadius, brandingY - 35);
      ctx.closePath();
      ctx.fill();
      
      // Reset shadow
      ctx.shadowColor = 'transparent';
      ctx.shadowBlur = 0;
      ctx.shadowOffsetY = 0;
      
      // Branding text with glow effect
      ctx.shadowColor = 'rgba(255, 255, 255, 0.8)';
      ctx.shadowBlur = 3;
      ctx.fillStyle = '#ffffff';
      ctx.font = 'bold 28px Inter, Arial, sans-serif';
      ctx.fillText(brandingText, brandingX, brandingY - 8);
      
      // Reset shadow
      ctx.shadowColor = 'transparent';
      ctx.shadowBlur = 0;
      
      // Return the canvas directly
      callback(socialCanvas);
    }

    function downloadImage(blob, filename) {
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    function showShareMessage(message) {
      // Create or update the message element
      let messageEl = document.getElementById('shareMessage');
      if (!messageEl) {
        messageEl = document.createElement('div');
        messageEl.id = 'shareMessage';
        messageEl.style.cssText = `
          position: fixed;
          top: 80px;
          right: 20px;
          background: var(--success-color);
          color: white;
          padding: 1rem 1.5rem;
          border-radius: var(--radius-lg);
          box-shadow: var(--shadow-lg);
          z-index: 1002;
          font-weight: 500;
          max-width: 300px;
          opacity: 0;
          transform: translateX(100%);
          transition: all 0.3s ease;
        `;
        document.body.appendChild(messageEl);
      }
      
      messageEl.textContent = message;
      
      // Show the message
      setTimeout(() => {
        messageEl.style.opacity = '1';
        messageEl.style.transform = 'translateX(0)';
      }, 100);
      
      // Hide the message after 4 seconds
      setTimeout(() => {
        messageEl.style.opacity = '0';
        messageEl.style.transform = 'translateX(100%)';
        setTimeout(() => {
          if (messageEl.parentNode) {
            messageEl.parentNode.removeChild(messageEl);
          }
        }, 300);
      }, 4000);
    }

    function clearTrade() {
      document.getElementById('tradeContainer').innerHTML = '';
      selectedPlayers = {};
      teamRosterTotals = {};
      teamCount = 0;
    }

    function toggleMobileMenu() {
      const navRight = document.querySelector('.nav-right');
      navRight.classList.toggle('open');
    }

    // SECURITY: Navigation link protection against suspicious redirects
    document.addEventListener('DOMContentLoaded', function() {
      document.querySelectorAll(".nav-link, .dropdown-link").forEach(link => {
        link.addEventListener("click", (e) => {
          // Security: Ensure we're only navigating to our own pages
          const href = link.getAttribute('href');
          if (href && (href.startsWith('/') || href.startsWith('#'))) {
            // Close mobile menu on legitimate navigation
            const navRight = document.querySelector('.nav-right');
            const hamburger = document.querySelector('.hamburger');
            if (navRight) navRight.classList.remove("open");
            if (hamburger) hamburger.setAttribute("aria-expanded", "false");
          } else if (href && !href.startsWith('http')) {
            // Prevent any suspicious redirects
            e.preventDefault();
            console.warn('Blocked suspicious navigation attempt:', href);
            alert('Navigation blocked for security reasons.');
          }
        });
      });

      // ADDITIONAL SECURITY: Global redirect protection
      // Override potentially dangerous methods
      const originalWindowOpen = window.open;
      window.open = function(url, target, features) {
        // Only allow opening external links (http/https) in new tabs
        if (url && (url.startsWith('http://') || url.startsWith('https://'))) {
          return originalWindowOpen.call(this, url, target || '_blank', features);
        } else {
          console.warn('Blocked suspicious window.open attempt:', url);
          return null;
        }
      };

      // Prevent location manipulation from ads
      const originalLocationAssign = location.assign;
      const originalLocationReplace = location.replace;
      
      location.assign = function(url) {
        if (url && (url.startsWith('/') || url.startsWith('#') || url.startsWith('http'))) {
          return originalLocationAssign.call(this, url);
        } else {
          console.warn('Blocked suspicious location.assign attempt:', url);
        }
      };
      
      location.replace = function(url) {
        if (url && (url.startsWith('/') || url.startsWith('#') || url.startsWith('http'))) {
          return originalLocationReplace.call(this, url);
        } else {
          console.warn('Blocked suspicious location.replace attempt:', url);
        }
      };
    });

    // Close modal when clicking outside
    window.onclick = function(event) {
      const modal = document.getElementById('tradeModal');
      if (event.target === modal) {
        closeModal();
      }
    }



    // Export Modal Event Listeners
    document.addEventListener('DOMContentLoaded', function() {
      const exportModal = document.getElementById('tradeExportModal');
      const exportCanvas = document.getElementById('tradeExportCanvas');
      const copyBtn = document.getElementById('tradeCopyBtn');
      const downloadBtn = document.getElementById('tradeDownloadBtn');
      const closeModal = document.getElementById('tradeCloseModal');

      // Copy to clipboard
      copyBtn.addEventListener('click', async () => {
        try {
          const canvas = exportCanvas;
          canvas.toBlob(async (blob) => {
            const item = new ClipboardItem({ 'image/png': blob });
            await navigator.clipboard.write([item]);
            copyBtn.textContent = '✅ Copied!';
            setTimeout(() => {
              copyBtn.textContent = '📋 Copy to Clipboard';
            }, 2000);
          });
        } catch (error) {
          console.error('Copy failed:', error);
          alert('Copy failed. Please try again.');
        }
      });

      // Download image
      downloadBtn.addEventListener('click', () => {
        const link = document.createElement('a');
        link.download = 'trade-machine-social.png';
        link.href = exportCanvas.toDataURL('image/png');
        link.click();
      });

      // Close modal
      closeModal.addEventListener('click', () => {
        exportModal.style.display = 'none';
      });

      // Close modal on outside click
      exportModal.addEventListener('click', (e) => {
        if (e.target === exportModal) {
          exportModal.style.display = 'none';
        }
      });

      // Close modal on escape key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && exportModal.style.display === 'flex') {
          exportModal.style.display = 'none';
        }
      });
    });

    // Initialize with two teams
    addTeam();
    addTeam();
  </script>
  <script src="nav.js"></script>
</body>
</html>



